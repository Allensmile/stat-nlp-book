<!DOCTYPE html>
<!-- saved from url=(0067)http://localhost:9000/template/statnlpbook/01_tasks/0x_textclassify -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Text Classification</title>
        

<script src="../assets/javascripts/jquery-1.9.0.min.js" type="text/javascript"></script>
<link rel="stylesheet" media="screen" href="../assets/stylesheets/normalize.css">

<!-- Moro imports -->
<script src="../assets/javascripts/document.js" type="text/javascript"></script>
<script src="../assets/javascripts/moro.js" type="text/javascript"></script>
<script src="../assets/javascripts/moro-cellconfig.js" type="text/javascript"></script>
<script src="../assets/javascripts/editor.js" type="text/javascript"></script>
<script src="../assets/javascripts/moro-static.js" type="text/javascript"></script>

<link rel="stylesheet" media="screen" href="../assets/stylesheets/moro.css">
<link rel="stylesheet" media="screen" href="../assets/stylesheets/static.css">

<!-- ACE editor -->
<script src="../assets/javascripts/ace/ace.js" type="text/javascript" charset="utf-8"></script><style id="ace_editor">.ace_editor {position: relative;overflow: hidden;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_editor.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}</style><style id="ace-tm">.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;border-radius: 2px;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style><style>    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }</style>
<script src="../assets/javascripts/ace/ext-language_tools.js" type="text/javascript" charset="utf-8"></script><style>.ace_snippet-marker {    -moz-box-sizing: border-box;    box-sizing: border-box;    background: rgba(194, 193, 208, 0.09);    border: 1px dotted rgba(211, 208, 235, 0.62);    position: absolute;}</style><style>.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #CAD6FA;    z-index: 1;}.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid #abbffe;    margin-top: -1px;    background: rgba(233,233,253,0.4);}.ace_editor.ace_autocomplete .ace_line-hover {    position: absolute;    z-index: 2;}.ace_editor.ace_autocomplete .ace_scroller {   background: none;   border: none;   box-shadow: none;}.ace_rightAlignedText {    color: gray;    display: inline-block;    position: absolute;    right: 4px;    text-align: right;    z-index: -1;}.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #000;    text-shadow: 0 0 0.01em;}.ace_editor.ace_autocomplete {    width: 280px;    z-index: 200000;    background: #fbfbfb;    color: #444;    border: 1px lightgray solid;    position: fixed;    box-shadow: 2px 3px 5px rgba(0,0,0,.2);    line-height: 1.4;}</style>

<!-- Bootstrap -->
<link href="../assets/javascripts/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
<script src="../assets/javascripts/bootstrap/js/bootstrap.js" type="text/javascript"></script>

<!-- Icons, etc.-->
<link href="../assets/stylesheets/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="../assets/stylesheets/octicons/octicons.css" rel="stylesheet">

<!-- MathJax -->
<script type="text/x-mathjax-config;executed=true">
  MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} }, "HTML-CSS": { linebreaks: {automatic: true} } });
</script>
<script type="text/javascript" src="../assets/javascripts/MathJax.js"></script>
<!--script type="text/javascript" src="/assets/javascripts/MathJax-2.5-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script-->

<!-- Highlight.js -->
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/styles/tomorrow.min.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/highlight.min.js"></script>

<!-- HTMLGEN -->
<script type="text/javascript" src="../assets/javascripts/d3.min.js"></script>
<script type="text/javascript" src="../assets/javascripts/raphael-min.js"></script>
<script type="text/javascript" src="../assets/javascripts/nv.d3.min.js"></script>
<script src="../assets/javascripts/htmlgen/d3utils.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="../assets/javascripts/brat/client/lib/head.load.min.js"></script>

<script type="text/javascript" src="../assets/javascripts/dagre-d3.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>

<link href="../assets/stylesheets/nv.d3.css" rel="stylesheet">
<link rel="stylesheet" media="screen" href="../assets/stylesheets/htmlgen.css">

        

<link rel="icon" type="image/x-icon" href="../assets/images/wolfe-logo-black.png">

<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic,900">
<link rel="stylesheet" media="screen" href="../assets/stylesheets/gridism.css">
<link rel="stylesheet" media="screen" href="../assets/stylesheets/normalize.css">
<link rel="stylesheet" media="screen" href="../assets/stylesheets/wolfe.css">

        <link rel="stylesheet" media="screen, print" href="../assets/stylesheets/statnlpbook.css">
    <script src="../assets/javascripts/ace/snippets/text.js"></script><script src="../assets/javascripts/ace/theme-chaos.js"></script><script src="../assets/javascripts/ace/mode-markdown.js"></script><script src="../assets/javascripts/ace/mode-scala.js"></script><script src="../assets/javascripts/ace/mode-html.js"></script><style id="ace-chaos">.ace-chaos .ace_gutter {background: #141414;color: #595959;border-right: 1px solid #282828;}.ace-chaos .ace_gutter-cell.ace_warning {background-image: none;background: #FC0;border-left: none;padding-left: 0;color: #000;}.ace-chaos .ace_gutter-cell.ace_error {background-position: -6px center;background-image: none;background: #F10;border-left: none;padding-left: 0;color: #000;}.ace-chaos .ace_print-margin {border-left: 1px solid #555;right: 0;background: #1D1D1D;}.ace-chaos {background-color: #161616;color: #E6E1DC;}.ace-chaos .ace_cursor {border-left: 2px solid #FFFFFF;}.ace-chaos .ace_cursor.ace_overwrite {border-left: 0px;border-bottom: 1px solid #FFFFFF;}.ace-chaos .ace_marker-layer .ace_selection {background: #494836;}.ace-chaos .ace_marker-layer .ace_step {background: rgb(198, 219, 174);}.ace-chaos .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid #FCE94F;}.ace-chaos .ace_marker-layer .ace_active-line {background: #333;}.ace-chaos .ace_gutter-active-line {background-color: #222;}.ace-chaos .ace_invisible {color: #404040;}.ace-chaos .ace_keyword {color:#00698F;}.ace-chaos .ace_keyword.ace_operator {color:#FF308F;}.ace-chaos .ace_constant {color:#1EDAFB;}.ace-chaos .ace_constant.ace_language {color:#FDC251;}.ace-chaos .ace_constant.ace_library {color:#8DFF0A;}.ace-chaos .ace_constant.ace_numeric {color:#58C554;}.ace-chaos .ace_invalid {color:#FFFFFF;background-color:#990000;}.ace-chaos .ace_invalid.ace_deprecated {color:#FFFFFF;background-color:#990000;}.ace-chaos .ace_support {color: #999;}.ace-chaos .ace_support.ace_function {color:#00AEEF;}.ace-chaos .ace_function {color:#00AEEF;}.ace-chaos .ace_string {color:#58C554;}.ace-chaos .ace_comment {color:#555;font-style:italic;padding-bottom: 0px;}.ace-chaos .ace_variable {color:#997744;}.ace-chaos .ace_meta.ace_tag {color:#BE53E6;}.ace-chaos .ace_entity.ace_other.ace_attribute-name {color:#FFFF89;}.ace-chaos .ace_markup.ace_underline {text-decoration: underline;}.ace-chaos .ace_fold-widget {text-align: center;}.ace-chaos .ace_fold-widget:hover {color: #777;}.ace-chaos .ace_fold-widget.ace_start,.ace-chaos .ace_fold-widget.ace_end,.ace-chaos .ace_fold-widget.ace_closed{background: none;border: none;box-shadow: none;}.ace-chaos .ace_fold-widget.ace_start:after {content: '▾'}.ace-chaos .ace_fold-widget.ace_end:after {content: '▴'}.ace-chaos .ace_fold-widget.ace_closed:after {content: '‣'}.ace-chaos .ace_indent-guide {border-right:1px dotted #333;margin-right:-1px;}.ace-chaos .ace_fold { background: #222; border-radius: 3px; color: #7AF; border: none; }.ace-chaos .ace_fold:hover {background: #CCC; color: #000;}</style><script src="../assets/javascripts/ace/snippets/scala.js"></script><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script src="../assets/javascripts/ace/snippets/markdown.js"></script><script src="../assets/javascripts/ace/snippets/html.js"></script><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
    <body class="wrap" style="zoom: 1;"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
        <header>
            <nav class="mobile-nav show-on-mobiles">
                    <!--{% include primary-nav-items.html %}-->
            </nav>
            <div class="grid">
                <div class="center-on-mobiles">
                    <h1>
                        <a href="../00_intro.html">
                            <h1 class="logo-text">StatNLP</h1>
                        </a>
                    </h1>
                    <div id="slidesButton">[<a id="toggle-view" href="../01_tasks/0x_textclassify_slides.html">Slides</a>]</div>
                </div>
            </div>
        </header>
        <section>
            <div class="grid">
                <div>
                
                    
                
                    
                
                    
                
                    
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; /&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" role="math" style="width: 0.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.002em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(3.867em 1000em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2"></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"></math></span></span><script type="math/tex" id="MathJax-Element-1">
  \def\prob{p}
  \def\vocab{V}
  \def\params{\boldsymbol{\theta}}
  \def\argmax{\mathop{\arg\,\max}}
  \def\param{\theta}
  \def\bpi{\boldsymbol{\pi}}
  \def\balpha{\boldsymbol{\alpha}}
  \def\bbeta{\boldsymbol{\beta}}
  \def\perplexity{PP}
  \def\x{\mathbf{x}}
  \def\y{\mathbf{y}}
  \def\Xs{\mathcal{X}}
  \def\Ys{\mathcal{Y}}
  \def\perplexity{PP}
  \def\train{\mathcal{D}_\mathit{train}}
  \def\counts#1#2{\#_{#1}(#2)}
  \def\RR{\bf R}
  \def\length#1{\mathop{length}(#1)}
  \def\aligns{\mathbf{a}}
  \def\align{a}
  \def\source{\mathbf{s}}
  \def\ssource{s}
  \def\target{\mathbf{t}}
  \def\starget{t}
</script>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                </div>
                <div id="static_content" class="unit center-on-mobiles">
                    <h1>Text Classification</h1>
                <div id="cell0" class="cellWrapper"><div id="editCell0" class="cell" hidden="true" style="display: none;"><div class="input"><div id="editor0" class="cell editor ace_editor ace-chaos ace_dark"><div style="position: absolute;"></div><textarea class="ace_text-input" wrap="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><a id="runCode0" role="button" class="runButton btn disabled" disabled="disabled" "=""><i class="fa fa-play-circle-o fa-2x"></i></a></div></div><div id="renderDisplay0" class="cell"><p>In many applications we need to automatically classify some input text with respect to a set of classes or labels. For example,</p>
<ul>
  <li>for information retrieval it is useful to classify documents into a set of topics, such as "sport" or "business",</li>
  <li>for sentiment analysis we classify tweets into being "positive" or "negative" and</li>
  <li>for Spam Filters we need to distinguish between Ham and Spam.</li>
</ul>
<!-- TODO: Load Web Corpus, 4 Universities, something were Maxent works --><h3>Text Classification as Structured Prediction</h3><p>We can formalize text classification as the simplest instance of <a href="../02_methods/00_structuredprediction.html">structured prediction</a> where the input space <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3" role="math" style="width: 0.92em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.176em 1000.77em 3.143em -999.998em); top: -2.993em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4"><span class="texatom" id="MathJax-Span-5"><span class="mrow" id="MathJax-Span-6"><span class="mi" id="MathJax-Span-7" style="font-family: STIXNonUnicode-Italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.998em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">X</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-2">\Xs</script> are sequences of words, and the output space <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8" role="math" style="width: 0.92em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.176em 1000.77em 3.287em -999.998em); top: -2.993em; left: 0.002em;"><span class="mrow" id="MathJax-Span-9"><span class="texatom" id="MathJax-Span-10"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: STIXNonUnicode-Italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.998em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.058em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">Y</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-3">\Ys</script> is a set of labels such as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mtext&gt;sports&lt;/mtext&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;business&lt;/mtext&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" role="math" style="width: 10.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.229em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.176em 1009.13em 3.336em -999.998em); top: -2.993em; left: 0.002em;"><span class="mrow" id="MathJax-Span-14"><span class="texatom" id="MathJax-Span-15"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17" style="font-family: STIXNonUnicode-Italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="mo" id="MathJax-Span-18" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mo" id="MathJax-Span-19" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">{</span><span class="mtext" id="MathJax-Span-20" style="font-family: STIXGeneral-Regular;">sports</span><span class="mo" id="MathJax-Span-21" style="font-family: STIXGeneral-Regular;">,</span><span class="mtext" id="MathJax-Span-22" style="font-family: STIXGeneral-Regular; padding-left: 0.196em;">business</span><span class="mo" id="MathJax-Span-23" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.998em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">Y</mi></mrow><mo>=</mo><mo fence="false" stretchy="false">{</mo><mtext>sports</mtext><mo>,</mo><mtext>business</mtext><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-4">\Ys=\{ \text{sports},\text{business}\} </script>. On a high level, our goal is to define a model a model <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-24" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.901em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1002.85em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-25"><span class="msubsup" id="MathJax-Span-26"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.39em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-27" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.389em;"><span class="texatom" id="MathJax-Span-28"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-31" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="mi" id="MathJax-Span-34" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-35" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-36" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-37" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">s_{\params}(\x,y)</script> that assigns high <em>scores</em> to the label <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-38" role="math" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.486em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.935em 1000.49em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-39"><span class="mi" id="MathJax-Span-40" style="font-family: STIXGeneral-Italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">y</script> that fits the text <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-41" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-42"><span class="texatom" id="MathJax-Span-43"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-7">\x</script>, and lower scores otherwise. The model will be parametrized by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-46" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">\params</script>, and these parameters we will learn from some training set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-49" role="math" style="width: 2.659em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.321em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.355em 1002.32em 2.466em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-50"><span class="msubsup" id="MathJax-Span-51"><span style="display: inline-block; position: relative; width: 2.273em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.77em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-52"><span class="mrow" id="MathJax-Span-53"><span class="mi" id="MathJax-Span-54" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.824em;"><span class="texatom" id="MathJax-Span-55"><span class="mrow" id="MathJax-Span-56"><span class="mi" id="MathJax-Span-57" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-58" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-59" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-60" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-61" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.058em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-9">\train</script> of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-62" role="math" style="width: 2.418em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.08em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1002.03em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-63"><span class="mo" id="MathJax-Span-64" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-65"><span class="mrow" id="MathJax-Span-66"><span class="mi" id="MathJax-Span-67" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-68" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-69" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-70" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-10">(\x,y)</script> pairs. When we need to classify a text <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-71" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-72"><span class="texatom" id="MathJax-Span-73"><span class="mrow" id="MathJax-Span-74"><span class="mi" id="MathJax-Span-75" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-11">\x</script> we have to solve the trivial (if the number of classes is low) maximization problem <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP&quot;&gt;&lt;mi&gt;arg&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-76" role="math" style="width: 7.925em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.862em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1006.81em 3.046em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-77"><span class="munderover" id="MathJax-Span-78"><span style="display: inline-block; position: relative; width: 3.771em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1003.38em 4.399em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-79"><span class="mrow" id="MathJax-Span-80"><span class="mi" id="MathJax-Span-81" style="font-family: STIXGeneral-Regular;">arg</span><span class="mspace" id="MathJax-Span-82" style="height: 0.002em; vertical-align: 0.002em; width: 0.196em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-83" style="font-family: STIXGeneral-Regular; padding-left: 0.196em;">max</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.766em; left: 3.384em;"><span class="mi" id="MathJax-Span-84" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-85"></span><span class="msubsup" id="MathJax-Span-86" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.39em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-87" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.389em;"><span class="texatom" id="MathJax-Span-88"><span class="mrow" id="MathJax-Span-89"><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-91" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-92"><span class="mrow" id="MathJax-Span-93"><span class="mi" id="MathJax-Span-94" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-95" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-96" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-97" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-OP"><mi>arg</mi><mspace width="thinmathspace"></mspace><mo movablelimits="true" form="prefix">max</mo></mrow><mi>y</mi></msub><mo>⁡</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">\argmax_y s_{\params}(\x,y)</script>. </p>
<!-- TODO: Show a silly classifier example? --><p>In the following we will present two typical approaches to text classifiers: Naive Bayes and discriminative linear classifiers. We will also see that both in fact can use the same model structure, and differ only in how model parameters are trained.</p></div></div><div id="cell1" class="cellWrapper"><div id="editCell1" class="cell" hidden="true" style="display: none;"><div class="input"><div id="editor1" class="cell editor ace_editor ace-chaos ace_dark"><div style="position: absolute;"></div><textarea class="ace_text-input" wrap="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><a id="runCode1" role="button" class="runButton btn disabled" disabled="disabled" "=""><i class="fa fa-play-circle-o fa-2x"></i></a></div></div><div id="renderDisplay1" class="cell"><h3>Naive Bayes</h3><p>One of the most widely used approaches to text classification relies on the so-called Naive Bayes (NB) Model. In NB we use a distribution <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-98" role="math" style="width: 2.37em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.031em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.017em 1002.03em 2.659em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-99"><span class="msubsup" id="MathJax-Span-100"><span style="display: inline-block; position: relative; width: 1.983em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-101" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.191em 1001.45em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-102"><span class="mrow" id="MathJax-Span-103"><span class="mstyle" id="MathJax-Span-104"><span class="mrow" id="MathJax-Span-105"><span class="mtext" id="MathJax-Span-106" style="font-family: STIXGeneral-Regular;">NB</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="mi" id="MathJax-Span-109" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mstyle displaystyle="false" scriptlevel="0"><mtext>NB</mtext></mstyle></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-13">p^{\mbox{NB}}_{\params}</script> for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-110" role="math" style="width: 1.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.597em 1000.87em 2.466em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-111"><span class="msubsup" id="MathJax-Span-112"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.39em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-113" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.389em;"><span class="mi" id="MathJax-Span-114" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.781em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi mathvariant="bold-italic">θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-14">s_\params</script>. In particular, we use the <em>a posteriori</em> probability of a label <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-115" role="math" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.486em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.935em 1000.49em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-116"><span class="mi" id="MathJax-Span-117" style="font-family: STIXGeneral-Italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">y</script> given the input text <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-118" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-119"><span class="texatom" id="MathJax-Span-120"><span class="mrow" id="MathJax-Span-121"><span class="mi" id="MathJax-Span-122" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-16">\x</script> as a score for that label given the text. </p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-1&quot;&gt;&lt;mtext&gt;(1)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-123" role="math" style="width: 100%; display: inline-block; min-width: 11.935em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 115%; min-width: 11.935em;"><span style="position: absolute; clip: rect(3.046em 1007.78em 4.495em -999.998em); top: -4.007em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-124"><span class="mtable" id="MathJax-Span-125" style="min-width: 11.935em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 11.935em;"><span style="display: inline-block; position: absolute; width: 7.829em; height: 0px; clip: rect(-0.964em 1007.78em 0.486em -999.998em); top: 0.002em; left: 50%; margin-left: -3.911em;"><span style="position: absolute; clip: rect(3.046em 1007.78em 4.495em -999.998em); top: -4.007em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 7.829em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1007.78em 4.495em -999.998em); top: -4.007em; left: 50%; margin-left: -3.911em;"><span class="mtd" id="MathJax-Span-129"><span class="mrow" id="MathJax-Span-130"><span class="msubsup" id="MathJax-Span-131"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.39em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-132" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.389em;"><span class="texatom" id="MathJax-Span-133"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-136" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-137"><span class="mrow" id="MathJax-Span-138"><span class="mi" id="MathJax-Span-139" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-140" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-141" style="padding-left: 0.196em;"><span class="mrow" id="MathJax-Span-142"><span class="mi" id="MathJax-Span-143" style="font-family: STIXGeneral; font-weight: bold;">y</span></span></span><span class="mo" id="MathJax-Span-144" style="font-family: STIXGeneral-Regular;">)</span><span class="mtext" id="MathJax-Span-145" style="font-family: STIXGeneral-Regular;">&nbsp;</span><span class="mo" id="MathJax-Span-146" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="msubsup" id="MathJax-Span-147" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-148" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-149"><span class="mrow" id="MathJax-Span-150"><span class="mtext" id="MathJax-Span-151" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-152"><span class="mrow" id="MathJax-Span-153"><span class="mi" id="MathJax-Span-154" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-155" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-156" style="font-family: STIXGeneral-Italic;">y</span><span class="texatom" id="MathJax-Span-157"><span class="mrow" id="MathJax-Span-158"><span class="mo" id="MathJax-Span-159" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-160"><span class="mrow" id="MathJax-Span-161"><span class="mi" id="MathJax-Span-162" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-163" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.162em; height: 0px; clip: rect(-0.819em 1001.11em 0.292em -999.998em); top: 0.002em; right: 0.002em; margin-right: 0.002em;"><span style="position: absolute; clip: rect(3.191em 1001.11em 4.35em -999.998em); top: -4.007em; right: 0.002em;"><span class="mtd" id="mjx-eqn-1"><span class="mrow" id="MathJax-Span-127"><span class="mtext" id="MathJax-Span-128" style="font-family: STIXGeneral-Regular;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.447em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-1"><mtext>(1)</mtext></mtd><mtd><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">y</mi></mrow><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mo>=</mo><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">\begin{equation}  s_{\params}(\x,\y)\ = p^{\text{NB}}_{\params}(y|\x) \end{equation}</script></p><p>By Bayes Law we get</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-2&quot;&gt;&lt;mtext&gt;(2)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-164" role="math" style="width: 100%; display: inline-block; min-width: 15.171em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 115%; min-width: 15.171em;"><span style="position: absolute; clip: rect(2.225em 1011.07em 5.268em -999.998em); top: -4.007em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-165"><span class="mtable" id="MathJax-Span-166" style="min-width: 15.171em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 15.171em;"><span style="display: inline-block; position: absolute; width: 11.065em; height: 0px; clip: rect(-1.785em 1011.07em 1.258em -999.998em); top: 0.002em; left: 50%; margin-left: -5.505em;"><span style="position: absolute; clip: rect(2.225em 1011.07em 5.268em -999.998em); top: -4.007em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 11.065em; height: 0px;"><span style="position: absolute; clip: rect(2.225em 1011.07em 5.268em -999.998em); top: -4.007em; left: 50%; margin-left: -5.505em;"><span class="mtd" id="MathJax-Span-170"><span class="mrow" id="MathJax-Span-171"><span class="msubsup" id="MathJax-Span-172"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-173" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-174"><span class="mrow" id="MathJax-Span-175"><span class="mtext" id="MathJax-Span-176" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-177"><span class="mrow" id="MathJax-Span-178"><span class="mi" id="MathJax-Span-179" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-180" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-181" style="font-family: STIXGeneral-Italic;">y</span><span class="texatom" id="MathJax-Span-182"><span class="mrow" id="MathJax-Span-183"><span class="mo" id="MathJax-Span-184" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-185"><span class="mrow" id="MathJax-Span-186"><span class="mi" id="MathJax-Span-187" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-188" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-189" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mfrac" id="MathJax-Span-190" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 6.186em; height: 0px; margin-right: 0.099em; margin-left: 0.099em;"><span style="position: absolute; clip: rect(3.046em 1005.99em 4.495em -999.998em); top: -4.829em; left: 50%; margin-left: -3.041em;"><span class="mrow" id="MathJax-Span-191"><span class="msubsup" id="MathJax-Span-192"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-193" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-194"><span class="mrow" id="MathJax-Span-195"><span class="mtext" id="MathJax-Span-196" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-197"><span class="mrow" id="MathJax-Span-198"><span class="mi" id="MathJax-Span-199" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-200" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-201"><span class="mrow" id="MathJax-Span-202"><span class="mi" id="MathJax-Span-203" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="texatom" id="MathJax-Span-204"><span class="mrow" id="MathJax-Span-205"><span class="mo" id="MathJax-Span-206" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-207" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-208" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-209"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-210" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="mtext" id="MathJax-Span-211" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-212"><span class="mrow" id="MathJax-Span-213"><span class="mi" id="MathJax-Span-214" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-215" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-216" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-217" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.046em 1002.61em 4.495em -999.998em); top: -3.234em; left: 50%; margin-left: -1.35em;"><span class="mrow" id="MathJax-Span-218"><span class="msubsup" id="MathJax-Span-219"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-220" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-221"><span class="mrow" id="MathJax-Span-222"><span class="mtext" id="MathJax-Span-223" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-224"><span class="mrow" id="MathJax-Span-225"><span class="mi" id="MathJax-Span-226" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-227" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-228" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-229" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(0.872em 1006.19em 1.21em -999.998em); top: -1.302em; left: 0.002em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.002em; border-top-width: 1.3px; border-top-style: solid; width: 6.186em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.065em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.162em; height: 0px; clip: rect(-0.819em 1001.11em 0.341em -999.998em); top: 0.002em; right: 0.002em; margin-right: 0.002em;"><span style="position: absolute; clip: rect(3.191em 1001.11em 4.35em -999.998em); top: -4.007em; right: 0.002em;"><span class="mtd" id="mjx-eqn-2"><span class="mrow" id="MathJax-Span-168"><span class="mtext" id="MathJax-Span-169" style="font-family: STIXGeneral-Regular;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.331em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 3.281em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-2"><mtext>(2)</mtext></mtd><mtd><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo stretchy="false">)</mo><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mtext>NB</mtext></msubsup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-18">\begin{equation}  p^{\text{NB}}_{\params}(y|\x) =  \frac{p^{\text{NB}}_{\params}(\x|y) p^\text{NB}_{\params}(y)}{p^{\text{NB}}_{\params}(x)} \end{equation}</script></p><p>and when an input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-230" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-231"><span class="texatom" id="MathJax-Span-232"><span class="mrow" id="MathJax-Span-233"><span class="mi" id="MathJax-Span-234" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-19">\x</script> is fixed we can focus on </p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-eqNB&quot;&gt;&lt;mtext&gt;(3)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-235" role="math" style="width: 100%; display: inline-block; min-width: 15.075em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 115%; min-width: 15.075em;"><span style="position: absolute; clip: rect(3.046em 1010.87em 4.495em -999.998em); top: -4.007em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-236"><span class="mtable" id="MathJax-Span-237" style="min-width: 15.075em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 15.075em;"><span style="display: inline-block; position: absolute; width: 10.92em; height: 0px; clip: rect(-0.964em 1010.87em 0.486em -999.998em); top: 0.002em; left: 50%; margin-left: -5.457em;"><span style="position: absolute; clip: rect(3.046em 1010.87em 4.495em -999.998em); top: -4.007em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 10.92em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1010.87em 4.495em -999.998em); top: -4.007em; left: 50%; margin-left: -5.457em;"><span class="mtd" id="MathJax-Span-241"><span class="mrow" id="MathJax-Span-242"><span class="msubsup" id="MathJax-Span-243"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-244" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-245"><span class="mrow" id="MathJax-Span-246"><span class="mtext" id="MathJax-Span-247" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-251" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-252"><span class="mrow" id="MathJax-Span-253"><span class="mi" id="MathJax-Span-254" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-255" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-256" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-257" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-258" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="msubsup" id="MathJax-Span-259" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-260" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mtext" id="MathJax-Span-263" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-264"><span class="mrow" id="MathJax-Span-265"><span class="mi" id="MathJax-Span-266" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-267" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-268"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="texatom" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="mo" id="MathJax-Span-273" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-274" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-275" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-276"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-277" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="mtext" id="MathJax-Span-278" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-279"><span class="mrow" id="MathJax-Span-280"><span class="mi" id="MathJax-Span-281" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-282" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-283" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-284" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.162em; height: 0px; clip: rect(-0.819em 1001.11em 0.292em -999.998em); top: 0.002em; right: 0.002em; margin-right: 0.002em;"><span style="position: absolute; clip: rect(3.191em 1001.11em 4.35em -999.998em); top: -4.007em; right: 0.002em;"><span class="mtd" id="mjx-eqn-eqNB"><span class="mrow" id="MathJax-Span-239"><span class="mtext" id="MathJax-Span-240" style="font-family: STIXGeneral-Regular;">(3)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.447em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-eqNB"><mtext>(3)</mtext></mtd><mtd><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo stretchy="false">)</mo><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mtext>NB</mtext></msubsup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">\begin{equation}\label{eq:NB} \prob^{\text{NB}}_{\params}(\x,y)= p^{\text{NB}}_{\params}(\x|y) p^\text{NB}_{\params}(y) \end{equation}</script></p><p>because in this case <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-285" role="math" style="width: 3.143em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.548em 1002.66em 2.998em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-286"><span class="msubsup" id="MathJax-Span-287"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-288" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-289"><span class="mrow" id="MathJax-Span-290"><span class="mtext" id="MathJax-Span-291" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-292"><span class="mrow" id="MathJax-Span-293"><span class="mi" id="MathJax-Span-294" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-295" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-296" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-297" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.447em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-21">p^{\text{NB}}_{\params}(x)</script> is a constant factor. In the above <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-298" role="math" style="width: 3.915em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.548em 1003.34em 2.998em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-299"><span class="msubsup" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-301" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-302"><span class="mrow" id="MathJax-Span-303"><span class="mtext" id="MathJax-Span-304" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-305"><span class="mrow" id="MathJax-Span-306"><span class="mi" id="MathJax-Span-307" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-308" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-309"><span class="mrow" id="MathJax-Span-310"><span class="mi" id="MathJax-Span-311" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="texatom" id="MathJax-Span-312"><span class="mrow" id="MathJax-Span-313"><span class="mo" id="MathJax-Span-314" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-315" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-316" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.447em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">p^{\text{NB}}_{\params}(\x|y)</script> is the <em>likelihood</em>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-317" role="math" style="width: 3.094em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.548em 1002.61em 2.998em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-318"><span class="msubsup" id="MathJax-Span-319"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-320" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="mtext" id="MathJax-Span-321" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-322"><span class="mrow" id="MathJax-Span-323"><span class="mi" id="MathJax-Span-324" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-325" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-326" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-327" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.447em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mtext>NB</mtext></msubsup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-23">p^\text{NB}_{\params}(y) </script> is the <em>prior</em>.</p>
<!--Let us assume that we have a number \\(K(\x)\\) of feature functions \\(f_k(\x)\\) that represent the input \\(\x\\). For example, in document classification this set could be used to represent the text \\(\x = (x_1,\ldots,x_n)\\) as a bag of words by setting \\(f_k(\x) = x_k\\) and \\(K(\x) = n\\). We could also use bigrams instead, setting \\(f_k(\x) = (x_k,x_{k+1})\\) and \\(K(\x) = n-1\\), or any other representation that is effective for distinguishing between classes of text.--><p>The "naivity" of NB stems from a certain conditional independence assumption we make for the likelihood <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-328" role="math" style="width: 4.399em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.819em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.355em 1003.77em 2.998em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-329"><span class="msubsup" id="MathJax-Span-330"><span style="display: inline-block; position: relative; width: 1.983em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-331" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.191em 1001.45em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-332"><span class="mrow" id="MathJax-Span-333"><span class="mstyle" id="MathJax-Span-334"><span class="mrow" id="MathJax-Span-335"><span class="mtext" id="MathJax-Span-336" style="font-family: STIXGeneral-Regular;">NB</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-337"><span class="mrow" id="MathJax-Span-338"><span class="mi" id="MathJax-Span-339" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-340" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-341"><span class="mrow" id="MathJax-Span-342"><span class="mi" id="MathJax-Span-343" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="texatom" id="MathJax-Span-344"><span class="mrow" id="MathJax-Span-345"><span class="mo" id="MathJax-Span-346" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-347" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-348" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mstyle displaystyle="false" scriptlevel="0"><mtext>NB</mtext></mstyle></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-24">p^{\mbox{NB}}_{\params}(\x|y)</script>. Note that conditional independence of two events <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-349" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.935em 1000.49em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-350"><span class="mi" id="MathJax-Span-351" style="font-family: STIXGeneral-Italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.614em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">a</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-352" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1000.49em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-353"><span class="mi" id="MathJax-Span-354" style="font-family: STIXGeneral-Italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">b</script> given a third event <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-355" role="math" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.486em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.935em 1000.49em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-356"><span class="mi" id="MathJax-Span-357" style="font-family: STIXGeneral-Italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.614em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">c</script> requires that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-358" role="math" style="width: 10.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.181em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1009.13em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-359"><span class="mi" id="MathJax-Span-360" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-361" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-362" style="font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-363" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-364" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">b</span><span class="texatom" id="MathJax-Span-365"><span class="mrow" id="MathJax-Span-366"><span class="mo" id="MathJax-Span-367" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-368" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-369" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-370" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mi" id="MathJax-Span-371" style="font-family: STIXGeneral-Italic; padding-left: 0.292em;">p</span><span class="mo" id="MathJax-Span-372" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-373" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-374"><span class="mrow" id="MathJax-Span-375"><span class="mo" id="MathJax-Span-376" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-377" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-378" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-379" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-380" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-381" style="font-family: STIXGeneral-Italic;">b</span><span class="texatom" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="mo" id="MathJax-Span-384" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-385" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-386" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>c</mi><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-28">p(a,b|c) = p(a|c) p(b|c)</script>. In particular, for the likelihood in NB we have:</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-4&quot;&gt;&lt;mtext&gt;(4)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;length&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-387" role="math" style="width: 100%; display: inline-block; min-width: 15.171em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 115%; min-width: 15.171em;"><span style="position: absolute; clip: rect(2.176em 1010.97em 5.558em -999.998em); top: -4.104em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-388"><span class="mtable" id="MathJax-Span-389" style="min-width: 15.171em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 15.171em;"><span style="display: inline-block; position: absolute; width: 11.017em; height: 0px; clip: rect(-1.93em 1010.97em 1.452em -999.998em); top: 0.002em; left: 50%; margin-left: -5.505em;"><span style="position: absolute; clip: rect(2.176em 1010.97em 5.558em -999.998em); top: -4.104em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 11.017em; height: 0px;"><span style="position: absolute; clip: rect(2.128em 1010.97em 5.51em -999.998em); top: -4.056em; left: 50%; margin-left: -5.505em;"><span class="mtd" id="MathJax-Span-393"><span class="mrow" id="MathJax-Span-394"><span class="msubsup" id="MathJax-Span-395"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-396" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-397"><span class="mrow" id="MathJax-Span-398"><span class="mtext" id="MathJax-Span-399" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-400"><span class="mrow" id="MathJax-Span-401"><span class="mi" id="MathJax-Span-402" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-403" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-404"><span class="mrow" id="MathJax-Span-405"><span class="mi" id="MathJax-Span-406" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="texatom" id="MathJax-Span-407"><span class="mrow" id="MathJax-Span-408"><span class="mo" id="MathJax-Span-409" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-410" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-411" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-412" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-413" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 2.611em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1001.31em 4.64em -999.998em); top: -4.007em; left: 0.63em;"><span class="mo" id="MathJax-Span-414" style="font-family: STIXSizeOneSym; vertical-align: -0.529em;">∏</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.2em 4.254em -999.998em); top: -2.848em; left: 1.21em;"><span class="mi" id="MathJax-Span-415" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.287em 1002.56em 4.302em -999.998em); top: -5.263em; left: 0.002em;"><span class="texatom" id="MathJax-Span-416"><span class="mrow" id="MathJax-Span-417"><span class="mtext" id="MathJax-Span-418" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">length</span><span class="mo" id="MathJax-Span-419" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-420"><span class="mrow" id="MathJax-Span-421"><span class="mi" id="MathJax-Span-422" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-423" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-424" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-425" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-426"><span class="mrow" id="MathJax-Span-427"><span class="mtext" id="MathJax-Span-428" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-429"><span class="mrow" id="MathJax-Span-430"><span class="mi" id="MathJax-Span-431" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-432" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-433"><span style="display: inline-block; position: relative; width: 0.727em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-434" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.437em;"><span class="mi" id="MathJax-Span-435" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="texatom" id="MathJax-Span-436"><span class="mrow" id="MathJax-Span-437"><span class="mo" id="MathJax-Span-438" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-439" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-440" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.109em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.162em; height: 0px; clip: rect(-0.771em 1001.11em 0.341em -999.998em); top: 0.002em; right: 0.002em; margin-right: 0.002em;"><span style="position: absolute; clip: rect(3.191em 1001.11em 4.35em -999.998em); top: -3.959em; right: 0.002em;"><span class="mtd" id="mjx-eqn-4"><span class="mrow" id="MathJax-Span-391"><span class="mtext" id="MathJax-Span-392" style="font-family: STIXGeneral-Regular;">(4)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.109em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.553em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 3.669em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-4"><mtext>(4)</mtext></mtd><mtd><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mtext>length</mtext><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow></munderover><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-29">\begin{equation}  p^{\text{NB}}_{\params}(\x|y) =  \prod_i^{\text{length}(\x)} p^{\text{NB}}_{\params}(x_i|y) \end{equation}</script></p><p>That is, NB makes the assumption that the observed wors are independent of each other when <em>conditioned on the label</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-441" role="math" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.486em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.935em 1000.49em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-442"><span class="mi" id="MathJax-Span-443" style="font-family: STIXGeneral-Italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">y</script>. </p>
<!--TODO: Evaluate NB assumption on actual data. Show that features aren't independent, but more independent when conditioned on the label.--></div></div><div id="cell8" class="cellWrapper"><div id="editCell8" class="cell" hidden="true" style="display: none;"><div class="input"><div id="editor8" class="cell editor ace_editor ace-chaos ace_dark"><div style="position: absolute;"></div><textarea class="ace_text-input" wrap="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><a id="runCode8" role="button" class="runButton btn disabled" disabled="disabled" "=""><i class="fa fa-play-circle-o fa-2x"></i></a></div></div><div id="renderDisplay8" class="cell"><h4>Parametrization</h4><p>The NB model has the parameters <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-444" role="math" style="width: 4.592em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.964em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1003.91em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-445"><span class="mi" id="MathJax-Span-446" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span class="mo" id="MathJax-Span-447" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mo" id="MathJax-Span-448" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">(</span><span class="mi" id="MathJax-Span-449" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">α</span><span class="mo" id="MathJax-Span-450" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-451" style="font-family: STIXGeneral; font-style: italic; font-weight: bold; padding-left: 0.196em;">β</span><span class="mo" id="MathJax-Span-452" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">θ</mi><mo>=</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">α</mi><mo>,</mo><mi mathvariant="bold-italic">β</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-31">\params=(\balpha,\bbeta)</script> where </p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-453" role="math" style="width: 7.297em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.331em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(0.437em 1006.19em 3.384em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-454"><span class="mtable" id="MathJax-Span-455" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 5.993em; height: 0px;"><span style="position: absolute; clip: rect(2.273em 1003.24em 5.22em -999.998em); top: -4.007em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1003.24em 4.495em -999.998em); top: -4.78em; right: 0.002em;"><span class="mtd" id="MathJax-Span-456"><span class="mrow" id="MathJax-Span-457"><span class="msubsup" id="MathJax-Span-458"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-459" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-460"><span class="mrow" id="MathJax-Span-461"><span class="mtext" id="MathJax-Span-462" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-463"><span class="mrow" id="MathJax-Span-464"><span class="mi" id="MathJax-Span-465" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-466" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-467" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.147em;"></span></span><span class="texatom" id="MathJax-Span-468"><span class="mrow" id="MathJax-Span-469"><span class="mo" id="MathJax-Span-470" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-471" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-472" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.046em 1002.61em 4.495em -999.998em); top: -3.283em; right: 0.002em;"><span class="mtd" id="MathJax-Span-484"><span class="mrow" id="MathJax-Span-485"><span class="msubsup" id="MathJax-Span-486"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-487" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-488"><span class="mrow" id="MathJax-Span-489"><span class="mtext" id="MathJax-Span-490" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-491"><span class="mrow" id="MathJax-Span-492"><span class="mi" id="MathJax-Span-493" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-494" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-495" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-496" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(2.659em 1002.71em 5.171em -999.998em); top: -4.007em; left: 3.287em;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1002.71em 4.447em -999.998em); top: -4.78em; left: 0.002em;"><span class="mtd" id="MathJax-Span-473"><span class="mrow" id="MathJax-Span-474"><span class="mi" id="MathJax-Span-475"></span><span class="mo" id="MathJax-Span-476" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="msubsup" id="MathJax-Span-477" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 1.403em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.53em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-478" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.534em;"><span class="texatom" id="MathJax-Span-479"><span class="mrow" id="MathJax-Span-480"><span class="mi" id="MathJax-Span-481" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.099em;"></span></span><span class="mo" id="MathJax-Span-482" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-483" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.191em 1002.37em 4.447em -999.998em); top: -3.283em; left: 0.002em;"><span class="mtd" id="MathJax-Span-497"><span class="mrow" id="MathJax-Span-498"><span class="mi" id="MathJax-Span-499"></span><span class="mo" id="MathJax-Span-500" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="msubsup" id="MathJax-Span-501" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.53em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-502" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.486em;"><span class="texatom" id="MathJax-Span-503"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-506" style="font-family: STIXGeneral-Regular;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 3.169em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mi>α</mi><mrow class="MJX-TeXAtom-ORD"><mi>f</mi><mo>,</mo><mi>y</mi></mrow></msub></mtd></mtr><mtr><mtd><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo>.</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-32">\begin{split}  p^{\text{NB}}_{\params}(f|y) & = \alpha_{f,y} \\  p^{\text{NB}}_{\params}(y) & = \beta_{y}. \end{split}</script></p><p>That is, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-507" role="math" style="width: 0.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.58em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-508"><span class="mi" id="MathJax-Span-509" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">α</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">α</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">\balpha</script> captures the per-class feature weights, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-510" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1000.53em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-511"><span class="mi" id="MathJax-Span-512" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">β</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">β</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">\bbeta</script> the class priors. </p><h4>Training the Naive Bayes Model</h4><p>The NB model again can be trained using Maximum Likelihood estimation. This amounts to setting </p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-513" role="math" style="width: 8.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.587em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(-0.674em 1007.44em 4.543em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-514"><span class="mtable" id="MathJax-Span-515" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 7.249em; height: 0px;"><span style="position: absolute; clip: rect(2.466em 1001.45em 6.186em -999.998em); top: -4.394em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.452em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1001.45em 4.447em -999.998em); top: -5.312em; right: 0.002em;"><span class="mtd" id="MathJax-Span-516"><span class="mrow" id="MathJax-Span-517"><span class="msubsup" id="MathJax-Span-518"><span style="display: inline-block; position: relative; width: 1.452em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.53em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-519" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.534em;"><span class="texatom" id="MathJax-Span-520"><span class="mrow" id="MathJax-Span-521"><span class="mi" id="MathJax-Span-522" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-523" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-524" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.191em 1000.92em 4.447em -999.998em); top: -2.655em; right: 0.002em;"><span class="mtd" id="MathJax-Span-570"><span class="mrow" id="MathJax-Span-571"><span class="msubsup" id="MathJax-Span-572"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.53em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-573" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.486em;"><span class="texatom" id="MathJax-Span-574"><span class="mrow" id="MathJax-Span-575"><span class="mi" id="MathJax-Span-576" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.399em;"></span></span><span style="position: absolute; clip: rect(3.094em 1005.8em 8.312em -999.998em); top: -5.94em; left: 1.452em;"><span style="display: inline-block; position: relative; width: 5.8em; height: 0px;"><span style="position: absolute; clip: rect(2.466em 1005.8em 5.123em -999.998em); top: -5.312em; left: 0.002em;"><span class="mtd" id="MathJax-Span-525"><span class="mrow" id="MathJax-Span-526"><span class="mi" id="MathJax-Span-527"></span><span class="mo" id="MathJax-Span-528" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mfrac" id="MathJax-Span-529" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 4.302em; height: 0px; margin-right: 0.099em; margin-left: 0.099em;"><span style="position: absolute; clip: rect(3.191em 1004.11em 4.399em -999.998em); top: -4.732em; left: 50%; margin-left: -2.075em;"><span class="mrow" id="MathJax-Span-530"><span class="msubsup" id="MathJax-Span-531"><span style="display: inline-block; position: relative; width: 2.176em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.49em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-532" style="font-family: STIXGeneral-Regular;">#</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.486em;"><span class="texatom" id="MathJax-Span-533"><span class="mrow" id="MathJax-Span-534"><span class="msubsup" id="MathJax-Span-535"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-536"><span class="mrow" id="MathJax-Span-537"><span class="mi" id="MathJax-Span-538" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.911em; left: 0.582em;"><span class="texatom" id="MathJax-Span-539"><span class="mrow" id="MathJax-Span-540"><span class="mi" id="MathJax-Span-541" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-542" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-543" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-544" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-545" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-546" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-547" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-548" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-549" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-550" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.191em 1003.24em 4.399em -999.998em); top: -3.331em; left: 50%; margin-left: -1.64em;"><span class="mrow" id="MathJax-Span-551"><span class="msubsup" id="MathJax-Span-552"><span style="display: inline-block; position: relative; width: 2.176em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.49em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-553" style="font-family: STIXGeneral-Regular;">#</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.486em;"><span class="texatom" id="MathJax-Span-554"><span class="mrow" id="MathJax-Span-555"><span class="msubsup" id="MathJax-Span-556"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-557"><span class="mrow" id="MathJax-Span-558"><span class="mi" id="MathJax-Span-559" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.911em; left: 0.582em;"><span class="texatom" id="MathJax-Span-560"><span class="mrow" id="MathJax-Span-561"><span class="mi" id="MathJax-Span-562" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-563" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-564" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-565" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-566" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-567" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-568" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-569" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(0.872em 1004.3em 1.21em -999.998em); top: -1.302em; left: 0.002em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.002em; border-top-width: 1.3px; border-top-style: solid; width: 4.302em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.065em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(2.466em 1004.93em 5.027em -999.998em); top: -2.655em; left: 0.002em;"><span class="mtd" id="MathJax-Span-577"><span class="mrow" id="MathJax-Span-578"><span class="mi" id="MathJax-Span-579"></span><span class="mo" id="MathJax-Span-580" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mfrac" id="MathJax-Span-581" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px; margin-right: 0.099em; margin-left: 0.099em;"><span style="position: absolute; clip: rect(3.191em 1003.24em 4.399em -999.998em); top: -4.732em; left: 50%; margin-left: -1.64em;"><span class="mrow" id="MathJax-Span-582"><span class="msubsup" id="MathJax-Span-583"><span style="display: inline-block; position: relative; width: 2.176em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.49em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-584" style="font-family: STIXGeneral-Regular;">#</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.486em;"><span class="texatom" id="MathJax-Span-585"><span class="mrow" id="MathJax-Span-586"><span class="msubsup" id="MathJax-Span-587"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-588"><span class="mrow" id="MathJax-Span-589"><span class="mi" id="MathJax-Span-590" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.911em; left: 0.582em;"><span class="texatom" id="MathJax-Span-591"><span class="mrow" id="MathJax-Span-592"><span class="mi" id="MathJax-Span-593" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-594" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-595" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-596" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-597" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-598" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-599" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-600" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.191em 1002.71em 4.35em -999.998em); top: -3.331em; left: 50%; margin-left: -1.399em;"><span class="mrow" id="MathJax-Span-601"><span class="mo" id="MathJax-Span-602" style="vertical-align: 0.679em;"><span style="display: inline-block; position: relative; width: 0.292em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.331em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.331em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-603"><span style="display: inline-block; position: relative; width: 2.273em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.77em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-604"><span class="mrow" id="MathJax-Span-605"><span class="mi" id="MathJax-Span-606" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.824em;"><span class="texatom" id="MathJax-Span-607"><span class="mrow" id="MathJax-Span-608"><span class="mi" id="MathJax-Span-609" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-610" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-611" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-612" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-613" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-614" style="vertical-align: 0.679em;"><span style="display: inline-block; position: relative; width: 0.292em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.331em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.331em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(0.872em 1003.38em 1.21em -999.998em); top: -1.302em; left: 0.002em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.002em; border-top-width: 1.3px; border-top-style: solid; width: 3.384em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.065em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.944em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.608em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 5.781em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>α</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>,</mo><mi>y</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac><mrow><msub><mi mathvariant="normal">#</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi mathvariant="normal">#</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd><msub><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac><mrow><msub><mi mathvariant="normal">#</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><mo>|</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub><mo>|</mo></mrow></mfrac></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-35">\begin{split}  \alpha_{x,y} & = \frac{\counts{\train}{x,y}}{\counts{\train}{y}}\\  \beta_{y} & = \frac{\counts{\train}{y}}{\left| \train \right|} \end{split}</script></p></div></div><div id="cell2" class="cellWrapper"><div id="editCell2" class="cell" hidden="true" style="display: none;"><div class="input"><div id="editor2" class="cell editor ace_editor ace-chaos ace_dark"><div style="position: absolute;"></div><textarea class="ace_text-input" wrap="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><a id="runCode2" role="button" class="runButton btn disabled" disabled="disabled" "=""><i class="fa fa-play-circle-o fa-2x"></i></a></div></div><div id="renderDisplay2" class="cell"><h4>Log-linear Representation</h4><p>It will be convenient to represent the NB model in <em>log-linear</em> form. This form will allow us to understand the MLE NB simply as one particular way of training a (log) linear model. It will also make the approach comparable to other approaches such as Conditional Log-Likelihood (aka <em>logistic regression</em> or <em>maximum entropy</em>) or SVM style training that can operate on the same parametrisation but estimate the parameters using different objectives. Finally, the log-linear representation will make it easy to implement different training algorithms that work with the same representation and hence can be easily plugged-in and out.</p><p>In log-linear form the joint NB distribution <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-615" role="math" style="width: 4.205em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.626em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.548em 1003.58em 2.998em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-616"><span class="msubsup" id="MathJax-Span-617"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-618" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-619"><span class="mrow" id="MathJax-Span-620"><span class="mtext" id="MathJax-Span-621" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-622"><span class="mrow" id="MathJax-Span-623"><span class="mi" id="MathJax-Span-624" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-625" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-626"><span class="mrow" id="MathJax-Span-627"><span class="mi" id="MathJax-Span-628" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-629" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-630" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-631" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.447em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-36">p^{\text{NB}}_{\params}(\x,y)</script> can be written as: </p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-eq-loglinear&quot;&gt;&lt;mtext&gt;(5)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;I&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-632" role="math" style="width: 100%; display: inline-block; min-width: 25.655em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 115%; min-width: 25.655em;"><span style="position: absolute; clip: rect(2.128em 1021.45em 5.51em -999.998em); top: -4.056em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-633"><span class="mtable" id="MathJax-Span-634" style="min-width: 25.655em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 25.655em;"><span style="display: inline-block; position: absolute; width: 21.5em; height: 0px; clip: rect(-1.93em 1021.45em 1.452em -999.998em); top: 0.002em; left: 50%; margin-left: -10.722em;"><span style="position: absolute; clip: rect(2.128em 1021.45em 5.51em -999.998em); top: -4.056em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 21.5em; height: 0px;"><span style="position: absolute; clip: rect(2.128em 1021.45em 5.51em -999.998em); top: -4.056em; left: 50%; margin-left: -10.722em;"><span class="mtd" id="MathJax-Span-638"><span class="mrow" id="MathJax-Span-639"><span class="msubsup" id="MathJax-Span-640"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-641" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-642"><span class="mrow" id="MathJax-Span-643"><span class="mtext" id="MathJax-Span-644" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-645"><span class="mrow" id="MathJax-Span-646"><span class="mi" id="MathJax-Span-647" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-648" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-649"><span class="mrow" id="MathJax-Span-650"><span class="mi" id="MathJax-Span-651" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-652" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-653" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-654" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-655" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mi" id="MathJax-Span-656" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">exp</span><span class="mo" id="MathJax-Span-657"></span><span class="mrow" id="MathJax-Span-658"><span class="mo" id="MathJax-Span-659" style="vertical-align: -0.771em;"><span style="font-family: STIXSizeFourSym;">(</span></span><span class="munderover" id="MathJax-Span-660"><span style="display: inline-block; position: relative; width: 1.307em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1001.21em 4.64em -999.998em); top: -4.007em; left: 0.002em;"><span class="mo" id="MathJax-Span-661" style="font-family: STIXSizeOneSym; vertical-align: -0.529em;">∑</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.11em 4.254em -999.998em); top: -2.848em; left: 0.099em;"><span class="texatom" id="MathJax-Span-662"><span class="mrow" id="MathJax-Span-663"><span class="mi" id="MathJax-Span-664" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-665" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="texatom" id="MathJax-Span-666"><span class="mrow" id="MathJax-Span-667"><span class="mi" id="MathJax-Span-668" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-669" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-670" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.147em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.292em;"><span class="mi" id="MathJax-Span-671" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-672" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-673" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-674" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-675" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-676" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-677"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.63em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-678" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.679em;"><span class="mi" id="MathJax-Span-679" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-680" style="vertical-align: -0.771em;"><span style="font-family: STIXSizeFourSym;">)</span></span></span><span class="mo" id="MathJax-Span-681" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mi" id="MathJax-Span-682" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">exp</span><span class="mo" id="MathJax-Span-683" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">&lt;</span><span class="texatom" id="MathJax-Span-684" style="padding-left: 0.292em;"><span class="mrow" id="MathJax-Span-685"><span class="mi" id="MathJax-Span-686" style="font-family: STIXGeneral; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="mo" id="MathJax-Span-687" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-688"><span class="mrow" id="MathJax-Span-689"><span class="mi" id="MathJax-Span-690" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-691" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-692" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-693" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-694" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-695" style="padding-left: 0.196em;"><span class="mrow" id="MathJax-Span-696"><span class="mi" id="MathJax-Span-697" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-698" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.06em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.162em; height: 0px; clip: rect(-0.819em 1001.11em 0.341em -999.998em); top: 0.002em; right: 0.002em; margin-right: 0.002em;"><span style="position: absolute; clip: rect(3.191em 1001.11em 4.35em -999.998em); top: -4.007em; right: 0.002em;"><span class="mtd" id="mjx-eqn-eq-loglinear"><span class="mrow" id="MathJax-Span-636"><span class="mtext" id="MathJax-Span-637" style="font-family: STIXGeneral-Regular;">(5)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.553em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 3.669em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-eq-loglinear"><mtext>(5)</mtext></mtd><mtd><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mrow><mo>(</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">I</mi></mrow></mrow></munder><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><msub><mi>w</mi><mi>i</mi></msub><mo>)</mo></mrow><mo>=</mo><mi>exp</mi><mo>&lt;</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo>&gt;</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-37">\begin{equation}\label{eq-loglinear}  p^{\text{NB}}_{\params}(\x,y)= \exp \left( \sum_{i \in \mathcal{I}} f_i(x,y) w_i \right) = \exp < \mathbf{f}(\x,y), \mathbf{w}> \end{equation}</script></p><p>Here the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-699" role="math" style="width: 0.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.355em 1000.58em 2.514em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-700"><span class="msubsup" id="MathJax-Span-701"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-702" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.147em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.292em;"><span class="mi" id="MathJax-Span-703" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-38">f_i</script> are so called (joint) <em>feature functions</em>. The index set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;I&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-704" role="math" style="width: 0.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.176em 1000.58em 3.143em -999.998em); top: -2.993em; left: 0.002em;"><span class="mrow" id="MathJax-Span-705"><span class="texatom" id="MathJax-Span-706"><span class="mrow" id="MathJax-Span-707"><span class="mi" id="MathJax-Span-708" style="font-family: STIXNonUnicode-Italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.998em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">I</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-39">\mathcal{I}</script> is the union of all labels <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-709" role="math" style="width: 3.287em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.853em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.08em 1002.85em 3.336em -999.998em); top: -2.993em; left: 0.002em;"><span class="mrow" id="MathJax-Span-710"><span class="msup" id="MathJax-Span-711"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-712" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.394em; left: 0.437em;"><span class="mo" id="MathJax-Span-713" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-714" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">∈</span><span class="texatom" id="MathJax-Span-715" style="padding-left: 0.292em;"><span class="mrow" id="MathJax-Span-716"><span class="mi" id="MathJax-Span-717" style="font-family: STIXNonUnicode-Italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.998em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mo>′</mo></msup><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">Y</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-40">y'\in \Ys</script> and all word-label pairs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-718" role="math" style="width: 3.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.756em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.597em 1002.71em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-719"><span class="mo" id="MathJax-Span-720" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-721"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-722" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.394em; left: 0.486em;"><span class="mo" id="MathJax-Span-723" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-724" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-725" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-726" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.394em; left: 0.437em;"><span class="mo" id="MathJax-Span-727" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-728" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-41">(x',y')</script>, and the corresponding feature functions are defined as follows:</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;length&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-729" role="math" style="width: 16.331em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.205em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(-0.481em 1014.01em 4.35em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-730"><span class="mtable" id="MathJax-Span-731" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 13.867em; height: 0px;"><span style="position: absolute; clip: rect(1.935em 1003.67em 5.655em -999.998em); top: -4.442em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 3.722em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1002.9em 4.447em -999.998em); top: -5.698em; right: 0.002em;"><span class="mtd" id="MathJax-Span-732"><span class="mrow" id="MathJax-Span-733"><span class="msubsup" id="MathJax-Span-734"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-735" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.147em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.292em;"><span class="texatom" id="MathJax-Span-736"><span class="mrow" id="MathJax-Span-737"><span class="msup" id="MathJax-Span-738"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-739" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-740" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-741" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-742"><span class="mrow" id="MathJax-Span-743"><span class="mi" id="MathJax-Span-744" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-745" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-746" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-747" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.191em 1003.67em 4.447em -999.998em); top: -3.234em; right: 0.002em;"><span class="mtd" id="MathJax-Span-762"><span class="mrow" id="MathJax-Span-763"><span class="msubsup" id="MathJax-Span-764"><span style="display: inline-block; position: relative; width: 1.645em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-765" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.147em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.292em;"><span class="texatom" id="MathJax-Span-766"><span class="mrow" id="MathJax-Span-767"><span class="msup" id="MathJax-Span-768"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.34em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-769" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.389em;"><span class="mo" id="MathJax-Span-770" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-771" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-772"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-773" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-774" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-775" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-776"><span class="mrow" id="MathJax-Span-777"><span class="mi" id="MathJax-Span-778" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-779" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-780" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-781" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.447em;"></span></span><span style="position: absolute; clip: rect(2.901em 1010.1em 7.732em -999.998em); top: -5.553em; left: 3.722em;"><span style="display: inline-block; position: relative; width: 10.147em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1004.01em 4.35em -999.998em); top: -5.698em; left: 0.002em;"><span class="mtd" id="MathJax-Span-748"><span class="mrow" id="MathJax-Span-749"><span class="mi" id="MathJax-Span-750"></span><span class="mo" id="MathJax-Span-751" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mi" id="MathJax-Span-752" style="font-family: STIXGeneral-Italic; padding-left: 0.292em;">δ</span><span class="mo" id="MathJax-Span-753" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-754"><span class="mrow" id="MathJax-Span-755"><span class="mi" id="MathJax-Span-756" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-757" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-758" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-759" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.442em; left: 0.437em;"><span class="mo" id="MathJax-Span-760" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-761" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(2.128em 1010.1em 5.51em -999.998em); top: -3.331em; left: 0.002em;"><span class="mtd" id="MathJax-Span-782"><span class="mrow" id="MathJax-Span-783"><span class="mi" id="MathJax-Span-784"></span><span class="mo" id="MathJax-Span-785" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mi" id="MathJax-Span-786" style="font-family: STIXGeneral-Italic; padding-left: 0.292em;">δ</span><span class="mo" id="MathJax-Span-787" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-788"><span class="mrow" id="MathJax-Span-789"><span class="mi" id="MathJax-Span-790" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-791" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-792" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-793" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.442em; left: 0.437em;"><span class="mo" id="MathJax-Span-794" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-795" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-796" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 2.611em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1001.21em 4.64em -999.998em); top: -4.007em; left: 0.63em;"><span class="mo" id="MathJax-Span-797" style="font-family: STIXSizeOneSym; vertical-align: -0.529em;">∑</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.2em 4.254em -999.998em); top: -2.848em; left: 1.21em;"><span class="mi" id="MathJax-Span-798" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.287em 1002.56em 4.302em -999.998em); top: -5.263em; left: 0.002em;"><span class="texatom" id="MathJax-Span-799"><span class="mrow" id="MathJax-Span-800"><span class="mtext" id="MathJax-Span-801" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">length</span><span class="mo" id="MathJax-Span-802" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-803"><span class="mrow" id="MathJax-Span-804"><span class="mi" id="MathJax-Span-805" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-806" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mi" id="MathJax-Span-807" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">δ</span><span class="mo" id="MathJax-Span-808" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-809"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-810" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.442em; left: 0.486em;"><span class="mo" id="MathJax-Span-811" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-812" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-813" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.727em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-814" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.437em;"><span class="mi" id="MathJax-Span-815" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-816" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.558em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.386em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 5.336em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>y</mi><mo>′</mo></msup></mrow></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>δ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup></mrow><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>x</mi><mo>′</mo></msup><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup></mrow></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>δ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup></mrow><mo stretchy="false">)</mo><munderover><mo>∑</mo><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mtext>length</mtext><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow></munderover><mi>δ</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo>′</mo></msup><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-42">\begin{split}  f_{y'}(\x,y) & = \delta({y,y'}) \\  f_{x',y'}(\x,y) & = \delta({y,y'}) \sum_i^{\text{length}(\x)} \delta(x',x_i) \end{split}</script></p><p>In words, the first feature function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-817" role="math" style="width: 1.065em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.355em 1000.92em 2.611em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-818"><span class="msubsup" id="MathJax-Span-819"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-820" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.147em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.292em;"><span class="texatom" id="MathJax-Span-821"><span class="mrow" id="MathJax-Span-822"><span class="msup" id="MathJax-Span-823"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-824" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-825" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>y</mi><mo>′</mo></msup></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-43">f_{y'}</script> returns 1 if the input label <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-826" role="math" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.486em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.935em 1000.49em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-827"><span class="mi" id="MathJax-Span-828" style="font-family: STIXGeneral-Italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">y</script> equals <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-829" role="math" style="width: 0.969em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.258em 1000.82em 2.514em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-830"><span class="msup" id="MathJax-Span-831"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-832" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.394em; left: 0.437em;"><span class="mo" id="MathJax-Span-833" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-45">y'</script>, and 0 otherwise. The second feature function returns the number of times the word <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-834" role="math" style="width: 1.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.258em 1000.87em 2.321em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-835"><span class="msup" id="MathJax-Span-836"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-837" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.394em; left: 0.486em;"><span class="mo" id="MathJax-Span-838" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-46">x'</script> appears in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-839" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-840"><span class="texatom" id="MathJax-Span-841"><span class="mrow" id="MathJax-Span-842"><span class="mi" id="MathJax-Span-843" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-47">\x</script> if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-844" role="math" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.486em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.935em 1000.49em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-845"><span class="mi" id="MathJax-Span-846" style="font-family: STIXGeneral-Italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">y</script> equals <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-847" role="math" style="width: 0.969em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.258em 1000.82em 2.514em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-848"><span class="msup" id="MathJax-Span-849"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-850" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.394em; left: 0.437em;"><span class="mo" id="MathJax-Span-851" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-49">y'</script>, and 0 otherwise.</p><p>If one now sets the weights according to</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-852" role="math" style="width: 8.118em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.056em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(0.534em 1006.91em 3.336em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-853"><span class="mtable" id="MathJax-Span-854" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 6.717em; height: 0px;"><span style="position: absolute; clip: rect(2.708em 1002.03em 5.171em -999.998em); top: -4.007em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.031em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1001.26em 4.447em -999.998em); top: -4.732em; right: 0.002em;"><span class="mtd" id="MathJax-Span-855"><span class="mrow" id="MathJax-Span-856"><span class="msubsup" id="MathJax-Span-857"><span style="display: inline-block; position: relative; width: 1.258em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.63em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-858" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.679em;"><span class="texatom" id="MathJax-Span-859"><span class="mrow" id="MathJax-Span-860"><span class="msup" id="MathJax-Span-861"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-862" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-863" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.432em 1002.03em 4.447em -999.998em); top: -3.283em; right: 0.002em;"><span class="mtd" id="MathJax-Span-877"><span class="mrow" id="MathJax-Span-878"><span class="msubsup" id="MathJax-Span-879"><span style="display: inline-block; position: relative; width: 2.031em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.63em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-880" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.679em;"><span class="texatom" id="MathJax-Span-881"><span class="mrow" id="MathJax-Span-882"><span class="msup" id="MathJax-Span-883"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.34em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-884" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.389em;"><span class="mo" id="MathJax-Span-885" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-886" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-887"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-888" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-889" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(2.466em 1004.69em 5.171em -999.998em); top: -4.007em; left: 2.031em;"><span style="display: inline-block; position: relative; width: 4.688em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1003.87em 4.447em -999.998em); top: -4.732em; left: 0.002em;"><span class="mtd" id="MathJax-Span-864"><span class="mrow" id="MathJax-Span-865"><span class="mi" id="MathJax-Span-866"></span><span class="mo" id="MathJax-Span-867" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mi" id="MathJax-Span-868" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">log</span><span class="mo" id="MathJax-Span-869"></span><span class="msubsup" id="MathJax-Span-870" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.114em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.53em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-871" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.486em;"><span class="texatom" id="MathJax-Span-872"><span class="mrow" id="MathJax-Span-873"><span class="msup" id="MathJax-Span-874"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-875" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-876" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.191em 1004.69em 4.447em -999.998em); top: -3.283em; left: 0.002em;"><span class="mtd" id="MathJax-Span-890"><span class="mrow" id="MathJax-Span-891"><span class="mi" id="MathJax-Span-892"></span><span class="mo" id="MathJax-Span-893" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mi" id="MathJax-Span-894" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">log</span><span class="mo" id="MathJax-Span-895"></span><span class="msubsup" id="MathJax-Span-896" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.935em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.53em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-897" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.534em;"><span class="texatom" id="MathJax-Span-898"><span class="mrow" id="MathJax-Span-899"><span class="msup" id="MathJax-Span-900"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.34em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-901" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.389em;"><span class="mo" id="MathJax-Span-902" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-903" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-904"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-905" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-906" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.219em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 3.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>y</mi><mo>′</mo></msup></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mi>log</mi><mo>⁡</mo><msub><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>y</mi><mo>′</mo></msup></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>x</mi><mo>′</mo></msup><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mi>log</mi><mo>⁡</mo><msub><mi>α</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>x</mi><mo>′</mo></msup><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup></mrow></msub></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-50">\begin{split}  w_{y'} & = \log \beta_{y'}\\  w_{x',y'} & = \log \alpha_{x',y'} \end{split}</script></p><p>it is easy to show that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MathJax_ref&quot; href=&quot;#mjx-eqn-eq-loglinear&quot;&gt;&lt;mtext&gt;5&lt;/mtext&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-907" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1000.49em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-908"><a href="../01_tasks/0x_textclassify.html#mjx-eqn-eq-loglinear"><span class="mrow MathJax_ref" id="MathJax-Span-909"><span class="mtext" id="MathJax-Span-910" style="font-family: STIXGeneral-Regular;">5</span></span></a></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MathJax_ref" href="#mjx-eqn-eq-loglinear"><mtext>5</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-51">\ref{eq-loglinear}</script> is equivalent to the original NB formulation in equation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MathJax_ref&quot; href=&quot;#mjx-eqn-eqNB&quot;&gt;&lt;mtext&gt;3&lt;/mtext&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-911" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1000.49em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-912"><a href="../01_tasks/0x_textclassify.html#mjx-eqn-eqNB"><span class="mrow MathJax_ref" id="MathJax-Span-913"><span class="mtext" id="MathJax-Span-914" style="font-family: STIXGeneral-Regular;">3</span></span></a></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MathJax_ref" href="#mjx-eqn-eqNB"><mtext>3</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-52">\ref{eq:NB}</script>. </p></div></div><div id="cell3" class="cellWrapper"><div id="editCell3" class="cell" hidden="true" style="display: none;"><div class="input"><div id="editor3" class="cell editor ace_editor ace-chaos ace_dark"><div style="position: absolute;"></div><textarea class="ace_text-input" wrap="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><a id="runCode3" role="button" class="runButton btn disabled" disabled="disabled" "=""><i class="fa fa-play-circle-o fa-2x"></i></a></div></div><div id="renderDisplay3" class="cell"><h4>Feature Templates</h4><p>Note that in the above case we have <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-915" role="math" style="width: 1.403em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.176em 1001.16em 3.287em -999.998em); top: -2.993em; left: 0.002em;"><span class="mrow" id="MathJax-Span-916"><span class="texatom" id="MathJax-Span-917"><span class="mrow" id="MathJax-Span-918"><span class="mo" id="MathJax-Span-919" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-920"><span class="mrow" id="MathJax-Span-921"><span class="mi" id="MathJax-Span-922" style="font-family: STIXNonUnicode-Italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="texatom" id="MathJax-Span-923"><span class="mrow" id="MathJax-Span-924"><span class="mo" id="MathJax-Span-925" style="font-family: STIXGeneral-Regular;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.998em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.058em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">Y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-53">|\Ys|</script> label features, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-926" role="math" style="width: 3.964em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.432em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.176em 1003.38em 3.287em -999.998em); top: -2.993em; left: 0.002em;"><span class="mrow" id="MathJax-Span-927"><span class="texatom" id="MathJax-Span-928"><span class="mrow" id="MathJax-Span-929"><span class="mo" id="MathJax-Span-930" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-931" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.099em;"></span></span><span class="texatom" id="MathJax-Span-932"><span class="mrow" id="MathJax-Span-933"><span class="mo" id="MathJax-Span-934" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mo" id="MathJax-Span-935" style="font-family: STIXGeneral-Regular; padding-left: 0.244em;">×</span><span class="texatom" id="MathJax-Span-936" style="padding-left: 0.244em;"><span class="mrow" id="MathJax-Span-937"><span class="mo" id="MathJax-Span-938" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-939"><span class="mrow" id="MathJax-Span-940"><span class="mi" id="MathJax-Span-941" style="font-family: STIXNonUnicode-Italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="texatom" id="MathJax-Span-942"><span class="mrow" id="MathJax-Span-943"><span class="mo" id="MathJax-Span-944" style="font-family: STIXGeneral-Regular;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.998em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.058em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>×</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">Y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-54">|V| \times |\Ys|</script> word-label features. The corresponding two types of features are often called <em>feature templates</em> that generate sets of actual feature functions. That is, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-945" role="math" style="width: 1.065em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.355em 1000.92em 2.611em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-946"><span class="msubsup" id="MathJax-Span-947"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-948" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.147em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.292em;"><span class="texatom" id="MathJax-Span-949"><span class="mrow" id="MathJax-Span-950"><span class="msup" id="MathJax-Span-951"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-952" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-953" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>y</mi><mo>′</mo></msup></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-55">f_{y'}</script> is a feature template with one template <em>argument</em>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-954" role="math" style="width: 0.969em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.258em 1000.82em 2.514em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-955"><span class="msup" id="MathJax-Span-956"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-957" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.394em; left: 0.437em;"><span class="mo" id="MathJax-Span-958" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-56">y'</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-959" role="math" style="width: 1.79em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.355em 1001.55em 2.611em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-960"><span class="msubsup" id="MathJax-Span-961"><span style="display: inline-block; position: relative; width: 1.5em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-962" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.147em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.292em;"><span class="texatom" id="MathJax-Span-963"><span class="mrow" id="MathJax-Span-964"><span class="msup" id="MathJax-Span-965"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.34em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-966" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.389em;"><span class="mo" id="MathJax-Span-967" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="msup" id="MathJax-Span-968"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-969" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-970" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>x</mi><mo>′</mo></msup><msup><mi>y</mi><mo>′</mo></msup></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-57">f_{x'y'}</script> is a template with two arguments. It is common to augment the feature templates with a <em>template name</em> to distinguish templates that have the same argument space but different semantics. For example, we may have a template that combines the label of a document with number of times word <em>stems</em> have been seen. For words <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-971" role="math" style="width: 1.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.872em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.258em 1000.87em 2.321em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-972"><span class="msup" id="MathJax-Span-973"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-974" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.394em; left: 0.486em;"><span class="mo" id="MathJax-Span-975" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-58">x'</script> that are their own stem this would create duplicate indices, and hence we use <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;word&lt;/mtext&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-976" role="math" style="width: 3.867em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.355em 1003.34em 2.611em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-977"><span class="msubsup" id="MathJax-Span-978"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-979" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.147em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.292em;"><span class="texatom" id="MathJax-Span-980"><span class="mrow" id="MathJax-Span-981"><span class="mtext" id="MathJax-Span-982" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">word</span><span class="mo" id="MathJax-Span-983" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-984"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.34em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-985" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.389em;"><span class="mo" id="MathJax-Span-986" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-987" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-988"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-989" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-990" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mtext>word</mtext><mo>,</mo><msup><mi>x</mi><mo>′</mo></msup><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-59">f_{\text{word},x',y'}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;stem&lt;/mtext&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-991" role="math" style="width: 3.722em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.239em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.355em 1003.24em 2.611em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-992"><span class="msubsup" id="MathJax-Span-993"><span style="display: inline-block; position: relative; width: 3.191em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-994" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.147em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.292em;"><span class="texatom" id="MathJax-Span-995"><span class="mrow" id="MathJax-Span-996"><span class="mtext" id="MathJax-Span-997" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">stem</span><span class="mo" id="MathJax-Span-998" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-999"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.34em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1000" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.389em;"><span class="mo" id="MathJax-Span-1001" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1002" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-1003"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1004" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-1005" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mtext>stem</mtext><mo>,</mo><msup><mi>x</mi><mo>′</mo></msup><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-60">f_{\text{stem},x',y'}</script> to distinguish both types of features.</p><h4>Conditional Model</h4><p>The conditional probability <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1006" role="math" style="width: 3.915em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.548em 1003.34em 2.998em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1007"><span class="msubsup" id="MathJax-Span-1008"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1009" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="mtext" id="MathJax-Span-1010" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="mi" id="MathJax-Span-1011" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1012" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1013" style="font-family: STIXGeneral-Italic;">y</span><span class="texatom" id="MathJax-Span-1014"><span class="mrow" id="MathJax-Span-1015"><span class="mo" id="MathJax-Span-1016" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-1017"><span class="mrow" id="MathJax-Span-1018"><span class="mi" id="MathJax-Span-1019" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1020" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.447em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mi mathvariant="bold-italic">θ</mi><mtext>NB</mtext></msubsup><mo stretchy="false">(</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-61">p_\params^\text{NB}(y|\x)</script> can be written as </p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1021" role="math" style="width: 27.587em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.964em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(0.534em 1023.67em 3.336em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1022"><span class="mtable" id="MathJax-Span-1023" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 23.626em; height: 0px;"><span style="position: absolute; clip: rect(2.37em 1023.48em 5.171em -999.998em); top: -4.007em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 23.626em; height: 0px;"><span style="position: absolute; clip: rect(2.514em 1023.48em 5.316em -999.998em); top: -4.152em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1024"><span class="mrow" id="MathJax-Span-1025"><span class="msubsup" id="MathJax-Span-1026"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1027" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1028"><span class="mrow" id="MathJax-Span-1029"><span class="mtext" id="MathJax-Span-1030" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1031"><span class="mrow" id="MathJax-Span-1032"><span class="mi" id="MathJax-Span-1033" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1034" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1035" style="font-family: STIXGeneral-Italic;">y</span><span class="texatom" id="MathJax-Span-1036"><span class="mrow" id="MathJax-Span-1037"><span class="mo" id="MathJax-Span-1038" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-1039"><span class="mrow" id="MathJax-Span-1040"><span class="mi" id="MathJax-Span-1041" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1042" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1043" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mfrac" id="MathJax-Span-1044" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 9.471em; height: 0px; margin-right: 0.099em; margin-left: 0.099em;"><span style="position: absolute; clip: rect(3.191em 1007.25em 4.35em -999.998em); top: -4.684em; left: 50%; margin-left: -3.669em;"><span class="mrow" id="MathJax-Span-1045"><span class="mi" id="MathJax-Span-1046" style="font-family: STIXGeneral-Regular;">exp</span><span class="mo" id="MathJax-Span-1047" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">&lt;</span><span class="texatom" id="MathJax-Span-1048" style="padding-left: 0.292em;"><span class="mrow" id="MathJax-Span-1049"><span class="mi" id="MathJax-Span-1050" style="font-family: STIXGeneral; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="mo" id="MathJax-Span-1051" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1052"><span class="mrow" id="MathJax-Span-1053"><span class="mi" id="MathJax-Span-1054" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1055" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1056" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-1057" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1058" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-1059" style="padding-left: 0.196em;"><span class="mrow" id="MathJax-Span-1060"><span class="mi" id="MathJax-Span-1061" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-1062" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.094em 1009.28em 4.592em -999.998em); top: -3.283em; left: 50%; margin-left: -4.684em;"><span class="mrow" id="MathJax-Span-1063"><span class="munderover" id="MathJax-Span-1064"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.094em 1000.87em 4.399em -999.998em); top: -4.007em; left: 0.002em;"><span class="mo" id="MathJax-Span-1065" style="font-family: STIXGeneral-Regular; vertical-align: 0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.717em; left: 0.92em;"><span class="texatom" id="MathJax-Span-1066"><span class="mrow" id="MathJax-Span-1067"><span class="msup" id="MathJax-Span-1068"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1069" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-1070" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mi" id="MathJax-Span-1071" style="font-family: STIXGeneral-Regular; padding-left: 0.196em;">exp</span><span class="mo" id="MathJax-Span-1072" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">&lt;</span><span class="texatom" id="MathJax-Span-1073" style="padding-left: 0.292em;"><span class="mrow" id="MathJax-Span-1074"><span class="mi" id="MathJax-Span-1075" style="font-family: STIXGeneral; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="mo" id="MathJax-Span-1076" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1077"><span class="mrow" id="MathJax-Span-1078"><span class="mi" id="MathJax-Span-1079" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1080" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-1081" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1082" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.297em; left: 0.437em;"><span class="mo" id="MathJax-Span-1083" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1084" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1085" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-1086" style="padding-left: 0.196em;"><span class="mrow" id="MathJax-Span-1087"><span class="mi" id="MathJax-Span-1088" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-1089" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(0.872em 1009.47em 1.21em -999.998em); top: -1.302em; left: 0.002em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.002em; border-top-width: 1.3px; border-top-style: solid; width: 9.471em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.065em;"></span></span></span></span><span class="mo" id="MathJax-Span-1090" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="mi" id="MathJax-Span-1091" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">exp</span><span class="mo" id="MathJax-Span-1092"></span><span class="mrow" id="MathJax-Span-1093"><span class="mo" id="MathJax-Span-1094" style="vertical-align: -0.191em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-1095"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.39em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1096" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.389em;"><span class="mi" id="MathJax-Span-1097" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1098" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1099"><span class="mrow" id="MathJax-Span-1100"><span class="mi" id="MathJax-Span-1101" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1102" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1103" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-1104" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1105" style="font-family: STIXGeneral-Regular; padding-left: 0.244em;">−</span><span class="msubsup" id="MathJax-Span-1106" style="padding-left: 0.244em;"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1107" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.63em;"><span class="texatom" id="MathJax-Span-1108"><span class="mrow" id="MathJax-Span-1109"><span class="mi" id="MathJax-Span-1110" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span class="mo" id="MathJax-Span-1111" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-1112"><span class="mrow" id="MathJax-Span-1113"><span class="mi" id="MathJax-Span-1114" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1115" style="vertical-align: -0.191em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.219em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 3.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msubsup><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>&lt;</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo>&gt;</mo></mrow><mrow><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>y</mi><mo>′</mo></msup></mrow></munder><mi>exp</mi><mo>&lt;</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo>&gt;</mo></mrow></mfrac><mo>=</mo><mi>exp</mi><mo>⁡</mo><mrow><mo>(</mo><msub><mi>s</mi><mi mathvariant="bold-italic">θ</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></mrow></msub><mo>)</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-62">\begin{split}  p^{\text{NB}}_{\params}(y |\x)= \frac{\exp < \mathbf{f}(\x,y), \mathbf{w}>}{\sum_{y'} \exp < \mathbf{f}(\x,y'), \mathbf{w}>} = \exp \left( s_\params(\x,y) - A_{\params,\x}\right) \end{split}</script></p><p>where </p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&amp;lt;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1116" role="math" style="width: 15.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.577em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(-0.094em 1013.38em 3.964em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1117"><span class="mtable" id="MathJax-Span-1118" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 13.239em; height: 0px;"><span style="position: absolute; clip: rect(1.886em 1002.85em 4.592em -999.998em); top: -4.007em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.853em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1002.85em 4.35em -999.998em); top: -5.312em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1119"><span class="mrow" id="MathJax-Span-1120"><span class="msubsup" id="MathJax-Span-1121"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.39em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1122" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.389em;"><span class="mi" id="MathJax-Span-1123" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1124" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1125"><span class="mrow" id="MathJax-Span-1126"><span class="mi" id="MathJax-Span-1127" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1128" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1129" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-1130" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.191em 1001.6em 4.399em -999.998em); top: -3.814em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1152"><span class="mrow" id="MathJax-Span-1153"><span class="msubsup" id="MathJax-Span-1154"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1155" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.63em;"><span class="texatom" id="MathJax-Span-1156"><span class="mrow" id="MathJax-Span-1157"><span class="mi" id="MathJax-Span-1158" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span class="mo" id="MathJax-Span-1159" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-1160"><span class="mrow" id="MathJax-Span-1161"><span class="mi" id="MathJax-Span-1162" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(2.514em 1010.29em 6.572em -999.998em); top: -4.78em; left: 2.853em;"><span style="display: inline-block; position: relative; width: 10.389em; height: 0px;"><span style="position: absolute; clip: rect(3.046em 1006.81em 4.35em -999.998em); top: -5.312em; left: 0.002em;"><span class="mtd" id="MathJax-Span-1131"><span class="mrow" id="MathJax-Span-1132"><span class="mi" id="MathJax-Span-1133"></span><span class="mo" id="MathJax-Span-1134" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">&lt;</span></span><span class="texatom" id="MathJax-Span-1135" style="padding-left: 0.292em;"><span class="mrow" id="MathJax-Span-1136"><span class="mi" id="MathJax-Span-1137" style="font-family: STIXGeneral; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="mo" id="MathJax-Span-1138" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1139"><span class="mrow" id="MathJax-Span-1140"><span class="mi" id="MathJax-Span-1141" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1142" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-1143" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1144" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.442em; left: 0.437em;"><span class="mo" id="MathJax-Span-1145" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1146" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1147" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-1148" style="padding-left: 0.196em;"><span class="mrow" id="MathJax-Span-1149"><span class="mi" id="MathJax-Span-1150" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-1151" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(2.901em 1010.29em 5.606em -999.998em); top: -3.814em; left: 0.002em;"><span class="mtd" id="MathJax-Span-1163"><span class="mrow" id="MathJax-Span-1164"><span class="mi" id="MathJax-Span-1165"></span><span class="mo" id="MathJax-Span-1166" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-1167" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 1.307em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1001.21em 4.64em -999.998em); top: -4.007em; left: 0.002em;"><span class="mo" id="MathJax-Span-1168" style="font-family: STIXSizeOneSym; vertical-align: -0.529em;">∑</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.53em 4.399em -999.998em); top: -2.8em; left: 0.389em;"><span class="texatom" id="MathJax-Span-1169"><span class="mrow" id="MathJax-Span-1170"><span class="msup" id="MathJax-Span-1171"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1172" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.249em; left: 0.292em;"><span class="mo" id="MathJax-Span-1173" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mi" id="MathJax-Span-1174" style="font-family: STIXGeneral-Regular; padding-left: 0.196em;">exp</span><span class="mo" id="MathJax-Span-1175" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">&lt;</span><span class="texatom" id="MathJax-Span-1176" style="padding-left: 0.292em;"><span class="mrow" id="MathJax-Span-1177"><span class="mi" id="MathJax-Span-1178" style="font-family: STIXGeneral; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="mo" id="MathJax-Span-1179" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1180"><span class="mrow" id="MathJax-Span-1181"><span class="mi" id="MathJax-Span-1182" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1183" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-1184" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1185" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.442em; left: 0.437em;"><span class="mo" id="MathJax-Span-1186" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1187" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1188" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-1189" style="padding-left: 0.196em;"><span class="mrow" id="MathJax-Span-1190"><span class="mi" id="MathJax-Span-1191" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-1192" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.785em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.942em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 4.447em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>s</mi><mi mathvariant="bold-italic">θ</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=&lt;</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo>&gt;</mo></mtd></mtr><mtr><mtd><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>y</mi><mo>′</mo></msup></mrow></munder><mi>exp</mi><mo>&lt;</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo>&gt;</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-63">\begin{split}  s_\params(\x,y) & = < \mathbf{f}(\x,y'), \mathbf{w}> \\  A_{\params,\x} & = \sum_{y'} \exp < \mathbf{f}(\x,y'), \mathbf{w}> \end{split}</script></p><p>and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1193" role="math" style="width: 1.886em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.645em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.355em 1001.64em 2.563em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1194"><span class="msubsup" id="MathJax-Span-1195"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1196" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.63em;"><span class="texatom" id="MathJax-Span-1197"><span class="mrow" id="MathJax-Span-1198"><span class="mi" id="MathJax-Span-1199" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span class="mo" id="MathJax-Span-1200" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-1201"><span class="mrow" id="MathJax-Span-1202"><span class="mi" id="MathJax-Span-1203" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-64">A_{\params,\x}</script> is the <em>log-partition function</em>. </p></div></div><div id="cell4" class="cellWrapper"><div id="editCell4" class="cell" hidden="true" style="display: none;"><div class="input"><div id="editor4" class="cell editor ace_editor ace-chaos ace_dark"><div style="position: absolute;"></div><textarea class="ace_text-input" wrap="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><a id="runCode4" role="button" class="runButton btn disabled" disabled="disabled" "=""><i class="fa fa-play-circle-o fa-2x"></i></a></div></div><div id="renderDisplay4" class="cell"><h4>Joint vs Input Features</h4><p>In contrast to the standard formulation of linear and log-linear models we define feature functions over input-output pairs instead of only inputs. That is, we could have also used a representation where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1204" role="math" style="width: 6.428em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.558em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1005.51em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1205"><span class="mo" id="MathJax-Span-1206" style="font-family: STIXGeneral-Regular;">&lt;</span><span class="texatom" id="MathJax-Span-1207" style="padding-left: 0.292em;"><span class="mrow" id="MathJax-Span-1208"><span class="mi" id="MathJax-Span-1209" style="font-family: STIXGeneral; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="mo" id="MathJax-Span-1210" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1211"><span class="mrow" id="MathJax-Span-1212"><span class="mi" id="MathJax-Span-1213" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1214" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1215" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-1216" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1217" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-1218" style="padding-left: 0.196em;"><span class="mrow" id="MathJax-Span-1219"><span class="mi" id="MathJax-Span-1220" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-1221" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&lt;</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo>&gt;</mo></math></span></span><script type="math/tex" id="MathJax-Element-65">< \mathbf{f}(\x,y), \mathbf{w}></script> is replaced by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1222" role="math" style="width: 5.848em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.075em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1005.03em 2.949em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1223"><span class="mo" id="MathJax-Span-1224" style="font-family: STIXGeneral-Regular;">&lt;</span><span class="texatom" id="MathJax-Span-1225" style="padding-left: 0.292em;"><span class="mrow" id="MathJax-Span-1226"><span class="mi" id="MathJax-Span-1227" style="font-family: STIXGeneral; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="mo" id="MathJax-Span-1228" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1229"><span class="mrow" id="MathJax-Span-1230"><span class="mi" id="MathJax-Span-1231" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1232" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1233" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1234" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.114em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.73em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1235"><span class="mrow" id="MathJax-Span-1236"><span class="mi" id="MathJax-Span-1237" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.727em;"><span class="mi" id="MathJax-Span-1238" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1239" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&lt;</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mi>y</mi></msub><mo>&gt;</mo></math></span></span><script type="math/tex" id="MathJax-Element-66">< \mathbf{f}(\x), \mathbf{w}_y></script> in which each class <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1240" role="math" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.486em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.935em 1000.49em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1241"><span class="mi" id="MathJax-Span-1242" style="font-family: STIXGeneral-Italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-67">y</script> receives an own weight vector. </p><p>The benefit of the joint feature function is two-fold. First it enables us to easily define features that break up the output label into sub-labels. That is, say you have the labels "sports_baseball" and "sports_football", then you can define one feature that tests whether a label starts with a certain prefix ("sports"). This allows the model to learn commonalities between both labels. Second, the one-weight vector per class approach breaks down when the output space is structured (and exponentially sized). You simply cannot maintain a different weight vector for each possible output structure <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1243" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1244"><span class="texatom" id="MathJax-Span-1245"><span class="mrow" id="MathJax-Span-1246"><span class="mi" id="MathJax-Span-1247" style="font-family: STIXGeneral; font-weight: bold;">y</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">y</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-68">\y</script>, both for computational and statistical reasons.</p></div></div><div id="cell5" class="cellWrapper"><div id="editCell5" class="cell" hidden="true" style="display: none;"><div class="input"><div id="editor5" class="cell editor ace_editor ace-chaos ace_dark"><div style="position: absolute;"></div><textarea class="ace_text-input" wrap="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><a id="runCode5" role="button" class="runButton btn disabled" disabled="disabled" "=""><i class="fa fa-play-circle-o fa-2x"></i></a></div></div><div id="renderDisplay5" class="cell"><h3>Conditional Loglikelihood</h3><p>Training the NB model using MLE is efficient and easy to implement. In many cases it also leads to good results. However, one can argue that the MLE objective is generally not the optimal choice when the task is to predict the best output given some input. Let us recall the MLE objective: </p>
<!--toDO: (link to Maxent vs NB paper?)--><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1248" role="math" style="width: 16.959em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.737em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(0.582em 1014.54em 3.239em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1249"><span class="mtable" id="MathJax-Span-1250" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 14.399em; height: 0px;"><span style="position: absolute; clip: rect(2.418em 1014.35em 5.075em -999.998em); top: -4.007em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 14.399em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1014.35em 5.558em -999.998em); top: -4.49em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1251"><span class="mrow" id="MathJax-Span-1252"><span class="mi" id="MathJax-Span-1253" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1254" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1255"><span style="display: inline-block; position: relative; width: 2.273em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.77em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1256"><span class="mrow" id="MathJax-Span-1257"><span class="mi" id="MathJax-Span-1258" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.824em;"><span class="texatom" id="MathJax-Span-1259"><span class="mrow" id="MathJax-Span-1260"><span class="mi" id="MathJax-Span-1261" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-1262" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-1263" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1264" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1265" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1266" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1267" style="font-family: STIXGeneral; font-style: italic; font-weight: bold; padding-left: 0.196em;">θ</span><span class="mo" id="MathJax-Span-1268" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1269" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-1270" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1001.21em 4.64em -999.998em); top: -4.007em; left: 1.065em;"><span class="mo" id="MathJax-Span-1271" style="font-family: STIXSizeOneSym; vertical-align: -0.529em;">∑</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1003.38em 4.399em -999.998em); top: -2.848em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1272"><span class="mrow" id="MathJax-Span-1273"><span class="mo" id="MathJax-Span-1274" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1275"><span class="mrow" id="MathJax-Span-1276"><span class="mi" id="MathJax-Span-1277" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1278" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1279" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-1280" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1281" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msubsup" id="MathJax-Span-1282"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1283"><span class="mrow" id="MathJax-Span-1284"><span class="mi" id="MathJax-Span-1285" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.911em; left: 0.582em;"><span class="texatom" id="MathJax-Span-1286"><span class="mrow" id="MathJax-Span-1287"><span class="mi" id="MathJax-Span-1288" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-1289" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-1290" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1291" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1292" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mi" id="MathJax-Span-1293" style="font-family: STIXGeneral-Regular; padding-left: 0.196em;">log</span><span class="mo" id="MathJax-Span-1294"></span><span class="msubsup" id="MathJax-Span-1295" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1296" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1297"><span class="mrow" id="MathJax-Span-1298"><span class="mtext" id="MathJax-Span-1299" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="mi" id="MathJax-Span-1300" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1301" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1302"><span class="mrow" id="MathJax-Span-1303"><span class="mi" id="MathJax-Span-1304" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1305" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1306" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-1307" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.108em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 2.836em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><mi>L</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub><mo>,</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∈</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></munder><mi>log</mi><mo>⁡</mo><msubsup><mi>p</mi><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-69">\begin{split}  L(\train, \params) = \sum_{(\x,y) \in \train} \log p^{\text{NB}}_\params(\x,y) \end{split}</script></p><p>Via Bayes Law we can reformulate this objective as follows: </p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1308" role="math" style="width: 22.853em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.857em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(0.582em 1019.66em 3.239em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1309"><span class="mtable" id="MathJax-Span-1310" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 19.519em; height: 0px;"><span style="position: absolute; clip: rect(2.418em 1019.47em 5.075em -999.998em); top: -4.007em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 19.519em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1019.47em 5.558em -999.998em); top: -4.49em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1311"><span class="mrow" id="MathJax-Span-1312"><span class="mi" id="MathJax-Span-1313" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1314" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1315"><span style="display: inline-block; position: relative; width: 2.273em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.77em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1316"><span class="mrow" id="MathJax-Span-1317"><span class="mi" id="MathJax-Span-1318" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.824em;"><span class="texatom" id="MathJax-Span-1319"><span class="mrow" id="MathJax-Span-1320"><span class="mi" id="MathJax-Span-1321" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-1322" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-1323" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1324" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1325" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1326" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1327" style="font-family: STIXGeneral; font-style: italic; font-weight: bold; padding-left: 0.196em;">θ</span><span class="mo" id="MathJax-Span-1328" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1329" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-1330" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1001.21em 4.64em -999.998em); top: -4.007em; left: 1.065em;"><span class="mo" id="MathJax-Span-1331" style="font-family: STIXSizeOneSym; vertical-align: -0.529em;">∑</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1003.38em 4.399em -999.998em); top: -2.848em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1332"><span class="mrow" id="MathJax-Span-1333"><span class="mo" id="MathJax-Span-1334" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1335"><span class="mrow" id="MathJax-Span-1336"><span class="mi" id="MathJax-Span-1337" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1338" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1339" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-1340" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1341" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msubsup" id="MathJax-Span-1342"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1343"><span class="mrow" id="MathJax-Span-1344"><span class="mi" id="MathJax-Span-1345" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.911em; left: 0.582em;"><span class="texatom" id="MathJax-Span-1346"><span class="mrow" id="MathJax-Span-1347"><span class="mi" id="MathJax-Span-1348" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-1349" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-1350" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1351" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1352" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mi" id="MathJax-Span-1353" style="font-family: STIXGeneral-Regular; padding-left: 0.196em;">log</span><span class="mo" id="MathJax-Span-1354"></span><span class="msubsup" id="MathJax-Span-1355" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1356" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1357"><span class="mrow" id="MathJax-Span-1358"><span class="mtext" id="MathJax-Span-1359" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="mi" id="MathJax-Span-1360" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1361" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1362" style="font-family: STIXGeneral-Italic;">y</span><span class="texatom" id="MathJax-Span-1363"><span class="mrow" id="MathJax-Span-1364"><span class="mo" id="MathJax-Span-1365" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-1366"><span class="mrow" id="MathJax-Span-1367"><span class="mi" id="MathJax-Span-1368" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1369" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1370" style="font-family: STIXGeneral-Regular; padding-left: 0.244em;">+</span><span class="mi" id="MathJax-Span-1371" style="font-family: STIXGeneral-Regular; padding-left: 0.244em;">log</span><span class="mo" id="MathJax-Span-1372"></span><span class="msubsup" id="MathJax-Span-1373" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1374" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1375"><span class="mrow" id="MathJax-Span-1376"><span class="mtext" id="MathJax-Span-1377" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="mi" id="MathJax-Span-1378" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1379" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1380"><span class="mrow" id="MathJax-Span-1381"><span class="mi" id="MathJax-Span-1382" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1383" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.108em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 2.836em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><mi>L</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub><mo>,</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∈</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></munder><mi>log</mi><mo>⁡</mo><msubsup><mi>p</mi><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><msubsup><mi>p</mi><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-70">\begin{split}  L(\train, \params) = \sum_{(\x,y) \in \train} \log p^{\text{NB}}_\params(y|\x) + \log p^{\text{NB}}_\params(\x) \end{split}</script></p><p>Notice that the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1384" role="math" style="width: 3.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.756em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.548em 1002.71em 2.998em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1385"><span class="msubsup" id="MathJax-Span-1386"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1387" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1388"><span class="mrow" id="MathJax-Span-1389"><span class="mtext" id="MathJax-Span-1390" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="mi" id="MathJax-Span-1391" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1392" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1393"><span class="mrow" id="MathJax-Span-1394"><span class="mi" id="MathJax-Span-1395" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1396" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.447em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-71">p^{\text{NB}}_\params(\x) </script> here is not the class prior as used in the <em>forward</em> definition of the NB model, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1397" role="math" style="width: 6.959em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.041em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.548em 1005.99em 2.998em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1398"><span class="msubsup" id="MathJax-Span-1399"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1400" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1401"><span class="mrow" id="MathJax-Span-1402"><span class="mtext" id="MathJax-Span-1403" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="mi" id="MathJax-Span-1404" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1405" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1406"><span class="mrow" id="MathJax-Span-1407"><span class="mi" id="MathJax-Span-1408" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="texatom" id="MathJax-Span-1409"><span class="mrow" id="MathJax-Span-1410"><span class="mo" id="MathJax-Span-1411" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-1412" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-1413" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-1414"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1415" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1416"><span class="mrow" id="MathJax-Span-1417"><span class="mtext" id="MathJax-Span-1418" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="mi" id="MathJax-Span-1419" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1420" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1421" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-1422" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.447em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo stretchy="false">)</mo><msubsup><mi>p</mi><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-72">p^{\text{NB}}_\params(\x|y) p^{\text{NB}}_\params(y)</script>. Instead it is the marginal probability <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/munder&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1423" role="math" style="width: 5.896em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.123em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.548em 1005.08em 3.094em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1424"><span class="munderover" id="MathJax-Span-1425"><span style="display: inline-block; position: relative; width: 1.307em; height: 0px;"><span style="position: absolute; clip: rect(3.094em 1000.87em 4.399em -999.998em); top: -4.007em; left: 0.002em;"><span class="mo" id="MathJax-Span-1426" style="font-family: STIXGeneral-Regular; vertical-align: 0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.717em; left: 0.92em;"><span class="mi" id="MathJax-Span-1427" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1428" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1429" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1430"><span class="mrow" id="MathJax-Span-1431"><span class="mtext" id="MathJax-Span-1432" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="mi" id="MathJax-Span-1433" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1434" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1435"><span class="mrow" id="MathJax-Span-1436"><span class="mi" id="MathJax-Span-1437" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1438" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1439" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-1440" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.553em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.558em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo>∑</mo><mi>y</mi></munder><msubsup><mi>p</mi><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-73">\sum_y p^{\text{NB}}_\params(\x,y)</script> of seeing a given input text <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1441" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1442"><span class="texatom" id="MathJax-Span-1443"><span class="mrow" id="MathJax-Span-1444"><span class="mi" id="MathJax-Span-1445" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-74">\x</script>. </p><p>This view on the MLE objective shows that for every training instance MLE means both maximizing the conditional probability of seeing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1446" role="math" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.486em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.935em 1000.49em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1447"><span class="mi" id="MathJax-Span-1448" style="font-family: STIXGeneral-Italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-75">y</script> given <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1449" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1450"><span class="texatom" id="MathJax-Span-1451"><span class="mrow" id="MathJax-Span-1452"><span class="mi" id="MathJax-Span-1453" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-76">\x</script>, and maximizing the marginal probability of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1454" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1455"><span class="texatom" id="MathJax-Span-1456"><span class="mrow" id="MathJax-Span-1457"><span class="mi" id="MathJax-Span-1458" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-77">\x</script>. Now consider the way we use the NB model to make a prediction for a given <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1459" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1460"><span class="texatom" id="MathJax-Span-1461"><span class="mrow" id="MathJax-Span-1462"><span class="mi" id="MathJax-Span-1463" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-78">\x</script>: we search for the label <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1464" role="math" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.486em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.935em 1000.49em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1465"><span class="mi" id="MathJax-Span-1466" style="font-family: STIXGeneral-Italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-79">y</script> with maximum conditional probability <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1467" role="math" style="width: 3.915em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.548em 1003.34em 2.998em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1468"><span class="msubsup" id="MathJax-Span-1469"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1470" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1471"><span class="mrow" id="MathJax-Span-1472"><span class="mtext" id="MathJax-Span-1473" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="mi" id="MathJax-Span-1474" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1475" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1476" style="font-family: STIXGeneral-Italic;">y</span><span class="texatom" id="MathJax-Span-1477"><span class="mrow" id="MathJax-Span-1478"><span class="mo" id="MathJax-Span-1479" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-1480"><span class="mrow" id="MathJax-Span-1481"><span class="mi" id="MathJax-Span-1482" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1483" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.447em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-80">p^{\text{NB}}_\params(y|\x)</script>. Since <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1484" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1485"><span class="texatom" id="MathJax-Span-1486"><span class="mrow" id="MathJax-Span-1487"><span class="mi" id="MathJax-Span-1488" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-81">\x</script> is fixed, the marginal probability <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1489" role="math" style="width: 3.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.756em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.548em 1002.71em 2.998em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1490"><span class="msubsup" id="MathJax-Span-1491"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1492" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1493"><span class="mrow" id="MathJax-Span-1494"><span class="mtext" id="MathJax-Span-1495" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="mi" id="MathJax-Span-1496" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1497" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1498"><span class="mrow" id="MathJax-Span-1499"><span class="mi" id="MathJax-Span-1500" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1501" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.447em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-82">p^{\text{NB}}_\params(\x)</script> has no impact on this decision. This means part of what what we optimize during training is completely irrelevant at test time. </p><p>The above problem may lead to errors: for a given training instance we may increase the marginal probability of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1502" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1503"><span class="texatom" id="MathJax-Span-1504"><span class="mrow" id="MathJax-Span-1505"><span class="mi" id="MathJax-Span-1506" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-83">\x</script> at the price of reducing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1507" role="math" style="width: 3.915em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.548em 1003.34em 2.998em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1508"><span class="msubsup" id="MathJax-Span-1509"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1510" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1511"><span class="mrow" id="MathJax-Span-1512"><span class="mtext" id="MathJax-Span-1513" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="mi" id="MathJax-Span-1514" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1515" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1516" style="font-family: STIXGeneral-Italic;">y</span><span class="texatom" id="MathJax-Span-1517"><span class="mrow" id="MathJax-Span-1518"><span class="mo" id="MathJax-Span-1519" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-1520"><span class="mrow" id="MathJax-Span-1521"><span class="mi" id="MathJax-Span-1522" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1523" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.447em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-84">p^{\text{NB}}_\params(y|\x)</script> if this means we can still increase their product. This may lead to the true <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1524" role="math" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.486em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.935em 1000.49em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1525"><span class="mi" id="MathJax-Span-1526" style="font-family: STIXGeneral-Italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">y</script> having smaller conditional probability than wrong ones. </p><p>One way to overcome this problem is to directly optimize the <em>conditional</em> log-likelihood (CL). This objective is defined as follows:</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;NB&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1527" role="math" style="width: 29.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.655em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(0.582em 1025.51em 3.239em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1528"><span class="mtable" id="MathJax-Span-1529" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 25.316em; height: 0px;"><span style="position: absolute; clip: rect(2.418em 1025.32em 5.075em -999.998em); top: -4.007em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 25.316em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1025.32em 5.558em -999.998em); top: -4.49em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1530"><span class="mrow" id="MathJax-Span-1531"><span class="mi" id="MathJax-Span-1532" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1533" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1534" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1535"><span style="display: inline-block; position: relative; width: 2.273em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.77em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1536"><span class="mrow" id="MathJax-Span-1537"><span class="mi" id="MathJax-Span-1538" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.824em;"><span class="texatom" id="MathJax-Span-1539"><span class="mrow" id="MathJax-Span-1540"><span class="mi" id="MathJax-Span-1541" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-1542" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-1543" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1544" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1545" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1546" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1547" style="font-family: STIXGeneral; font-style: italic; font-weight: bold; padding-left: 0.196em;">θ</span><span class="mo" id="MathJax-Span-1548" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1549" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-1550" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1001.21em 4.64em -999.998em); top: -4.007em; left: 1.065em;"><span class="mo" id="MathJax-Span-1551" style="font-family: STIXSizeOneSym; vertical-align: -0.529em;">∑</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1003.38em 4.399em -999.998em); top: -2.848em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1552"><span class="mrow" id="MathJax-Span-1553"><span class="mo" id="MathJax-Span-1554" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1555"><span class="mrow" id="MathJax-Span-1556"><span class="mi" id="MathJax-Span-1557" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1558" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1559" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-1560" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1561" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msubsup" id="MathJax-Span-1562"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1563"><span class="mrow" id="MathJax-Span-1564"><span class="mi" id="MathJax-Span-1565" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.911em; left: 0.582em;"><span class="texatom" id="MathJax-Span-1566"><span class="mrow" id="MathJax-Span-1567"><span class="mi" id="MathJax-Span-1568" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-1569" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-1570" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1571" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1572" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mi" id="MathJax-Span-1573" style="font-family: STIXGeneral-Regular; padding-left: 0.196em;">log</span><span class="mo" id="MathJax-Span-1574"></span><span class="msubsup" id="MathJax-Span-1575" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.49em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1576" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1001.07em 4.157em -999.998em); top: -4.345em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1577"><span class="mrow" id="MathJax-Span-1578"><span class="mtext" id="MathJax-Span-1579" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">NB</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.44em 4.157em -999.998em); top: -3.669em; left: 0.486em;"><span class="mi" id="MathJax-Span-1580" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1581" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1582" style="font-family: STIXGeneral-Italic;">y</span><span class="texatom" id="MathJax-Span-1583"><span class="mrow" id="MathJax-Span-1584"><span class="mo" id="MathJax-Span-1585" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-1586"><span class="mrow" id="MathJax-Span-1587"><span class="mi" id="MathJax-Span-1588" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1589" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1590" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-1591" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1001.21em 4.64em -999.998em); top: -4.007em; left: 1.065em;"><span class="mo" id="MathJax-Span-1592" style="font-family: STIXSizeOneSym; vertical-align: -0.529em;">∑</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1003.38em 4.399em -999.998em); top: -2.848em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1593"><span class="mrow" id="MathJax-Span-1594"><span class="mo" id="MathJax-Span-1595" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1596"><span class="mrow" id="MathJax-Span-1597"><span class="mi" id="MathJax-Span-1598" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1599" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1600" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-1601" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1602" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msubsup" id="MathJax-Span-1603"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1604"><span class="mrow" id="MathJax-Span-1605"><span class="mi" id="MathJax-Span-1606" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.911em; left: 0.582em;"><span class="texatom" id="MathJax-Span-1607"><span class="mrow" id="MathJax-Span-1608"><span class="mi" id="MathJax-Span-1609" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-1610" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-1611" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1612" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1613" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1614" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.39em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1615" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.389em;"><span class="mi" id="MathJax-Span-1616" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1617" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1618"><span class="mrow" id="MathJax-Span-1619"><span class="mi" id="MathJax-Span-1620" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1621" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1622" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-1623" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1624" style="font-family: STIXGeneral-Regular; padding-left: 0.244em;">−</span><span class="msubsup" id="MathJax-Span-1625" style="padding-left: 0.244em;"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1626" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.63em;"><span class="texatom" id="MathJax-Span-1627"><span class="mrow" id="MathJax-Span-1628"><span class="mi" id="MathJax-Span-1629" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span class="mo" id="MathJax-Span-1630" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-1631"><span class="mrow" id="MathJax-Span-1632"><span class="mi" id="MathJax-Span-1633" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.108em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 2.836em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><mi>C</mi><mi>L</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub><mo>,</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∈</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></munder><mi>log</mi><mo>⁡</mo><msubsup><mi>p</mi><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mtext>NB</mtext></mrow></msubsup><mo stretchy="false">(</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∈</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></munder><msub><mi>s</mi><mi mathvariant="bold-italic">θ</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></mrow></msub></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-86">\begin{split}  CL(\train, \params) = \sum_{(\x,y) \in \train} \log p^{\text{NB}}_\params(y|\x) = \sum_{(\x,y) \in \train} s_\params(\x,y) - A_{\params,\x} \end{split}</script></p><p>This objective directly aims to maximize the condional class probability given the inputs, ignoring the marginal probability of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1634" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.886em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1635"><span class="texatom" id="MathJax-Span-1636"><span class="mrow" id="MathJax-Span-1637"><span class="mi" id="MathJax-Span-1638" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-87">\x</script>.</p></div></div><div id="cell6" class="cellWrapper"><div id="editCell6" class="cell" hidden="true" style="display: none;"><div class="input"><div id="editor6" class="cell editor ace_editor ace-chaos ace_dark"><div style="position: absolute;"></div><textarea class="ace_text-input" wrap="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><a id="runCode6" role="button" class="runButton btn disabled" disabled="disabled" "=""><i class="fa fa-play-circle-o fa-2x"></i></a></div></div><div id="renderDisplay6" class="cell"><h4>Optimizing Conditional Loglikelihood</h4><p>Due to the normalization factor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1639" role="math" style="width: 1.886em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.645em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.355em 1001.64em 2.563em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1640"><span class="msubsup" id="MathJax-Span-1641"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1642" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.63em;"><span class="texatom" id="MathJax-Span-1643"><span class="mrow" id="MathJax-Span-1644"><span class="mi" id="MathJax-Span-1645" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span class="mo" id="MathJax-Span-1646" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-1647"><span class="mrow" id="MathJax-Span-1648"><span class="mi" id="MathJax-Span-1649" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-88">A_{\params,\x}</script> there is no closed-form solution to the CL problem, and compared to the MLE solution we cannot just count. Instead we need to iteratively optimize the objective. One popular method to optimize the CL objective is via gradient ascent, or its stochastic version, stochastic gradient ascent Often one uses the term gradient <em>descent</em> even when ascent is meant, and we then speak of stochastic gradient descent (SGD). </p><p>The underlying idea of such gradient-based methods is to iteratively move along the gradient of the function until this gradient disappears. That is, for a function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1650" role="math" style="width: 1.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1001.55em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1651"><span class="mi" id="MathJax-Span-1652" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.147em;"></span></span><span class="mo" id="MathJax-Span-1653" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1654" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span class="mo" id="MathJax-Span-1655" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-89">f(\params)</script> to be optimized, in each step <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1656" role="math" style="width: 0.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.292em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1000.29em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1657"><span class="mi" id="MathJax-Span-1658" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-90">i</script> a gradient ascent algorithm performs the following update to the parameter vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1659" role="math" style="width: 0.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1000.53em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1660"><span class="mi" id="MathJax-Span-1661" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">\params</script>:</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1662" role="math" style="width: 11.114em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.664em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.258em 1009.47em 2.563em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1663"><span class="mtable" id="MathJax-Span-1664" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 9.326em; height: 0px;"><span style="position: absolute; clip: rect(3.239em 1009.28em 4.399em -999.998em); top: -4.007em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 9.326em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1009.28em 4.35em -999.998em); top: -3.959em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1665"><span class="mrow" id="MathJax-Span-1666"><span class="msubsup" id="MathJax-Span-1667"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.49em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1668" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.486em;"><span class="mi" id="MathJax-Span-1669" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1670" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">←</span><span class="msubsup" id="MathJax-Span-1671" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.49em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1672" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1673"><span class="mrow" id="MathJax-Span-1674"><span class="mi" id="MathJax-Span-1675" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-1676" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1677" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1678" style="font-family: STIXGeneral-Regular; padding-left: 0.244em;">+</span><span class="msubsup" id="MathJax-Span-1679" style="padding-left: 0.244em;"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.53em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1680" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.534em;"><span class="mi" id="MathJax-Span-1681" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mi" id="MathJax-Span-1682" style="font-family: STIXGeneral-Regular;">∇</span><span class="mi" id="MathJax-Span-1683" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.147em;"></span></span><span class="mo" id="MathJax-Span-1684" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1685"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.49em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1686" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.486em;"><span class="texatom" id="MathJax-Span-1687"><span class="mrow" id="MathJax-Span-1688"><span class="mi" id="MathJax-Span-1689" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-1690" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1691" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1692" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi mathvariant="bold-italic">θ</mi><mi>i</mi></msub><mo stretchy="false">←</mo><msub><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>α</mi><mi>i</mi></msub><mi mathvariant="normal">∇</mi><mi>f</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-92">\begin{split}  \params_i \leftarrow \params_{i-1} + \alpha_i \nabla f(\params_{i-1}) \end{split}</script></p><p>There are various ways of choosing the <em>learning rate</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1693" role="math" style="width: 0.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.935em 1000.58em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1694"><span class="mi" id="MathJax-Span-1695" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.614em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math></span></span><script type="math/tex" id="MathJax-Element-93">\alpha</script> dynamically depending on the iteration <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1696" role="math" style="width: 0.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.292em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1000.29em 2.659em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1697"><span class="mi" id="MathJax-Span-1698" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-94">i</script>, but for simplicity we will set it to 1 in the following.</p><p>To apply gradient ascent methods to optimizing the conditional loglikelihood we need to find its gradient with respect to the parameters. This gradient has a very intuitive form:</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1699" role="math" style="width: 20.969em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.215em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(0.582em 1017.97em 3.239em -999.998em); top: -2.171em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1700"><span class="mtable" id="MathJax-Span-1701" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 17.877em; height: 0px;"><span style="position: absolute; clip: rect(2.418em 1017.83em 5.075em -999.998em); top: -4.007em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 17.877em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1017.83em 5.558em -999.998em); top: -4.49em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1702"><span class="mrow" id="MathJax-Span-1703"><span class="mi" id="MathJax-Span-1704" style="font-family: STIXGeneral-Regular;">∇</span><span class="mi" id="MathJax-Span-1705" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1706" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1707" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1708" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span class="mo" id="MathJax-Span-1709" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1710" style="font-family: STIXGeneral-Regular; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-1711" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px;"><span style="position: absolute; clip: rect(2.901em 1001.21em 4.64em -999.998em); top: -4.007em; left: 1.065em;"><span class="mo" id="MathJax-Span-1712" style="font-family: STIXSizeOneSym; vertical-align: -0.529em;">∑</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; clip: rect(3.384em 1003.38em 4.399em -999.998em); top: -2.848em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1713"><span class="mrow" id="MathJax-Span-1714"><span class="mo" id="MathJax-Span-1715" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1716"><span class="mrow" id="MathJax-Span-1717"><span class="mi" id="MathJax-Span-1718" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1719" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1720" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-1721" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1722" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msubsup" id="MathJax-Span-1723"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.58em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="texatom" id="MathJax-Span-1724"><span class="mrow" id="MathJax-Span-1725"><span class="mi" id="MathJax-Span-1726" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.911em; left: 0.582em;"><span class="texatom" id="MathJax-Span-1727"><span class="mrow" id="MathJax-Span-1728"><span class="mi" id="MathJax-Span-1729" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-1730" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-1731" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1732" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1733" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1734" style="padding-left: 0.196em;"><span class="mrow" id="MathJax-Span-1735"><span class="mi" id="MathJax-Span-1736" style="font-family: STIXGeneral; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="mo" id="MathJax-Span-1737" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1738"><span class="mrow" id="MathJax-Span-1739"><span class="mi" id="MathJax-Span-1740" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1741" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1742" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-1743" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1744" style="font-family: STIXGeneral-Regular; padding-left: 0.244em;">−</span><span class="msubsup" id="MathJax-Span-1745" style="padding-left: 0.244em;"><span style="display: inline-block; position: relative; width: 2.853em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.63em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1746" style="font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.63em;"><span class="texatom" id="MathJax-Span-1747"><span class="mrow" id="MathJax-Span-1748"><span class="msubsup" id="MathJax-Span-1749"><span style="display: inline-block; position: relative; width: 0.679em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.34em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1750" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.814em; left: 0.341em;"><span class="mi" id="MathJax-Span-1751" style="font-size: 50%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1752" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-1753"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1754" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-1755" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1756"><span class="mrow" id="MathJax-Span-1757"><span class="mo" id="MathJax-Span-1758" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-1759"><span class="mrow" id="MathJax-Span-1760"><span class="mi" id="MathJax-Span-1761" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1762" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1763" style="font-family: STIXGeneral-Regular;">[</span><span class="texatom" id="MathJax-Span-1764"><span class="mrow" id="MathJax-Span-1765"><span class="mi" id="MathJax-Span-1766" style="font-family: STIXGeneral; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="mo" id="MathJax-Span-1767" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1768"><span class="mrow" id="MathJax-Span-1769"><span class="mi" id="MathJax-Span-1770" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1771" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-1772" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1773" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.442em; left: 0.437em;"><span class="mo" id="MathJax-Span-1774" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1775" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1776" style="font-family: STIXGeneral-Regular;">]</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.176em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.108em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 2.836em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><mi mathvariant="normal">∇</mi><mi>C</mi><mi>L</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∈</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></munder><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>p</mi><mi mathvariant="bold-italic">θ</mi></msub><mo stretchy="false">(</mo><msup><mi>y</mi><mo>′</mo></msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-95">\begin{split}  \nabla CL(\params) = \sum_{(\x,y) \in \train} \mathbf{f}(\x,y) - E_{p_\params(y'|\x)}[ \mathbf{f}(\x,y')] \end{split}</script></p><p>That is, for each training instance this gradient moves towards the feature representation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1777" role="math" style="width: 2.853em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.466em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.693em 1002.42em 2.853em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1778"><span class="texatom" id="MathJax-Span-1779"><span class="mrow" id="MathJax-Span-1780"><span class="mi" id="MathJax-Span-1781" style="font-family: STIXGeneral; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="mo" id="MathJax-Span-1782" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1783"><span class="mrow" id="MathJax-Span-1784"><span class="mi" id="MathJax-Span-1785" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1786" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1787" style="font-family: STIXGeneral-Italic; padding-left: 0.196em;">y</span><span class="mo" id="MathJax-Span-1788" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-96">\mathbf{f}(\x,y)</script> of the gold solution, and away from the expectation of the feature representation under the current model <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1789" role="math" style="width: 7.297em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.331em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.597em 1006.23em 2.998em -999.998em); top: -2.51em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1790"><span class="msubsup" id="MathJax-Span-1791"><span style="display: inline-block; position: relative; width: 2.853em; height: 0px;"><span style="position: absolute; clip: rect(3.191em 1000.63em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1792" style="font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.862em; left: 0.63em;"><span class="texatom" id="MathJax-Span-1793"><span class="mrow" id="MathJax-Span-1794"><span class="msubsup" id="MathJax-Span-1795"><span style="display: inline-block; position: relative; width: 0.679em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.34em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1796" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -3.814em; left: 0.341em;"><span class="mi" id="MathJax-Span-1797" style="font-size: 50%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1798" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-1799"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.577em 1000.29em 4.302em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1800" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.292em;"><span class="mo" id="MathJax-Span-1801" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1802"><span class="mrow" id="MathJax-Span-1803"><span class="mo" id="MathJax-Span-1804" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-1805"><span class="mrow" id="MathJax-Span-1806"><span class="mi" id="MathJax-Span-1807" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1808" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1809" style="font-family: STIXGeneral-Regular;">[</span><span class="texatom" id="MathJax-Span-1810"><span class="mrow" id="MathJax-Span-1811"><span class="mi" id="MathJax-Span-1812" style="font-family: STIXGeneral; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span class="mo" id="MathJax-Span-1813" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1814"><span class="mrow" id="MathJax-Span-1815"><span class="mi" id="MathJax-Span-1816" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1817" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-1818" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(3.432em 1000.44em 4.35em -999.998em); top: -4.007em; left: 0.002em;"><span class="mi" id="MathJax-Span-1819" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span><span style="position: absolute; top: -4.394em; left: 0.437em;"><span class="mo" id="MathJax-Span-1820" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span></span><span class="mo" id="MathJax-Span-1821" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1822" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.442em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.392em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>p</mi><mi mathvariant="bold-italic">θ</mi></msub><mo stretchy="false">(</mo><msup><mi>y</mi><mo>′</mo></msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-97">E_{p_\params(y'|\x)}[ \mathbf{f}(\x,y')]</script>. </p><p>In particular, this gradient is zero (and hence at an optimal solution) when the empirical expectation of the feature function under the training set is identical to the (conditional) model expectation. This gives rise to a dual view of the conditional likelihood objective: we can see solutions to this problem as parameters that force the empirical and model moments to match. In fact, one can arrive at the log-linear formulation and the CL objective also by searching for any distribution that matches the given feature moments and has maximal entropy. Particularly in the context of text classification the CL based approach is therefore often referred to as <em>Maximum Entropy</em> approach. On many text classification datasets it can be shown to outperform the MLE approach substantially. </p><p>Note that the CL objective is strictly concave. This means that when the gradient becomes zero we have found the single optimum to this function. <!--#### --></p>
<!--#### Stochastic Gradient Descent-->
<!--There are various gradient-based algorithms to find this optimum, as well as higher order methods that use the functions Hessian or approximations thereof. However, in this book we will focus on the most simple approach and generally use gradient ascent with fixed step size.--></div></div><div id="cell7" class="cellWrapper"><div id="editCell7" class="cell" hidden="true" style="display: none;"><div class="input"><div id="editor7" class="cell editor ace_editor ace-chaos ace_dark"><div style="position: absolute;"></div><textarea class="ace_text-input" wrap="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><a id="runCode7" role="button" class="runButton btn disabled" disabled="disabled" "=""><i class="fa fa-play-circle-o fa-2x"></i></a></div></div><div id="renderDisplay7" class="cell"></div></div></div>
                

<script>
    var divCells = $('#static_content');
    /* COMPILERS OBJECT */
    var compilers = {};
    
        compilers.scala = {};
        compilers.scala.hideAfterCompile = false;
        compilers.scala.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/scala");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = '';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.scala.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.scala.aggregate = true;
    
        compilers.markdown = {};
        compilers.markdown.hideAfterCompile = true;
        compilers.markdown.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/markdown");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = '';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.markdown.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.markdown.aggregate = false;
    
        compilers.section = {};
        compilers.section.hideAfterCompile = true;
        compilers.section.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'Section Name';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.section.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.section.aggregate = false;
    
        compilers.latex = {};
        compilers.latex.hideAfterCompile = true;
        compilers.latex.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/latex");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = '';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.latex.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.latex.aggregate = false;
    
        compilers.heading1 = {};
        compilers.heading1.hideAfterCompile = true;
        compilers.heading1.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'Heading';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.heading1.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.heading1.aggregate = false;
    
        compilers.heading2 = {};
        compilers.heading2.hideAfterCompile = true;
        compilers.heading2.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'Heading';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.heading2.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.heading2.aggregate = false;
    
        compilers.heading3 = {};
        compilers.heading3.hideAfterCompile = true;
        compilers.heading3.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'Heading';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.heading3.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.heading3.aggregate = false;
    
        compilers.heading4 = {};
        compilers.heading4.hideAfterCompile = true;
        compilers.heading4.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'Heading';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.heading4.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.heading4.aggregate = false;
    
        compilers.heading5 = {};
        compilers.heading5.hideAfterCompile = true;
        compilers.heading5.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'Heading';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.heading5.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.heading5.aggregate = false;
    
        compilers.html = {};
        compilers.html.hideAfterCompile = true;
        compilers.html.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/html");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = '';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.html.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.html.aggregate = false;
    
        compilers.imageurl = {};
        compilers.imageurl.hideAfterCompile = true;
        compilers.imageurl.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'URL';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.imageurl.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.imageurl.aggregate = false;
    
        compilers.google_viewer = {};
        compilers.google_viewer.hideAfterCompile = true;
        compilers.google_viewer.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'URL';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.google_viewer.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.google_viewer.aggregate = false;
    

    /* DOCUMENT OBJECT */
    var doc = newDoc("Text Classification");
    doc.aceTheme = 'chaos';
    doc.allowExecution = false;

    /* add cells */
    
        var mode = 'markdown';
        if(mode == 'wolfe') mode = 'scala';
        var input = {"sessionId":null,"code":"In many applications we need to automatically classify some input text with respect to a set of classes or labels. For example,\n\n* for information retrieval it is useful to classify documents into a set of topics, such as \"sport\" or \"business\",\n* for sentiment analysis we classify tweets into being \"positive\" or \"negative\" and \n* for Spam Filters we need to distinguish between Ham and Spam.\n\n<!-- TODO: Load Web Corpus, 4 Universities, something were Maxent works -->\n\n### Text Classification as Structured Prediction\nWe can formalize text classification as the simplest instance of [structured prediction](/template/statnlpbook/02_methods/00_structuredprediction) where the input space \\\\(\\Xs\\\\) are sequences of words, and the output space \\\\(\\Ys\\\\) is a set of labels such as \\\\(\\Ys=\\\\{ \\text{sports},\\text{business}\\\\} \\\\). On a high level, our goal is to define a model a model \\\\(s_{\\params}(\\x,y)\\\\) that assigns high *scores* to the label \\\\(y\\\\) that fits the text \\\\(\\x\\\\), and lower scores otherwise. The model will be parametrized by \\\\(\\params\\\\), and these parameters we will learn from some training set \\\\(\\train\\\\) of \\\\((\\x,y)\\\\) pairs. When we need to classify a text \\\\(\\x\\\\) we have to solve the trivial (if the number of classes is low) maximization problem \\\\(\\argmax_y s_{\\params}(\\x,y)\\\\). \n\n<!-- TODO: Show a silly classifier example? --> \n\nIn the following we will present two typical approaches to text classifiers: Naive Bayes and discriminative linear classifiers. We will also see that both in fact can use the same model structure, and differ only in how model parameters are trained.\n\n","extraFields":{}};
        var id = 0;
        //createStaticCellHTML(id, divCells, doc, mode, input, compilers);
    
        var mode = 'markdown';
        if(mode == 'wolfe') mode = 'scala';
        var input = {"sessionId":null,"code":"### Naive Bayes\nOne of the most widely used approaches to text classification relies on the so-called Naive Bayes (NB) Model. In NB we use a distribution \\\\(p^{\\mbox{NB}}_{\\params}\\\\) for \\\\(s_\\params\\\\). In particular, we use the *a posteriori* probability of a label \\\\(y\\\\) given the input text \\\\(\\x\\\\) as a score for that label given the text.   \n\n\\begin{equation}\n  s_{\\params}(\\x,\\y)\\ = p^{\\text{NB}}_{\\params}(y|\\x)\n\\end{equation}\n\nBy Bayes Law we get\n\n\\begin{equation}\n    p^{\\text{NB}}_{\\params}(y|\\x) =\n  \\frac{p^{\\text{NB}}_{\\params}(\\x|y) p^\\text{NB}_{\\params}(y)}{p^{\\text{NB}}_{\\params}(x)}  \n\\end{equation}\n\nand when an input \\\\(\\x\\\\) is fixed we can focus on \n\n\\begin{equation}\\label{eq:NB}\n\\prob^{\\text{NB}}_{\\params}(\\x,y)= p^{\\text{NB}}_{\\params}(\\x|y) p^\\text{NB}_{\\params}(y)\n\\end{equation}\n\nbecause in this case  \\\\(p^{\\text{NB}}_{\\params}(x)\\\\) is a constant factor. In the above \\\\(p^{\\text{NB}}_{\\params}(\\x|y)\\\\) is the *likelihood*, and \\\\(p^\\text{NB}_{\\params}(y) \\\\) is the *prior*.\n\n<!--Let us assume that we have a number \\\\(K(\\x)\\\\) of feature functions \\\\(f_k(\\x)\\\\) that represent the input \\\\(\\x\\\\). For example, in document classification this set could be used to represent the text \\\\(\\x = (x_1,\\ldots,x_n)\\\\) as a bag of words by setting \\\\(f_k(\\x) = x_k\\\\) and \\\\(K(\\x) = n\\\\). We could also use bigrams instead, setting \\\\(f_k(\\x) = (x_k,x_{k+1})\\\\) and \\\\(K(\\x) = n-1\\\\), or any other representation that is effective for distinguishing between classes of text.-->\n\nThe \"naivity\" of NB stems from a certain conditional independence assumption we make for the likelihood \\\\(p^{\\mbox{NB}}_{\\params}(\\x|y)\\\\). Note that conditional independence of two events \\\\(a\\\\) and \\\\(b\\\\) given a third event \\\\(c\\\\) requires that \\\\(p(a,b|c) = p(a|c) p(b|c)\\\\). In particular, for the likelihood in NB we have:\n\n\\begin{equation}\n  p^{\\text{NB}}_{\\params}(\\x|y) = \n  \\prod_i^{\\text{length}(\\x)} p^{\\text{NB}}_{\\params}(x_i|y)\n\\end{equation}\n\nThat is, NB makes the assumption that the observed wors are independent of each other when *conditioned on the label* \\\\(y\\\\). \n\n<!--TODO: Evaluate NB assumption on actual data. Show that features aren't independent, but more independent when conditioned on the label.-->\n\n","extraFields":{}};
        var id = 1;
        //createStaticCellHTML(id, divCells, doc, mode, input, compilers);
    
        var mode = 'markdown';
        if(mode == 'wolfe') mode = 'scala';
        var input = {"sessionId":null,"code":"\n#### Parametrization\nThe NB model has the parameters \\\\(\\params=(\\balpha,\\bbeta)\\\\) where \n\n\\begin{split}\n  p^{\\text{NB}}_{\\params}(f|y) & = \\alpha_{f,y} \\\\\\\\\n  p^{\\text{NB}}_{\\params}(y) & = \\beta_{y}.\n\\end{split}\n\nThat is, \\\\(\\balpha\\\\) captures the per-class feature weights, and \\\\(\\bbeta\\\\) the class priors. \n\n#### Training the Naive Bayes Model\n\nThe NB model again can be trained using Maximum Likelihood estimation. This amounts to setting \n\n\\begin{split}\n  \\alpha_{x,y} & = \\frac{\\counts{\\train}{x,y}}{\\counts{\\train}{y}}\\\\\\\\\n  \\beta_{y} & = \\frac{\\counts{\\train}{y}}{\\left| \\train \\right|}\n\\end{split}\n\n","extraFields":{}};
        var id = 8;
        //createStaticCellHTML(id, divCells, doc, mode, input, compilers);
    
        var mode = 'markdown';
        if(mode == 'wolfe') mode = 'scala';
        var input = {"sessionId":null,"code":"\n#### Log-linear Representation\n\nIt will be convenient to represent the NB model in *log-linear* form. This form will allow us to understand the MLE NB simply as one particular way of training a (log) linear model. It will also make the approach comparable to other approaches such as Conditional Log-Likelihood (aka *logistic regression* or *maximum entropy*) or SVM style training that can operate on the same parametrisation but estimate the parameters using different objectives. Finally, the log-linear representation will make it easy to implement different training algorithms that work with the same representation and hence can be easily plugged-in and out.\n\nIn log-linear form the joint NB distribution \\\\(p^{\\text{NB}}_{\\params}(\\x,y)\\\\) can be written as:  \n\n\\begin{equation}\\label{eq-loglinear} \n  p^{\\text{NB}}_{\\params}(\\x,y)= \\exp \\left( \\sum_{i \\in \\mathcal{I}} f_i(x,y) w_i \\right) = \\exp \\< \\mathbf{f}(\\x,y), \\mathbf{w}\\> \n\\end{equation}\n\nHere the \\\\(f_i\\\\) are so called (joint) *feature functions*. The index set \\\\(\\mathcal{I}\\\\) is the union of all labels \\\\(y'\\in \\Ys\\\\) and all word-label pairs \\\\((x',y')\\\\), and the corresponding feature functions are defined as follows:\n\n\\begin{split}\n  f_{y'}(\\x,y) & = \\delta({y,y'})  \\\\\\\\\n  f_{x',y'}(\\x,y) & = \\delta({y,y'}) \\sum_i^{\\text{length}(\\x)} \\delta(x',x_i) \n\\end{split}\n\nIn words, the first feature function \\\\(f_{y'}\\\\) returns 1 if the input label \\\\(y\\\\) equals \\\\(y'\\\\), and 0 otherwise. The second feature function returns the number of times the word \\\\(x'\\\\) appears in \\\\(\\x\\\\) if \\\\(y\\\\) equals \\\\(y'\\\\), and 0 otherwise.\n\nIf one now sets the weights according to\n\n\\begin{split}\n  w_{y'} & = \\log \\beta_{y'}\\\\\\\\\n  w_{x',y'} & = \\log \\alpha_{x',y'}\n\\end{split}\n\nit is easy to show that \\\\(\\ref{eq-loglinear}\\\\) is equivalent to the original NB formulation in equation \\\\(\\ref{eq:NB}\\\\). \n\n","extraFields":{}};
        var id = 2;
        //createStaticCellHTML(id, divCells, doc, mode, input, compilers);
    
        var mode = 'markdown';
        if(mode == 'wolfe') mode = 'scala';
        var input = {"sessionId":null,"code":"\n#### Feature Templates\nNote that in the above case we have \\\\(|\\Ys|\\\\) label features, and \\\\(|V| \\times |\\Ys|\\\\) word-label features. The corresponding two types of features are often called *feature templates* that generate sets of actual feature functions. That is, \\\\(f_{y'}\\\\) is a feature template with one template *argument*, \\\\(y'\\\\), and \\\\(f_{x'y'}\\\\) is a template with two arguments. It is common to augment the feature templates with a *template name* to distinguish templates that have the same argument space but different semantics. For example, we may have a template that combines the label of a document with number of times word *stems* have been seen. For words \\\\(x'\\\\) that are their own stem this would create duplicate indices, and hence we use \\\\(f_{\\text{word},x',y'}\\\\) and \\\\(f_{\\text{stem},x',y'}\\\\) to distinguish both types of features.\n\n#### Conditional Model\nThe conditional probability \\\\(p_\\params^\\text{NB}(y|\\x)\\\\) can be written as \n\n\\begin{split} \n  p^{\\text{NB}}_{\\params}(y |\\x)= \\frac{\\exp \\< \\mathbf{f}(\\x,y), \\mathbf{w}\\>}{\\sum_{y'} \\exp \\< \\mathbf{f}(\\x,y'), \\mathbf{w}\\>} = \\exp \\left( s_\\params(\\x,y) - A_{\\params,\\x}\\right)\n\\end{split}\n\nwhere \n\n\\begin{split}\n  s_\\params(\\x,y) & = \\< \\mathbf{f}(\\x,y'), \\mathbf{w}\\> \\\\\\\\\n  A_{\\params,\\x} & = \\sum_{y'} \\exp \\< \\mathbf{f}(\\x,y'), \\mathbf{w}\\>\n\\end{split}\n\nand \\\\(A_{\\params,\\x}\\\\) is the *log-partition function*. \n\n","extraFields":{}};
        var id = 3;
        //createStaticCellHTML(id, divCells, doc, mode, input, compilers);
    
        var mode = 'markdown';
        if(mode == 'wolfe') mode = 'scala';
        var input = {"sessionId":null,"code":"#### Joint vs Input Features\nIn contrast to the standard formulation of linear and log-linear models we define feature functions over input-output pairs instead of only inputs. That is, we could have also used a representation where \\\\(\\< \\mathbf{f}(\\x,y), \\mathbf{w}\\>\\\\) is replaced by \\\\(\\< \\mathbf{f}(\\x), \\mathbf{w}_y\\>\\\\) in which each class \\\\(y\\\\) receives an own weight vector. \n\nThe benefit of the joint feature function is two-fold. First it enables us to easily define features that break up the output label into sub-labels. That is, say you have the labels \"sports_baseball\" and \"sports_football\", then you can define one feature that tests whether a label starts with a certain prefix (\"sports\"). This allows the model to learn commonalities between both labels. Second, the one-weight vector per class approach breaks down when the output space is structured (and exponentially sized). You simply cannot maintain a different weight vector for each possible output structure \\\\(\\y\\\\), both for computational and statistical reasons.\n","extraFields":{}};
        var id = 4;
        //createStaticCellHTML(id, divCells, doc, mode, input, compilers);
    
        var mode = 'markdown';
        if(mode == 'wolfe') mode = 'scala';
        var input = {"sessionId":null,"code":"\n### Conditional Loglikelihood \nTraining the NB model using MLE is efficient and easy to implement. In many cases it also leads to good results. However, one can argue that the MLE objective is generally not the optimal choice when the task is to predict the best output given some input. Let us recall the MLE objective: \n\n<!--toDO: (link to Maxent vs NB paper?)-->\n\n\\begin{split}\n  L(\\train, \\params) = \\sum_{(\\x,y) \\in \\train} \\log p^{\\text{NB}}_\\params(\\x,y)\n\\end{split}\n\nVia Bayes Law we can reformulate this objective as follows: \n\n\\begin{split}\n  L(\\train, \\params) = \\sum_{(\\x,y) \\in \\train} \\log p^{\\text{NB}}_\\params(y|\\x) + \\log p^{\\text{NB}}_\\params(\\x) \n\\end{split}\n\nNotice that the \\\\(p^{\\text{NB}}_\\params(\\x) \\\\) here is not the class prior as used in the *forward* definition of the NB model, \\\\(p^{\\text{NB}}_\\params(\\x|y) p^{\\text{NB}}_\\params(y)\\\\). Instead it is the marginal probability \\\\(\\sum_y p^{\\text{NB}}_\\params(\\x,y)\\\\) of seeing a given input text \\\\(\\x\\\\). \n\nThis view on the MLE objective shows that for every training instance MLE means both maximizing the conditional probability of seeing \\\\(y\\\\) given \\\\(\\x\\\\), and maximizing the marginal probability of \\\\(\\x\\\\). Now consider the way we use the NB model to make a prediction for a given \\\\(\\x\\\\): we search for the label \\\\(y\\\\) with maximum conditional probability \\\\(p^{\\text{NB}}_\\params(y|\\x)\\\\). Since \\\\(\\x\\\\) is fixed, the marginal probability \\\\(p^{\\text{NB}}_\\params(\\x)\\\\) has no impact on this decision. This means part of what what we optimize during training is completely irrelevant at test time. \n\nThe above problem may lead to errors: for a given training instance we may increase the marginal probability of \\\\(\\x\\\\) at the price of reducing \\\\(p^{\\text{NB}}_\\params(y|\\x)\\\\) if this means we can still increase their product. This may lead to the true \\\\(y\\\\) having smaller conditional probability than wrong ones.   \n\nOne way to overcome this problem is to directly optimize the *conditional* log-likelihood (CL). This objective is defined as follows:\n\n\\begin{split}\n  CL(\\train, \\params) = \\sum_{(\\x,y) \\in \\train} \\log p^{\\text{NB}}_\\params(y|\\x) = \\sum_{(\\x,y) \\in \\train}  s_\\params(\\x,y) - A_{\\params,\\x} \n\\end{split}\n\nThis objective directly aims to maximize the condional class probability given the inputs, ignoring the marginal probability of \\\\(\\x\\\\).\n","extraFields":{}};
        var id = 5;
        //createStaticCellHTML(id, divCells, doc, mode, input, compilers);
    
        var mode = 'markdown';
        if(mode == 'wolfe') mode = 'scala';
        var input = {"sessionId":null,"code":"\n#### Optimizing Conditional Loglikelihood \nDue to the normalization factor \\\\(A_{\\params,\\x}\\\\) there is no closed-form solution to the CL problem, and compared to the MLE solution we cannot just count. Instead we need to iteratively optimize the objective. One popular method to optimize the CL objective is via gradient ascent, or its stochastic version, stochastic gradient ascent Often one uses the term gradient *descent* even when ascent is meant, and we then speak of stochastic gradient descent (SGD). \n\nThe underlying idea of such gradient-based methods is to iteratively move along the gradient of the function until this gradient disappears. That is, for a function \\\\(f(\\params)\\\\) to be optimized, in each step \\\\(i\\\\) a gradient ascent algorithm performs the following update to the parameter vector \\\\(\\params\\\\):\n\n\\begin{split}\n  \\params_i \\leftarrow \\params_{i-1} + \\alpha_i \\nabla f(\\params_{i-1}) \n\\end{split}\n\nThere are various ways of choosing the *learning rate* \\\\(\\alpha\\\\) dynamically depending on the iteration \\\\(i\\\\), but for simplicity we will set it to 1 in the following.\n\nTo apply gradient ascent methods to optimizing the conditional loglikelihood we need to find its gradient with respect to the parameters. This gradient has a very intuitive form:\n\n\n\\begin{split}\n  \\nabla CL(\\params) =  \\sum_{(\\x,y) \\in \\train} \\mathbf{f}(\\x,y) - E_{p_\\params(y'|\\x)}\\[ \\mathbf{f}(\\x,y')\\]\n\\end{split}\n\nThat is, for each training instance this gradient moves towards the feature representation \\\\(\\mathbf{f}(\\x,y)\\\\) of the gold solution, and away from the expectation of the feature representation under the current model \\\\(E_{p_\\params(y'|\\x)}\\[ \\mathbf{f}(\\x,y')\\]\\\\). \n\nIn particular, this gradient is zero (and hence at an optimal solution) when the empirical expectation of the feature function under the training set is identical to the (conditional) model expectation. This gives rise to a dual view of the conditional likelihood objective: we can see solutions to this problem as parameters that force the empirical and model moments to match. In fact, one can arrive at the log-linear formulation and the CL objective also by searching for any distribution that matches the given feature moments and has maximal entropy. Particularly in the context of text classification the CL based approach is therefore often referred to as *Maximum Entropy* approach. On many text classification datasets it can be shown to outperform the MLE approach substantially.    \n\nNote that the CL objective is strictly concave. This means that when the gradient becomes zero we have found the single optimum to this function. \n<!--#### -->\n\n<!--#### Stochastic Gradient Descent-->\n<!--There are various gradient-based algorithms to find this optimum, as well as higher order methods that use the functions Hessian or approximations thereof. However, in this book we will focus on the most simple approach and generally use gradient ascent with fixed step size.-->\n\n","extraFields":{}};
        var id = 6;
        //createStaticCellHTML(id, divCells, doc, mode, input, compilers);
    
        var mode = 'markdown';
        if(mode == 'wolfe') mode = 'scala';
        var input = {"sessionId":null,"code":"\n\n\n \n \n ","extraFields":{}};
        var id = 7;
        //createStaticCellHTML(id, divCells, doc, mode, input, compilers);
    
    compileAll(doc,compilers);
    enableAceScalaCompletion();
</script>

            </div>
        </section>
        <script>

           $(function() {
             console.log("Removing slide-only content");
             window.setTimeout(function() {
               console.log($(".slide-start"));
               console.log($('.slide-start').nextUntil('.slide-end').andSelf());
               $('.slide-start').nextUntil('.slide-end').andSelf().remove();
             },1000);
           });
        </script>
    


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: bold; font-style: italic; font-family: STIXGeneral, sans-serif;"></div></div></body></html>