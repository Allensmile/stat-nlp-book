<!DOCTYPE html>
<!-- saved from url=(0072)http://localhost:9000/template/statnlpbookScrollReveal/02_methods/0x_mle -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=120">
        <title>Maximum Likelihood Estimation</title>
        

<script src="../assets/javascripts/jquery-1.9.0.min.js" type="text/javascript"></script>
<link rel="stylesheet" media="screen" href="../assets/stylesheets/normalize.css">

<!-- Moro imports -->
<script src="../assets/javascripts/document.js" type="text/javascript"></script>
<script src="../assets/javascripts/moro.js" type="text/javascript"></script>
<script src="../assets/javascripts/moro-cellconfig.js" type="text/javascript"></script>
<script src="../assets/javascripts/editor.js" type="text/javascript"></script>
<script src="../assets/javascripts/moro-static.js" type="text/javascript"></script>

<link rel="stylesheet" media="screen" href="../assets/stylesheets/moro.css">
<link rel="stylesheet" media="screen" href="../assets/stylesheets/static.css">

<!-- ACE editor -->
<script src="../assets/javascripts/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="../assets/javascripts/ace/ext-language_tools.js" type="text/javascript" charset="utf-8"></script>

<!-- Bootstrap -->
<link href="../assets/javascripts/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
<script src="../assets/javascripts/bootstrap/js/bootstrap.js" type="text/javascript"></script>

<!-- Icons, etc.-->
<link href="../assets/stylesheets/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="../assets/stylesheets/octicons/octicons.css" rel="stylesheet">

<!-- MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} }, "HTML-CSS": { linebreaks: {automatic: true} } });
</script>
<script type="text/javascript" src="../assets/javascripts/MathJax.js"></script>
<!--script type="text/javascript" src="../assets/javascripts/MathJax-2.5-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script-->

<!-- Highlight.js -->
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/styles/tomorrow.min.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/highlight.min.js"></script>

<!-- HTMLGEN -->
<script type="text/javascript" src="../assets/javascripts/d3.min.js"></script>
<script type="text/javascript" src="../assets/javascripts/raphael-min.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>
<script type="text/javascript" src="../assets/javascripts/nv.d3.min.js"></script>
<script src="../assets/javascripts/htmlgen/d3utils.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="../assets/javascripts/brat/client/lib/head.load.min.js"></script>

<script type="text/javascript" src="../assets/javascripts/dagre-d3.js"></script>

<link href="../assets/stylesheets/nv.d3.css" rel="stylesheet">
<link rel="stylesheet" media="screen" href="../assets/stylesheets/htmlgen.css">

        

<link rel="icon" type="image/x-icon" href="../assets/images/wolfe-logo-black.png">

<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic,900">
<link rel="stylesheet" media="screen" href="../assets/stylesheets/gridism.css">
<link rel="stylesheet" media="screen" href="../assets/stylesheets/normalize.css">
<link rel="stylesheet" media="screen" href="../assets/stylesheets/wolfe.css">

        <link rel="stylesheet" media="screen" href="../assets/stylesheets/statnlpbook.css">
        <link rel="stylesheet" media="screen" href="../assets/stylesheets/statnlpbookScrollReveal.css">

    <script src="../assets/javascripts/ace/snippets/text.js"></script><script src="../assets/javascripts/ace/theme-chaos.js"></script><script src="../assets/javascripts/ace/mode-markdown.js"></script><style id="ace-chaos">.ace-chaos .ace_gutter {background: #141414;color: #595959;border-right: 1px solid #282828;}.ace-chaos .ace_gutter-cell.ace_warning {background-image: none;background: #FC0;border-left: none;padding-left: 0;color: #000;}.ace-chaos .ace_gutter-cell.ace_error {background-position: -6px center;background-image: none;background: #F10;border-left: none;padding-left: 0;color: #000;}.ace-chaos .ace_print-margin {border-left: 1px solid #555;right: 0;background: #1D1D1D;}.ace-chaos {background-color: #161616;color: #E6E1DC;}.ace-chaos .ace_cursor {border-left: 2px solid #FFFFFF;}.ace-chaos .ace_cursor.ace_overwrite {border-left: 0px;border-bottom: 1px solid #FFFFFF;}.ace-chaos .ace_marker-layer .ace_selection {background: #494836;}.ace-chaos .ace_marker-layer .ace_step {background: rgb(198, 219, 174);}.ace-chaos .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid #FCE94F;}.ace-chaos .ace_marker-layer .ace_active-line {background: #333;}.ace-chaos .ace_gutter-active-line {background-color: #222;}.ace-chaos .ace_invisible {color: #404040;}.ace-chaos .ace_keyword {color:#00698F;}.ace-chaos .ace_keyword.ace_operator {color:#FF308F;}.ace-chaos .ace_constant {color:#1EDAFB;}.ace-chaos .ace_constant.ace_language {color:#FDC251;}.ace-chaos .ace_constant.ace_library {color:#8DFF0A;}.ace-chaos .ace_constant.ace_numeric {color:#58C554;}.ace-chaos .ace_invalid {color:#FFFFFF;background-color:#990000;}.ace-chaos .ace_invalid.ace_deprecated {color:#FFFFFF;background-color:#990000;}.ace-chaos .ace_support {color: #999;}.ace-chaos .ace_support.ace_function {color:#00AEEF;}.ace-chaos .ace_function {color:#00AEEF;}.ace-chaos .ace_string {color:#58C554;}.ace-chaos .ace_comment {color:#555;font-style:italic;padding-bottom: 0px;}.ace-chaos .ace_variable {color:#997744;}.ace-chaos .ace_meta.ace_tag {color:#BE53E6;}.ace-chaos .ace_entity.ace_other.ace_attribute-name {color:#FFFF89;}.ace-chaos .ace_markup.ace_underline {text-decoration: underline;}.ace-chaos .ace_fold-widget {text-align: center;}.ace-chaos .ace_fold-widget:hover {color: #777;}.ace-chaos .ace_fold-widget.ace_start,.ace-chaos .ace_fold-widget.ace_end,.ace-chaos .ace_fold-widget.ace_closed{background: none;border: none;box-shadow: none;}.ace-chaos .ace_fold-widget.ace_start:after {content: '▾'}.ace-chaos .ace_fold-widget.ace_end:after {content: '▴'}.ace-chaos .ace_fold-widget.ace_closed:after {content: '‣'}.ace-chaos .ace_indent-guide {border-right:1px dotted #333;margin-right:-1px;}.ace-chaos .ace_fold { background: #222; border-radius: 3px; color: #7AF; border: none; }.ace-chaos .ace_fold:hover {background: #CCC; color: #000;}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script src="../assets/javascripts/ace/snippets/markdown.js"></script><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
    <body class="wrap" style="zoom: 1;"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
        <header>
            <nav class="mobile-nav show-on-mobiles">
                    <!--{% include primary-nav-items.html %}-->
            </nav>
            <div class="grid">
                <div class="center-on-mobiles">
                    <h1>
                        <a href="../00_intro.html">
                            <h1 class="logo-text">StatNLP</h1>
                        </a>
                    </h1>
                    [<a id="toggle-view" href="../02_methods/0x_mle.html">Text</a>]
                </div>
            </div>
        </header>
        <section>
            <div class="grid">
                <div>
                
                    
                
                    
                
                    
                
                    
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; /&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" role="math" style="width: 0.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.002em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(3.867em 1000em 4.157em -999.998em); top: -4.007em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2"></span><span style="display: inline-block; width: 0px; height: 4.012em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"></math></span></span><script type="math/tex" id="MathJax-Element-1">
  \def\prob{p}
  \def\vocab{V}
  \def\params{\boldsymbol{\theta}}
  \def\argmax{\mathop{\arg\,\max}}
  \def\param{\theta}
  \def\bpi{\boldsymbol{\pi}}
  \def\balpha{\boldsymbol{\alpha}}
  \def\bbeta{\boldsymbol{\beta}}
  \def\perplexity{PP}
  \def\x{\mathbf{x}}
  \def\y{\mathbf{y}}
  \def\Xs{\mathcal{X}}
  \def\Ys{\mathcal{Y}}
  \def\perplexity{PP}
  \def\train{\mathcal{D}_\mathit{train}}
  \def\counts#1#2{\#_{#1}(#2)}
  \def\RR{\bf R}
  \def\length#1{\mathop{length}(#1)}
  \def\aligns{\mathbf{a}}
  \def\align{a}
  \def\source{\mathbf{s}}
  \def\ssource{s}
  \def\target{\mathbf{t}}
  \def\starget{t}
</script>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                </div>
                <div id="static_content" class="unit center-on-mobiles">
                    <h1>Maximum Likelihood Estimation</h1>
                <div id="cell0" class="cellWrapper"><div id="editCell0" class="cell" hidden="true" style="display: none;"><div class="input"><div id="editor0" class="cell editor ace_editor ace-chaos ace_dark"><div style="position: absolute;"></div><textarea class="ace_text-input" wrap="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><a id="runCode0" role="button" class="runButton btn disabled" disabled="disabled" "=""><i class="fa fa-play-circle-o fa-2x"></i></a></div></div><div id="renderDisplay0" class="cell"><p>The Maximum Likelihood Estimator (MLE) is one of the simplest ways, and often most intuitive way, to determine the parameters of a probabilistic models based on some training data. Under favourable conditions the MLE has several useful properties. On such property is consistency: if you sample enough data from a distribution with certain parameters, the MLE will recover these parameters with arbitrary precision. In our <a href="../02_methods/00_structuredprediction.html">structured prediction recipe</a> MLE can be seen as the most basic form of continuous optimization for parameter estimation. </p><p>In this section we will focus on MLE for <em>discrete distributions</em> and <em>continuous parameters</em>. We will assume a distribution <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3" role="math" style="width: 2.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.107em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1002.07em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-4"><span class="msubsup" id="MathJax-Span-5"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.47em 4.271em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-6" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="mi" id="MathJax-Span-7" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-8" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-9"><span class="mrow" id="MathJax-Span-10"><span class="mi" id="MathJax-Span-11" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-12" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi mathvariant="bold-italic">θ</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2">\prob_\params(\x)</script> with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" role="math" style="width: 7.247em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.3em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1006.26em 2.764em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-14"><span class="texatom" id="MathJax-Span-15"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-18" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mo" id="MathJax-Span-19" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">(</span><span class="msubsup" id="MathJax-Span-20"><span style="display: inline-block; position: relative; width: 0.871em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.45em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-21" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.445em;"><span class="mn" id="MathJax-Span-22" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-23" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-24" style="font-family: STIXGeneral-Regular; padding-left: 0.194em;">…</span><span class="mo" id="MathJax-Span-25" style="font-family: STIXGeneral-Regular; padding-left: 0.194em;">,</span><span class="msubsup" id="MathJax-Span-26" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 0.871em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.45em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-27" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.445em;"><span class="mi" id="MathJax-Span-28" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-29" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.221em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.023em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3">\x = (x_1,\ldots, x_n)</script> that factorizes in the following way:</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-1&quot;&gt;&lt;mtext&gt;(1)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30" role="math" style="width: 100%; display: inline-block; min-width: 19.189em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 115%; min-width: 19.189em;"><span style="position: absolute; clip: rect(2.262em 1015.05em 5.238em -999.999em); top: -3.999em; left: 0.001em; width: 100%;"><span class="mrow" id="MathJax-Span-31"><span class="mtable" id="MathJax-Span-32" style="min-width: 19.189em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.189em;"><span style="display: inline-block; position: absolute; width: 15.054em; height: 0px; clip: rect(-1.738em 1015.05em 1.238em -999.999em); top: 0.001em; left: 50%; margin-left: -7.516em;"><span style="position: absolute; clip: rect(2.262em 1015.05em 5.238em -999.999em); top: -3.999em; left: 0.001em;"><span style="display: inline-block; position: relative; width: 15.054em; height: 0px;"><span style="position: absolute; clip: rect(2.339em 1015.05em 5.315em -999.999em); top: -4.076em; left: 50%; margin-left: -7.516em;"><span class="mtd" id="MathJax-Span-36"><span class="mrow" id="MathJax-Span-37"><span class="msubsup" id="MathJax-Span-38"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.47em 4.271em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-39" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="mi" id="MathJax-Span-40" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-41" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-42"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-45" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-46" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="munderover" id="MathJax-Span-47" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px;"><span style="position: absolute; clip: rect(2.977em 1001.32em 4.542em -999.999em); top: -3.999em; left: 0.001em;"><span class="mo" id="MathJax-Span-48" style="font-family: STIXSizeOneSym; vertical-align: -0.521em;">∏</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.479em 1000.19em 4.175em -999.999em); top: -2.84em; left: 0.581em;"><span class="mi" id="MathJax-Span-49" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.537em 1000.33em 4.059em -999.999em); top: -5.197em; left: 0.503em;"><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-51" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.47em 4.271em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-52" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="mi" id="MathJax-Span-53" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-54" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.45em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-56" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.445em;"><span class="mi" id="MathJax-Span-57" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mo" id="MathJax-Span-60" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-61"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.6em 4.271em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-62" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.619em;"><span class="mi" id="MathJax-Span-63" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-64" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-65"><span class="mrow" id="MathJax-Span-66"><span class="mi" id="MathJax-Span-67" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-68" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-69" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-70" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="munderover" id="MathJax-Span-71" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px;"><span style="position: absolute; clip: rect(2.977em 1001.32em 4.542em -999.999em); top: -3.999em; left: 0.001em;"><span class="mo" id="MathJax-Span-72" style="font-family: STIXSizeOneSym; vertical-align: -0.521em;">∏</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.479em 1000.19em 4.175em -999.999em); top: -2.84em; left: 0.581em;"><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.537em 1000.33em 4.059em -999.999em); top: -5.197em; left: 0.503em;"><span class="mi" id="MathJax-Span-74" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-75" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 2.668em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.5em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-76" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.484em;"><span class="texatom" id="MathJax-Span-77"><span class="mrow" id="MathJax-Span-78"><span class="msubsup" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px;"><span style="position: absolute; clip: rect(3.634em 1000.31em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-80" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.902em; left: 0.31em;"><span class="mi" id="MathJax-Span-81" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="texatom" id="MathJax-Span-82"><span class="mrow" id="MathJax-Span-83"><span class="mo" id="MathJax-Span-84" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-85"><span style="display: inline-block; position: relative; width: 0.639em; height: 0px;"><span style="position: absolute; clip: rect(3.46em 1000.43em 4.214em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-86" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.825em; left: 0.445em;"><span class="mi" id="MathJax-Span-87" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-88" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-89"><span class="mrow" id="MathJax-Span-90"><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-92" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.16em; height: 0px; clip: rect(-0.811em 1001.12em 0.156em -999.999em); top: 0.001em; right: 0.001em; margin-right: 0.001em;"><span style="position: absolute; clip: rect(3.267em 1001.12em 4.233em -999.999em); top: -4.076em; right: 0.001em;"><span class="mtd" id="mjx-eqn-1"><span class="mrow" id="MathJax-Span-34"><span class="mtext" id="MathJax-Span-35" style="font-family: STIXGeneral-Regular;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.377em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 3.357em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-1"><mtext>(1)</mtext></mtd><mtd><msub><mi>p</mi><mi mathvariant="bold-italic">θ</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mi>i</mi><mi>n</mi></munderover><msub><mi>p</mi><mi mathvariant="bold-italic">θ</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>ϕ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mi>i</mi><mi>n</mi></munderover><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>ϕ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow></msub></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">\begin{equation}  \prob_\params(\x) = \prod_i^n \prob_\params(x_i|\phi_i(\x))  = \prod_i^n \param_{x_i|\phi_i(\x)} \end{equation}</script></p><p>Here the functions <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-93" role="math" style="width: 1.064em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.47em 1000.93em 2.474em -999.999em); top: -2.202em; left: 0.001em;"><span class="mrow" id="MathJax-Span-94"><span class="msubsup" id="MathJax-Span-95"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.6em 4.271em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-96" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.619em;"><span class="mi" id="MathJax-Span-97" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϕ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">\phi_i</script> provide a context to condition the probability of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-98" role="math" style="width: 0.851em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.701em 1000.74em 2.416em -999.999em); top: -2.202em; left: 0.001em;"><span class="mrow" id="MathJax-Span-99"><span class="msubsup" id="MathJax-Span-100"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.45em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-101" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.445em;"><span class="mi" id="MathJax-Span-102" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.199em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.734em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-6">x_i</script> with. For example, in a trigram language model this could be the bigram history for word <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-103" role="math" style="width: 0.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.291em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.817em 1000.27em 2.61em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.801em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">i</script>, and hence <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-106" role="math" style="width: 8.735em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.595em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1007.56em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-107"><span class="msubsup" id="MathJax-Span-108"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.6em 4.271em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-109" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.619em;"><span class="mi" id="MathJax-Span-110" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-111" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-112"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-115" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-116" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mo" id="MathJax-Span-117" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">(</span><span class="msubsup" id="MathJax-Span-118"><span style="display: inline-block; position: relative; width: 1.547em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.45em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-119" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.445em;"><span class="texatom" id="MathJax-Span-120"><span class="mrow" id="MathJax-Span-121"><span class="mi" id="MathJax-Span-122" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-123" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-124" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-125" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-126" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 1.547em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.45em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-127" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.445em;"><span class="texatom" id="MathJax-Span-128"><span class="mrow" id="MathJax-Span-129"><span class="mi" id="MathJax-Span-130" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-131" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-132" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-133" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϕ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8">\phi_i(\x) = (x_{i-1},x_{i-2})</script>. Notice that this function should not consider the variable <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-134" role="math" style="width: 0.851em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.701em 1000.74em 2.416em -999.999em); top: -2.202em; left: 0.001em;"><span class="mrow" id="MathJax-Span-135"><span class="msubsup" id="MathJax-Span-136"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.45em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-137" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.445em;"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.199em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.734em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-9">x_i</script> itself. </p><p>The Maximum Likelihood estimate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-139" role="math" style="width: 1.122em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.967em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.45em 1000.97em 2.281em -999.999em); top: -2.202em; left: 0.001em;"><span class="mrow" id="MathJax-Span-140"><span class="msubsup" id="MathJax-Span-141"><span style="display: inline-block; position: relative; width: 0.948em; height: 0px;"><span style="position: absolute; clip: rect(3.247em 1000.48em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-142" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.503em;"><span class="mo" id="MathJax-Span-143" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.868em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi mathvariant="bold-italic">θ</mi><mo>∗</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-10">\params^*</script> for this model, given some training data <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-144" role="math" style="width: 9.276em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.059em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1008.02em 2.764em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-145"><span class="msubsup" id="MathJax-Span-146"><span style="display: inline-block; position: relative; width: 2.262em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.79em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-147"><span class="mrow" id="MathJax-Span-148"><span class="mi" id="MathJax-Span-149" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.793em;"><span class="texatom" id="MathJax-Span-150"><span class="mrow" id="MathJax-Span-151"><span class="mi" id="MathJax-Span-152" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-153" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-154" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-155" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-157" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mo" id="MathJax-Span-158" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">(</span><span class="msubsup" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 0.871em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.45em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-160" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.445em;"><span class="mn" id="MathJax-Span-161" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-162" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-163" style="font-family: STIXGeneral-Regular; padding-left: 0.194em;">…</span><span class="mo" id="MathJax-Span-164" style="font-family: STIXGeneral-Regular; padding-left: 0.194em;">,</span><span class="msubsup" id="MathJax-Span-165" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 0.871em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.45em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-166" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.445em;"><span class="mi" id="MathJax-Span-167" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-168" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.221em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.023em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">\train = (x_1,\ldots, x_n)</script>, is defined as the solution to the following optimization problem:</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-eqmle&quot;&gt;&lt;mtext&gt;(2)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP&quot;&gt;&lt;mi&gt;arg&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP&quot;&gt;&lt;mi&gt;arg&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-169" role="math" style="width: 100%; display: inline-block; min-width: 24.02em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 115%; min-width: 24.02em;"><span style="position: absolute; clip: rect(2.784em 1019.83em 4.716em -999.999em); top: -3.999em; left: 0.001em; width: 100%;"><span class="mrow" id="MathJax-Span-170"><span class="mtable" id="MathJax-Span-171" style="min-width: 24.02em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 24.02em;"><span style="display: inline-block; position: absolute; width: 19.885em; height: 0px; clip: rect(-1.216em 1019.83em 0.716em -999.999em); top: 0.001em; left: 50%; margin-left: -9.931em;"><span style="position: absolute; clip: rect(2.842em 1019.83em 4.716em -999.999em); top: -3.999em; left: 0.001em;"><span style="display: inline-block; position: relative; width: 19.885em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1019.83em 5.064em -999.999em); top: -4.347em; left: 50%; margin-left: -9.931em;"><span class="mtd" id="MathJax-Span-175"><span class="mrow" id="MathJax-Span-176"><span class="msubsup" id="MathJax-Span-177"><span style="display: inline-block; position: relative; width: 0.948em; height: 0px;"><span style="position: absolute; clip: rect(3.247em 1000.48em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-178" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.405em; left: 0.503em;"><span class="mo" id="MathJax-Span-179" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-180" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="munderover" id="MathJax-Span-181" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 3.383em; height: 0px;"><span style="position: absolute; clip: rect(3.479em 1003.36em 4.271em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-182"><span class="mrow" id="MathJax-Span-183"><span class="mi" id="MathJax-Span-184" style="font-family: STIXGeneral-Regular;">arg</span><span class="mspace" id="MathJax-Span-185" style="height: 0.001em; vertical-align: 0.001em; width: 0.194em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-186" style="font-family: STIXGeneral-Regular; padding-left: 0.194em;">max</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.441em 1000.35em 4.175em -999.999em); top: -3.091em; left: 1.508em;"><span class="texatom" id="MathJax-Span-187"><span class="mrow" id="MathJax-Span-188"><span class="mi" id="MathJax-Span-189" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-190"></span><span class="msubsup" id="MathJax-Span-191" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.47em 4.271em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-192" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="mi" id="MathJax-Span-193" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-194" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-195"><span style="display: inline-block; position: relative; width: 2.262em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.79em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-196"><span class="mrow" id="MathJax-Span-197"><span class="mi" id="MathJax-Span-198" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.793em;"><span class="texatom" id="MathJax-Span-199"><span class="mrow" id="MathJax-Span-200"><span class="mi" id="MathJax-Span-201" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-202" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-203" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-204" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-205" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-206" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-207" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="munderover" id="MathJax-Span-208" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 3.383em; height: 0px;"><span style="position: absolute; clip: rect(3.479em 1003.36em 4.271em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-209"><span class="mrow" id="MathJax-Span-210"><span class="mi" id="MathJax-Span-211" style="font-family: STIXGeneral-Regular;">arg</span><span class="mspace" id="MathJax-Span-212" style="height: 0.001em; vertical-align: 0.001em; width: 0.194em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-213" style="font-family: STIXGeneral-Regular; padding-left: 0.194em;">max</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.441em 1000.35em 4.175em -999.999em); top: -3.091em; left: 1.508em;"><span class="texatom" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="mi" id="MathJax-Span-216" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-217"></span><span class="mi" id="MathJax-Span-218" style="font-family: STIXGeneral-Regular; padding-left: 0.194em;">log</span><span class="mo" id="MathJax-Span-219"></span><span class="msubsup" id="MathJax-Span-220" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.47em 4.271em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-221" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="mi" id="MathJax-Span-222" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-223" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-224"><span style="display: inline-block; position: relative; width: 2.262em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.79em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-225"><span class="mrow" id="MathJax-Span-226"><span class="mi" id="MathJax-Span-227" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.793em;"><span class="texatom" id="MathJax-Span-228"><span class="mrow" id="MathJax-Span-229"><span class="mi" id="MathJax-Span-230" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-231" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-232" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-233" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-234" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-235" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.16em; height: 0px; clip: rect(-1.081em 1001.12em -0.115em -999.999em); top: 0.001em; right: 0.001em; margin-right: 0.001em;"><span style="position: absolute; clip: rect(3.267em 1001.12em 4.233em -999.999em); top: -4.347em; right: 0.001em;"><span class="mtd" id="mjx-eqn-eqmle"><span class="mrow" id="MathJax-Span-173"><span class="mtext" id="MathJax-Span-174" style="font-family: STIXGeneral-Regular;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.777em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 2.134em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-eqmle"><mtext>(2)</mtext></mtd><mtd><msup><mi mathvariant="bold-italic">θ</mi><mo>∗</mo></msup><mo>=</mo><munder><mrow class="MJX-TeXAtom-OP"><mi>arg</mi><mspace width="thinmathspace"></mspace><mo movablelimits="true" form="prefix">max</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow></munder><mo>⁡</mo><msub><mi>p</mi><mi mathvariant="bold-italic">θ</mi></msub><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><munder><mrow class="MJX-TeXAtom-OP"><mi>arg</mi><mspace width="thinmathspace"></mspace><mo movablelimits="true" form="prefix">max</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">θ</mi></mrow></munder><mo>⁡</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi mathvariant="bold-italic">θ</mi></msub><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">\begin{equation}\label{eq:mle}  \params^* = \argmax_{\params} \prob_\params(\train) = \argmax_{\params} \log \prob_\params(\train) \end{equation}</script></p><p>Here the second equality stems from the monotonicity of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-236" role="math" style="width: 1.489em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1001.26em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-237"><span class="mi" id="MathJax-Span-238" style="font-family: STIXGeneral-Regular;">log</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">\log</script> function, and is useful because the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-239" role="math" style="width: 1.489em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1001.26em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-240"><span class="mi" id="MathJax-Span-241" style="font-family: STIXGeneral-Regular;">log</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">\log</script> expression is easier to optimize. In words, the maximum likelihood estimate are the parameters that assign maximal probability to the training sample. </p><p>As it turns out, the solution for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MathJax_ref&quot; href=&quot;#mjx-eqn-eqmle&quot;&gt;&lt;mtext&gt;2&lt;/mtext&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-242" role="math" style="width: 0.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1000.48em 2.59em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-243"><a href="../02_methods/0x_mle_slides.html#mjx-eqn-eqmle"><span class="mrow MathJax_ref" id="MathJax-Span-244"><span class="mtext" id="MathJax-Span-245" style="font-family: STIXGeneral-Regular;">2</span></span></a></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.021em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.823em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MathJax_ref" href="#mjx-eqn-eqmle"><mtext>2</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-15">\ref{eq:mle}</script> has a <em>closed form</em>: we can write the result as a direct function of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-246" role="math" style="width: 2.629em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.281em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.489em 1002.28em 2.416em -999.999em); top: -2.202em; left: 0.001em;"><span class="mrow" id="MathJax-Span-247"><span class="msubsup" id="MathJax-Span-248"><span style="display: inline-block; position: relative; width: 2.262em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.79em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-249"><span class="mrow" id="MathJax-Span-250"><span class="mi" id="MathJax-Span-251" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.793em;"><span class="texatom" id="MathJax-Span-252"><span class="mrow" id="MathJax-Span-253"><span class="mi" id="MathJax-Span-254" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-256" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-257" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-258" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.199em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-16">\train</script> without the need of any iterative optimization algorithm. The result is simply:</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-eqcounts&quot;&gt;&lt;mtext&gt;(3)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-259" role="math" style="width: 100%; display: inline-block; min-width: 11.614em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 115%; min-width: 11.614em;"><span style="position: absolute; clip: rect(2.532em 1007.48em 4.967em -999.999em); top: -3.999em; left: 0.001em; width: 100%;"><span class="mrow" id="MathJax-Span-260"><span class="mtable" id="MathJax-Span-261" style="min-width: 11.614em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 11.614em;"><span style="display: inline-block; position: absolute; width: 7.479em; height: 0px; clip: rect(-1.468em 1007.48em 0.967em -999.999em); top: 0.001em; left: 50%; margin-left: -3.729em;"><span style="position: absolute; clip: rect(2.532em 1007.48em 4.967em -999.999em); top: -3.999em; left: 0.001em;"><span style="display: inline-block; position: relative; width: 7.479em; height: 0px;"><span style="position: absolute; clip: rect(2.59em 1007.48em 5.006em -999.999em); top: -4.038em; left: 50%; margin-left: -3.729em;"><span class="mtd" id="MathJax-Span-265"><span class="mrow" id="MathJax-Span-266"><span class="msubsup" id="MathJax-Span-267"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.5em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-268" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.484em;"><span class="texatom" id="MathJax-Span-269"><span class="mrow" id="MathJax-Span-270"><span class="mi" id="MathJax-Span-271" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="texatom" id="MathJax-Span-272"><span class="mrow" id="MathJax-Span-273"><span class="mo" id="MathJax-Span-274" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-275" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-276" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mfrac" id="MathJax-Span-277" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 4.465em; height: 0px; margin-right: 0.117em; margin-left: 0.117em;"><span style="position: absolute; clip: rect(3.267em 1004.31em 4.329em -999.999em); top: -4.675em; left: 50%; margin-left: -2.183em;"><span class="mrow" id="MathJax-Span-278"><span class="msubsup" id="MathJax-Span-279"><span style="display: inline-block; position: relative; width: 2.165em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.5em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-280" style="font-family: STIXGeneral-Regular;">#</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="texatom" id="MathJax-Span-281"><span class="mrow" id="MathJax-Span-282"><span class="msubsup" id="MathJax-Span-283"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(3.479em 1000.56em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-284"><span class="mrow" id="MathJax-Span-285"><span class="mi" id="MathJax-Span-286" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.902em; left: 0.561em;"><span class="texatom" id="MathJax-Span-287"><span class="mrow" id="MathJax-Span-288"><span class="mi" id="MathJax-Span-289" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-290" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-291" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-292" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-293" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-294" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-295" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-296" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-297" style="font-family: STIXGeneral-Italic; padding-left: 0.194em;">ϕ</span><span class="mo" id="MathJax-Span-298" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.267em 1003.42em 4.329em -999.999em); top: -3.323em; left: 50%; margin-left: -1.738em;"><span class="mrow" id="MathJax-Span-299"><span class="msubsup" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 2.165em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.5em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-301" style="font-family: STIXGeneral-Regular;">#</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="texatom" id="MathJax-Span-302"><span class="mrow" id="MathJax-Span-303"><span class="msubsup" id="MathJax-Span-304"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(3.479em 1000.56em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-305"><span class="mrow" id="MathJax-Span-306"><span class="mi" id="MathJax-Span-307" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.902em; left: 0.561em;"><span class="texatom" id="MathJax-Span-308"><span class="mrow" id="MathJax-Span-309"><span class="mi" id="MathJax-Span-310" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-311" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-312" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-313" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-314" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-315" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-316" style="font-family: STIXGeneral-Italic;">ϕ</span><span class="mo" id="MathJax-Span-317" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.948em 1004.47em 1.122em -999.999em); top: -1.274em; left: 0.001em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.001em; border-top-width: 3.1px; border-top-style: solid; width: 4.465em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.064em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.16em; height: 0px; clip: rect(-0.772em 1001.12em 0.194em -999.999em); top: 0.001em; right: 0.001em; margin-right: 0.001em;"><span style="position: absolute; clip: rect(3.267em 1001.12em 4.233em -999.999em); top: -4.038em; right: 0.001em;"><span class="mtd" id="mjx-eqn-eqcounts"><span class="mrow" id="MathJax-Span-263"><span class="mtext" id="MathJax-Span-264" style="font-family: STIXGeneral-Regular;">(3)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.066em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 2.69em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-eqcounts"><mtext>(3)</mtext></mtd><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>ϕ</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi mathvariant="normal">#</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>ϕ</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi mathvariant="normal">#</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo></mrow></mfrac></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">\begin{equation}\label{eq:counts}  \param_{x|\phi} = \frac{\counts{\train}{x,\phi}}{\counts{\train}{\phi}} \end{equation}</script></p><p>where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-318" role="math" style="width: 5.006em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.349em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1004.31em 2.861em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-319"><span class="msubsup" id="MathJax-Span-320"><span style="display: inline-block; position: relative; width: 2.165em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.5em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-321" style="font-family: STIXGeneral-Regular;">#</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="texatom" id="MathJax-Span-322"><span class="mrow" id="MathJax-Span-323"><span class="msubsup" id="MathJax-Span-324"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(3.479em 1000.56em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-325"><span class="mrow" id="MathJax-Span-326"><span class="mi" id="MathJax-Span-327" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.902em; left: 0.561em;"><span class="texatom" id="MathJax-Span-328"><span class="mrow" id="MathJax-Span-329"><span class="mi" id="MathJax-Span-330" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-331" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-332" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-333" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-334" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-335" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-336" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-337" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-338" style="font-family: STIXGeneral-Italic; padding-left: 0.194em;">ϕ</span><span class="mo" id="MathJax-Span-339" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.332em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.134em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">#</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>ϕ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">\counts{\train}{x,\phi}</script> is the number of times we have seen the value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-340" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.03em 1000.47em 2.61em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-341"><span class="mi" id="MathJax-Span-342" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.557em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">x</script> paired with the context <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-343" role="math" style="width: 0.735em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.639em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1000.6em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-344"><span class="mi" id="MathJax-Span-345" style="font-family: STIXGeneral-Italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">\phi</script> in the data <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-346" role="math" style="width: 2.629em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.281em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.489em 1002.28em 2.416em -999.999em); top: -2.202em; left: 0.001em;"><span class="mrow" id="MathJax-Span-347"><span class="msubsup" id="MathJax-Span-348"><span style="display: inline-block; position: relative; width: 2.262em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.79em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-349"><span class="mrow" id="MathJax-Span-350"><span class="mi" id="MathJax-Span-351" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.793em;"><span class="texatom" id="MathJax-Span-352"><span class="mrow" id="MathJax-Span-353"><span class="mi" id="MathJax-Span-354" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-355" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-356" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-357" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-358" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.199em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-21">\train</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-359" role="math" style="width: 3.982em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.46em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1003.42em 2.861em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-360"><span class="msubsup" id="MathJax-Span-361"><span style="display: inline-block; position: relative; width: 2.165em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.5em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-362" style="font-family: STIXGeneral-Regular;">#</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="texatom" id="MathJax-Span-363"><span class="mrow" id="MathJax-Span-364"><span class="msubsup" id="MathJax-Span-365"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(3.479em 1000.56em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-366"><span class="mrow" id="MathJax-Span-367"><span class="mi" id="MathJax-Span-368" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.902em; left: 0.561em;"><span class="texatom" id="MathJax-Span-369"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-372" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-373" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-374" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-375" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-376" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-377" style="font-family: STIXGeneral-Italic;">ϕ</span><span class="mo" id="MathJax-Span-378" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.332em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.134em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">#</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">\counts{\train}{\phi}</script> the number of times we have seen the context <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-379" role="math" style="width: 0.735em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.639em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1000.6em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-380"><span class="mi" id="MathJax-Span-381" style="font-family: STIXGeneral-Italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">\phi</script>. </p><p>Notice that in the same way we can represent the context of a variable using a function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-382" role="math" style="width: 0.735em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.639em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1000.6em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-family: STIXGeneral-Italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">\phi</script>, and hence map contexts to more coarse-grained equivalence classes, we can map the values <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-385" role="math" style="width: 0.851em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.701em 1000.74em 2.416em -999.999em); top: -2.202em; left: 0.001em;"><span class="mrow" id="MathJax-Span-386"><span class="msubsup" id="MathJax-Span-387"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.45em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-388" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.445em;"><span class="mi" id="MathJax-Span-389" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.199em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.734em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">x_i</script> to a more coarse grained representation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-390" role="math" style="width: 2.088em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.817em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1001.78em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-391"><span class="mi" id="MathJax-Span-392" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span class="mo" id="MathJax-Span-393" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-394"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.45em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-395" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.445em;"><span class="mi" id="MathJax-Span-396" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-397" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">\gamma(x_i)</script>. For example, in a language model we could decide to only care about the syntactic type (Verb, Noun, etc.) of a word and use <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;syn-type&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-398" role="math" style="width: 8.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.402em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1007.36em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-399"><span class="mi" id="MathJax-Span-400" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span class="mo" id="MathJax-Span-401" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-402" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-403" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-404" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mstyle" id="MathJax-Span-405" style="padding-left: 0.31em;"><span class="mrow" id="MathJax-Span-406"><span class="mtext" id="MathJax-Span-407" style="font-family: STIXGeneral-Regular;">syn-type</span></span></span><span class="mo" id="MathJax-Span-408" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-409" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-410" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="false" scriptlevel="0"><mtext>syn-type</mtext></mstyle><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-27">\gamma(x) = \mbox{syn-type}(x)</script>. In this case the MLE only changes in the way we count: instead of counting the times we see <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-411" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.03em 1000.47em 2.61em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-412"><span class="mi" id="MathJax-Span-413" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.557em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">x</script> paired with the context <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-414" role="math" style="width: 0.735em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.639em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1000.6em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-415"><span class="mi" id="MathJax-Span-416" style="font-family: STIXGeneral-Italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">\phi</script>, we count how often we see <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-417" role="math" style="width: 0.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.445em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.03em 1000.45em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-418"><span class="mi" id="MathJax-Span-419" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.779em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">\gamma</script> paired with the context <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-420" role="math" style="width: 0.735em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.639em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1000.6em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-421"><span class="mi" id="MathJax-Span-422" style="font-family: STIXGeneral-Italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">\phi</script>. </p></div></div><div id="cell1" class="cellWrapper"><div id="editCell1" class="cell" hidden="true" style="display: none;"><div class="input"><div id="editor1" class="cell editor ace_editor ace-chaos ace_dark"><div style="position: absolute;"></div><textarea class="ace_text-input" wrap="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: -100px; left: -100px; visibility: hidden; position: fixed; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><a id="runCode1" role="button" class="runButton btn disabled" disabled="disabled" "=""><i class="fa fa-play-circle-o fa-2x"></i></a></div></div><div id="renderDisplay1" class="cell"><h4>Derivation</h4><p>It is easy to derive the estimate for the discrete distributions described above. First let us reformulate the log-likelihood <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-423" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.817em 1000.56em 2.59em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-424"><span class="mi" id="MathJax-Span-425" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.021em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.801em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">L</script> in terms of dataset counts:</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-4&quot;&gt;&lt;mtext&gt;(4)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-426" role="math" style="width: 100%; display: inline-block; min-width: 25.45em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 115%; min-width: 25.45em;"><span style="position: absolute; clip: rect(2.513em 1021.32em 4.986em -999.999em); top: -3.999em; left: 0.001em; width: 100%;"><span class="mrow" id="MathJax-Span-427"><span class="mtable" id="MathJax-Span-428" style="min-width: 25.45em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 25.45em;"><span style="display: inline-block; position: absolute; width: 21.315em; height: 0px; clip: rect(-1.487em 1021.32em 0.986em -999.999em); top: 0.001em; left: 50%; margin-left: -10.666em;"><span style="position: absolute; clip: rect(2.513em 1021.32em 4.986em -999.999em); top: -3.999em; left: 0.001em;"><span style="display: inline-block; position: relative; width: 21.315em; height: 0px;"><span style="position: absolute; clip: rect(2.977em 1021.32em 5.45em -999.999em); top: -4.463em; left: 50%; margin-left: -10.666em;"><span class="mtd" id="MathJax-Span-432"><span class="mrow" id="MathJax-Span-433"><span class="mi" id="MathJax-Span-434" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-435" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-436"><span style="display: inline-block; position: relative; width: 2.262em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.79em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-437"><span class="mrow" id="MathJax-Span-438"><span class="mi" id="MathJax-Span-439" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.793em;"><span class="texatom" id="MathJax-Span-440"><span class="mrow" id="MathJax-Span-441"><span class="mi" id="MathJax-Span-442" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-443" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-444" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-445" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-446" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-447" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-448" style="font-family: STIXGeneral; font-style: italic; font-weight: bold; padding-left: 0.194em;">θ</span><span class="mo" id="MathJax-Span-449" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-450" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-451" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">log</span><span class="mo" id="MathJax-Span-452"></span><span class="msubsup" id="MathJax-Span-453" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.47em 4.271em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-454" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="mi" id="MathJax-Span-455" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-456" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-457"><span style="display: inline-block; position: relative; width: 2.262em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.79em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-458"><span class="mrow" id="MathJax-Span-459"><span class="mi" id="MathJax-Span-460" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.793em;"><span class="texatom" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="mi" id="MathJax-Span-463" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-464" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-465" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-466" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-467" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-468" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-469" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="munderover" id="MathJax-Span-470" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(2.977em 1001.2em 4.542em -999.999em); top: -3.999em; left: 0.001em;"><span class="mo" id="MathJax-Span-471" style="font-family: STIXSizeOneSym; vertical-align: -0.521em;">∑</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.46em 1000.91em 4.31em -999.999em); top: -2.84em; left: 0.175em;"><span class="texatom" id="MathJax-Span-472"><span class="mrow" id="MathJax-Span-473"><span class="mi" id="MathJax-Span-474" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-475" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-476" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-477" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 2.165em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.5em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-478" style="font-family: STIXGeneral-Regular;">#</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="texatom" id="MathJax-Span-479"><span class="mrow" id="MathJax-Span-480"><span class="msubsup" id="MathJax-Span-481"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(3.479em 1000.56em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-482"><span class="mrow" id="MathJax-Span-483"><span class="mi" id="MathJax-Span-484" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.902em; left: 0.561em;"><span class="texatom" id="MathJax-Span-485"><span class="mrow" id="MathJax-Span-486"><span class="mi" id="MathJax-Span-487" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-488" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-489" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-490" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-491" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-492" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-493" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-494" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-495" style="font-family: STIXGeneral-Italic; padding-left: 0.194em;">ϕ</span><span class="mo" id="MathJax-Span-496" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-497" style="font-family: STIXGeneral-Regular; padding-left: 0.194em;">log</span><span class="mo" id="MathJax-Span-498"></span><span class="msubsup" id="MathJax-Span-499" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.5em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-500" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.484em;"><span class="texatom" id="MathJax-Span-501"><span class="mrow" id="MathJax-Span-502"><span class="mi" id="MathJax-Span-503" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="texatom" id="MathJax-Span-504"><span class="mrow" id="MathJax-Span-505"><span class="mo" id="MathJax-Span-506" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-507" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.16em; height: 0px; clip: rect(-1.197em 1001.12em -0.231em -999.999em); top: 0.001em; right: 0.001em; margin-right: 0.001em;"><span style="position: absolute; clip: rect(3.267em 1001.12em 4.233em -999.999em); top: -4.463em; right: 0.001em;"><span class="mtd" id="mjx-eqn-4"><span class="mrow" id="MathJax-Span-430"><span class="mtext" id="MathJax-Span-431" style="font-family: STIXGeneral-Regular;">(4)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.088em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 2.779em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-4"><mtext>(4)</mtext></mtd><mtd><mi>L</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub><mo>,</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi mathvariant="bold-italic">θ</mi></msub><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>,</mo><mi>ϕ</mi></mrow></munder><msub><mi mathvariant="normal">#</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>ϕ</mi></mrow></msub></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-33">\begin{equation}  \newcommand{\duals}{\boldsymbol{\lambda}}  \newcommand{\lagrang}{\mathcal{L}}  L(\train,\params) = \log \prob_\params(\train)  = \sum_{x,\phi} \counts{\train}{x,\phi} \log \param_{x|\phi} \end{equation}</script></p><p>Next, remember that we want, for a given <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-508" role="math" style="width: 0.735em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.639em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1000.6em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-509"><span class="mi" id="MathJax-Span-510" style="font-family: STIXGeneral-Italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">\phi</script>, the parameters <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-511" role="math" style="width: 1.605em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.47em 1001.39em 2.552em -999.999em); top: -2.202em; left: 0.001em;"><span class="mrow" id="MathJax-Span-512"><span class="msubsup" id="MathJax-Span-513"><span style="display: inline-block; position: relative; width: 1.373em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.5em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-514" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.484em;"><span class="texatom" id="MathJax-Span-515"><span class="mrow" id="MathJax-Span-516"><span class="mo" id="MathJax-Span-517" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⋅</span><span class="mo" id="MathJax-Span-518" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-519" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.157em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>⋅</mo><mo>,</mo><mi>ϕ</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-35">\param_{\cdot,\phi}</script> to represent a conditional probability distribution <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-520" role="math" style="width: 3.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.726em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1002.69em 2.803em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-521"><span class="msubsup" id="MathJax-Span-522"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.499em 1000.47em 4.271em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-523" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="mi" id="MathJax-Span-524" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-525" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-526" style="font-family: STIXGeneral-Regular;">⋅</span><span class="texatom" id="MathJax-Span-527"><span class="mrow" id="MathJax-Span-528"><span class="mo" id="MathJax-Span-529" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-530" style="font-family: STIXGeneral-Italic;">ϕ</span><span class="mo" id="MathJax-Span-531" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.068em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi mathvariant="bold-italic">θ</mi></msub><mo stretchy="false">(</mo><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>ϕ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-36">\prob_\params(\cdot|\phi)</script>. This requires positivity (which fall out naturally later), and crucially: a normalization constraint. In particular, we need <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-532" role="math" style="width: 5.547em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.813em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.721em 1004.72em 2.9em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-533"><span class="munderover" id="MathJax-Span-534"><span style="display: inline-block; position: relative; width: 1.315em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.85em 4.329em -999.999em); top: -3.999em; left: 0.001em;"><span class="mo" id="MathJax-Span-535" style="font-family: STIXGeneral-Regular; vertical-align: 0.001em;">∑</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.709em; left: 0.909em;"><span class="mi" id="MathJax-Span-536" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-537" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 1.489em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.5em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-538" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.484em;"><span class="texatom" id="MathJax-Span-539"><span class="mrow" id="MathJax-Span-540"><span class="mi" id="MathJax-Span-541" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-542" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-543" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-544" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-545" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.377em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.268em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo>∑</mo><mi>x</mi></munder><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>,</mo><mi>ϕ</mi></mrow></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-37">\sum_x \param_{x,\phi} = 1</script>. </p><p>We hence have to solve a <em>constrained</em> optimization problem. A Standard technique to solve such problems relies on the notion of the <em>Lagrangian</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-546" role="math" style="width: 0.813em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.697em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.281em 1000.66em 3.073em -999.999em); top: -3.014em; left: 0.001em;"><span class="mrow" id="MathJax-Span-547"><span class="texatom" id="MathJax-Span-548"><span class="mrow" id="MathJax-Span-549"><span class="mi" id="MathJax-Span-550" style="font-family: STIXNonUnicode-Italic;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.021em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.823em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">L</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-38">\lagrang</script>: a version of the objective in which constraints are added as soft constraints weighted by the <em>lagrange multipliers</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-551" role="math" style="width: 0.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.759em 1000.48em 2.59em -999.999em); top: -2.511em; left: 0.001em;"><span class="mrow" id="MathJax-Span-552"><span class="mi" id="MathJax-Span-553" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">λ</span></span><span style="display: inline-block; width: 0px; height: 2.513em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.868em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">λ</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">\duals</script>: </p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-5&quot;&gt;&lt;mtext&gt;(5)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-554" role="math" style="width: 100%; display: inline-block; min-width: 21.605em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 115%; min-width: 21.605em;"><span style="position: absolute; clip: rect(2.513em 1017.41em 4.986em -999.999em); top: -3.999em; left: 0.001em; width: 100%;"><span class="mrow" id="MathJax-Span-555"><span class="mtable" id="MathJax-Span-556" style="min-width: 21.605em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 21.605em;"><span style="display: inline-block; position: absolute; width: 17.47em; height: 0px; clip: rect(-1.487em 1017.41em 0.986em -999.999em); top: 0.001em; left: 50%; margin-left: -8.733em;"><span style="position: absolute; clip: rect(2.513em 1017.41em 4.986em -999.999em); top: -3.999em; left: 0.001em;"><span style="display: inline-block; position: relative; width: 17.47em; height: 0px;"><span style="position: absolute; clip: rect(2.977em 1017.41em 5.45em -999.999em); top: -4.463em; left: 50%; margin-left: -8.733em;"><span class="mtd" id="MathJax-Span-560"><span class="mrow" id="MathJax-Span-561"><span class="texatom" id="MathJax-Span-562"><span class="mrow" id="MathJax-Span-563"><span class="mi" id="MathJax-Span-564" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span class="mo" id="MathJax-Span-565" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-566" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span class="mo" id="MathJax-Span-567" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-568" style="font-family: STIXGeneral; font-style: italic; font-weight: bold; padding-left: 0.194em;">λ</span><span class="mo" id="MathJax-Span-569" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-570" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-571" style="font-family: STIXGeneral-Italic; padding-left: 0.31em;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-572" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-573"><span style="display: inline-block; position: relative; width: 2.262em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.79em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-574"><span class="mrow" id="MathJax-Span-575"><span class="mi" id="MathJax-Span-576" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.793em;"><span class="texatom" id="MathJax-Span-577"><span class="mrow" id="MathJax-Span-578"><span class="mi" id="MathJax-Span-579" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-580" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-581" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-582" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-583" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-584" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-585" style="font-family: STIXGeneral; font-style: italic; font-weight: bold; padding-left: 0.194em;">θ</span><span class="mo" id="MathJax-Span-586" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-587" style="font-family: STIXGeneral-Regular; padding-left: 0.252em;">+</span><span class="munderover" id="MathJax-Span-588" style="padding-left: 0.252em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(2.977em 1001.2em 4.542em -999.999em); top: -3.999em; left: 0.001em;"><span class="mo" id="MathJax-Span-589" style="font-family: STIXSizeOneSym; vertical-align: -0.521em;">∑</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.46em 1000.43em 4.31em -999.999em); top: -2.84em; left: 0.426em;"><span class="mi" id="MathJax-Span-590" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-591" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 0.986em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.43em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-592" style="font-family: STIXGeneral-Italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.465em;"><span class="mi" id="MathJax-Span-593" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-594" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-595" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-596" style="font-family: STIXGeneral-Regular; padding-left: 0.252em;">−</span><span class="munderover" id="MathJax-Span-597" style="padding-left: 0.252em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(2.977em 1001.2em 4.542em -999.999em); top: -3.999em; left: 0.001em;"><span class="mo" id="MathJax-Span-598" style="font-family: STIXSizeOneSym; vertical-align: -0.521em;">∑</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.634em 1000.31em 4.175em -999.999em); top: -2.84em; left: 0.484em;"><span class="mi" id="MathJax-Span-599" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-600" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.5em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-601" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.484em;"><span class="texatom" id="MathJax-Span-602"><span class="mrow" id="MathJax-Span-603"><span class="mi" id="MathJax-Span-604" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="texatom" id="MathJax-Span-605"><span class="mrow" id="MathJax-Span-606"><span class="mo" id="MathJax-Span-607" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-608" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-609" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.16em; height: 0px; clip: rect(-1.197em 1001.12em -0.231em -999.999em); top: 0.001em; right: 0.001em; margin-right: 0.001em;"><span style="position: absolute; clip: rect(3.247em 1001.12em 4.233em -999.999em); top: -4.463em; right: 0.001em;"><span class="mtd" id="mjx-eqn-5"><span class="mrow" id="MathJax-Span-558"><span class="mtext" id="MathJax-Span-559" style="font-family: STIXGeneral-Regular;">(5)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.088em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 2.779em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-5"><mtext>(5)</mtext></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">L</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo>,</mo><mi mathvariant="bold-italic">λ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>L</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub><mo>,</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>+</mo><munder><mo>∑</mo><mi>ϕ</mi></munder><msub><mi>λ</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><munder><mo>∑</mo><mi>x</mi></munder><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>ϕ</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-40">\begin{equation}  \lagrang(\params,\duals) = L(\train,\params) + \sum_\phi \lambda_\phi (1 - \sum_x \param_{x|\phi}) \end{equation}</script></p><p>If <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-610" role="math" style="width: 1.122em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.967em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.45em 1000.97em 2.281em -999.999em); top: -2.202em; left: 0.001em;"><span class="mrow" id="MathJax-Span-611"><span class="msubsup" id="MathJax-Span-612"><span style="display: inline-block; position: relative; width: 0.948em; height: 0px;"><span style="position: absolute; clip: rect(3.247em 1000.48em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-613" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.503em;"><span class="mo" id="MathJax-Span-614" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.868em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi mathvariant="bold-italic">θ</mi><mo>∗</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-41">\params^*</script> is a solution to the original optimization problem then there exist a set of multipliers <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-615" role="math" style="width: 1.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.948em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.45em 1000.95em 2.281em -999.999em); top: -2.202em; left: 0.001em;"><span class="mrow" id="MathJax-Span-616"><span class="msubsup" id="MathJax-Span-617"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.247em 1000.47em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-618" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">λ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.484em;"><span class="mo" id="MathJax-Span-619" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.868em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi mathvariant="bold-italic">λ</mi><mo>∗</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-42">\duals^*</script> such that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-620" role="math" style="width: 2.687em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.339em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.779em 1002.34em 2.726em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-621"><span class="msubsup" id="MathJax-Span-622"><span style="display: inline-block; position: relative; width: 0.948em; height: 0px;"><span style="position: absolute; clip: rect(3.247em 1000.48em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-623" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.503em;"><span class="mo" id="MathJax-Span-624" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-625" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-626" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.247em 1000.47em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-627" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">λ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.484em;"><span class="mo" id="MathJax-Span-628" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.177em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.001em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi mathvariant="bold-italic">θ</mi><mo>∗</mo></msup><mo>,</mo><msup><mi mathvariant="bold-italic">λ</mi><mo>∗</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-43">\params^*,\duals^*</script> is a <em>stationary point</em> of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-629" role="math" style="width: 0.813em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.697em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.281em 1000.66em 3.073em -999.999em); top: -3.014em; left: 0.001em;"><span class="mrow" id="MathJax-Span-630"><span class="texatom" id="MathJax-Span-631"><span class="mrow" id="MathJax-Span-632"><span class="mi" id="MathJax-Span-633" style="font-family: STIXNonUnicode-Italic;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.021em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.823em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">L</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-44">\lagrang</script>. By setting <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-634" role="math" style="width: 4.233em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.672em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.281em 1003.65em 3.228em -999.999em); top: -3.014em; left: 0.001em;"><span class="mrow" id="MathJax-Span-635"><span class="msubsup" id="MathJax-Span-636"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.68em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-637" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.735em;"><span class="mi" id="MathJax-Span-638" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="texatom" id="MathJax-Span-639"><span class="mrow" id="MathJax-Span-640"><span class="mi" id="MathJax-Span-641" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span class="mo" id="MathJax-Span-642" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-643" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">0</span></span><span style="display: inline-block; width: 0px; height: 3.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.199em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.001em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mi mathvariant="bold-italic">θ</mi></msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">L</mi></mrow><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-45">\nabla_\params \lagrang = 0</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-644" role="math" style="width: 4.214em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.653em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.281em 1003.63em 3.228em -999.999em); top: -3.014em; left: 0.001em;"><span class="mrow" id="MathJax-Span-645"><span class="msubsup" id="MathJax-Span-646"><span style="display: inline-block; position: relative; width: 1.141em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.68em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-647" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.735em;"><span class="mi" id="MathJax-Span-648" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">λ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="texatom" id="MathJax-Span-649"><span class="mrow" id="MathJax-Span-650"><span class="mi" id="MathJax-Span-651" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span class="mo" id="MathJax-Span-652" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-653" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">0</span></span><span style="display: inline-block; width: 0px; height: 3.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.199em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.001em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mi mathvariant="bold-italic">λ</mi></msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">L</mi></mrow><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-46">\nabla_\duals \lagrang = 0</script> we can find such points. </p><p>We first set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-654" role="math" style="width: 4.233em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.672em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.281em 1003.65em 3.228em -999.999em); top: -3.014em; left: 0.001em;"><span class="mrow" id="MathJax-Span-655"><span class="msubsup" id="MathJax-Span-656"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.68em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-657" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.735em;"><span class="mi" id="MathJax-Span-658" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="texatom" id="MathJax-Span-659"><span class="mrow" id="MathJax-Span-660"><span class="mi" id="MathJax-Span-661" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span class="mo" id="MathJax-Span-662" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-663" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">0</span></span><span style="display: inline-block; width: 0px; height: 3.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.199em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.001em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mi mathvariant="bold-italic">θ</mi></msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">L</mi></mrow><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-47">\nabla_\params \lagrang = 0</script>:</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-6&quot;&gt;&lt;mtext&gt;(6)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-664" role="math" style="width: 100%; display: inline-block; min-width: 17.856em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 115%; min-width: 17.856em;"><span style="position: absolute; clip: rect(2.532em 1013.7em 4.967em -999.999em); top: -3.999em; left: 0.001em; width: 100%;"><span class="mrow" id="MathJax-Span-665"><span class="mtable" id="MathJax-Span-666" style="min-width: 17.856em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 17.856em;"><span style="display: inline-block; position: absolute; width: 13.74em; height: 0px; clip: rect(-1.468em 1013.7em 0.967em -999.999em); top: 0.001em; left: 50%; margin-left: -6.859em;"><span style="position: absolute; clip: rect(2.532em 1013.7em 4.967em -999.999em); top: -3.999em; left: 0.001em;"><span style="display: inline-block; position: relative; width: 13.74em; height: 0px;"><span style="position: absolute; clip: rect(2.59em 1013.7em 5.044em -999.999em); top: -4.057em; left: 50%; margin-left: -6.859em;"><span class="mtd" id="MathJax-Span-670"><span class="mrow" id="MathJax-Span-671"><span class="mfrac" id="MathJax-Span-672"><span style="display: inline-block; position: relative; width: 2.049em; height: 0px; margin-right: 0.117em; margin-left: 0.117em;"><span style="position: absolute; clip: rect(3.267em 1001.12em 4.078em -999.999em); top: -4.675em; left: 50%; margin-left: -0.579em;"><span class="mrow" id="MathJax-Span-673"><span class="mi" id="MathJax-Span-674" style="font-family: STIXGeneral-Regular;">∂</span><span class="texatom" id="MathJax-Span-675"><span class="mrow" id="MathJax-Span-676"><span class="mi" id="MathJax-Span-677" style="font-family: STIXNonUnicode-Italic;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.267em 1001.93em 4.349em -999.999em); top: -3.323em; left: 50%; margin-left: -0.965em;"><span class="mrow" id="MathJax-Span-678"><span class="mi" id="MathJax-Span-679" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-680"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.5em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-681" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.484em;"><span class="texatom" id="MathJax-Span-682"><span class="mrow" id="MathJax-Span-683"><span class="mi" id="MathJax-Span-684" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="texatom" id="MathJax-Span-685"><span class="mrow" id="MathJax-Span-686"><span class="mo" id="MathJax-Span-687" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-688" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.948em 1002.05em 1.122em -999.999em); top: -1.274em; left: 0.001em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.001em; border-top-width: 3.1px; border-top-style: solid; width: 2.049em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.064em;"></span></span></span></span><span class="mo" id="MathJax-Span-689" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-690" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 2.165em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.5em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-691" style="font-family: STIXGeneral-Regular;">#</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="texatom" id="MathJax-Span-692"><span class="mrow" id="MathJax-Span-693"><span class="msubsup" id="MathJax-Span-694"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(3.479em 1000.56em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-695"><span class="mrow" id="MathJax-Span-696"><span class="mi" id="MathJax-Span-697" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.902em; left: 0.561em;"><span class="texatom" id="MathJax-Span-698"><span class="mrow" id="MathJax-Span-699"><span class="mi" id="MathJax-Span-700" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-701" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-702" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-703" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-704" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-705" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-706" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-707" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-708" style="font-family: STIXGeneral-Italic; padding-left: 0.194em;">ϕ</span><span class="mo" id="MathJax-Span-709" style="font-family: STIXGeneral-Regular;">)</span><span class="mfrac" id="MathJax-Span-710"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px; margin-right: 0.117em; margin-left: 0.117em;"><span style="position: absolute; clip: rect(3.267em 1000.39em 4.059em -999.999em); top: -4.675em; left: 50%; margin-left: -0.25em;"><span class="mn" id="MathJax-Span-711" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.267em 1001.45em 4.349em -999.999em); top: -3.323em; left: 50%; margin-left: -0.733em;"><span class="msubsup" id="MathJax-Span-712"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.5em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-713" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.484em;"><span class="texatom" id="MathJax-Span-714"><span class="mrow" id="MathJax-Span-715"><span class="mi" id="MathJax-Span-716" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="texatom" id="MathJax-Span-717"><span class="mrow" id="MathJax-Span-718"><span class="mo" id="MathJax-Span-719" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-720" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.948em 1001.59em 1.122em -999.999em); top: -1.274em; left: 0.001em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.001em; border-top-width: 3.1px; border-top-style: solid; width: 1.586em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.064em;"></span></span></span></span><span class="mo" id="MathJax-Span-721" style="font-family: STIXGeneral-Regular; padding-left: 0.252em;">−</span><span class="msubsup" id="MathJax-Span-722" style="padding-left: 0.252em;"><span style="display: inline-block; position: relative; width: 0.986em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.43em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-723" style="font-family: STIXGeneral-Italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.465em;"><span class="mi" id="MathJax-Span-724" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-725" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-726" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.16em; height: 0px; clip: rect(-0.811em 1001.12em 0.175em -999.999em); top: 0.001em; right: 0.001em; margin-right: 0.001em;"><span style="position: absolute; clip: rect(3.267em 1001.12em 4.233em -999.999em); top: -4.057em; right: 0.001em;"><span class="mtd" id="mjx-eqn-6"><span class="mrow" id="MathJax-Span-668"><span class="mtext" id="MathJax-Span-669" style="font-family: STIXGeneral-Regular;">(6)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.066em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 2.734em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-6"><mtext>(6)</mtext></mtd><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>ϕ</mi></mrow></msub></mrow></mfrac><mo>=</mo><msub><mi mathvariant="normal">#</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mfrac><mn>1</mn><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>ϕ</mi></mrow></msub></mfrac><mo>−</mo><msub><mi>λ</mi><mi>ϕ</mi></msub><mo>=</mo><mn>0</mn></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">\begin{equation}  \frac{\partial \lagrang}{\partial \param_{x|\phi}} = \counts{\train}{x,\phi} \frac{1}{\param_{x|\phi}} - \lambda_\phi = 0 \end{equation}</script></p><p>This means that each parameter needs to be proportional to the count of its corresponding event:</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-7&quot;&gt;&lt;mtext&gt;(7)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-727" role="math" style="width: 100%; display: inline-block; min-width: 11.614em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 115%; min-width: 11.614em;"><span style="position: absolute; clip: rect(2.532em 1007.48em 4.986em -999.999em); top: -3.999em; left: 0.001em; width: 100%;"><span class="mrow" id="MathJax-Span-728"><span class="mtable" id="MathJax-Span-729" style="min-width: 11.614em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 11.614em;"><span style="display: inline-block; position: absolute; width: 7.479em; height: 0px; clip: rect(-1.468em 1007.48em 0.986em -999.999em); top: 0.001em; left: 50%; margin-left: -3.729em;"><span style="position: absolute; clip: rect(2.532em 1007.48em 4.986em -999.999em); top: -3.999em; left: 0.001em;"><span style="display: inline-block; position: relative; width: 7.479em; height: 0px;"><span style="position: absolute; clip: rect(2.59em 1007.48em 5.044em -999.999em); top: -4.057em; left: 50%; margin-left: -3.729em;"><span class="mtd" id="MathJax-Span-733"><span class="mrow" id="MathJax-Span-734"><span class="msubsup" id="MathJax-Span-735"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.5em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-736" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.484em;"><span class="texatom" id="MathJax-Span-737"><span class="mrow" id="MathJax-Span-738"><span class="mi" id="MathJax-Span-739" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="texatom" id="MathJax-Span-740"><span class="mrow" id="MathJax-Span-741"><span class="mo" id="MathJax-Span-742" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-743" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-744" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mfrac" id="MathJax-Span-745" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 4.465em; height: 0px; margin-right: 0.117em; margin-left: 0.117em;"><span style="position: absolute; clip: rect(3.267em 1004.31em 4.329em -999.999em); top: -4.675em; left: 50%; margin-left: -2.183em;"><span class="mrow" id="MathJax-Span-746"><span class="msubsup" id="MathJax-Span-747"><span style="display: inline-block; position: relative; width: 2.165em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.5em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-748" style="font-family: STIXGeneral-Regular;">#</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="texatom" id="MathJax-Span-749"><span class="mrow" id="MathJax-Span-750"><span class="msubsup" id="MathJax-Span-751"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(3.479em 1000.56em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-752"><span class="mrow" id="MathJax-Span-753"><span class="mi" id="MathJax-Span-754" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.902em; left: 0.561em;"><span class="texatom" id="MathJax-Span-755"><span class="mrow" id="MathJax-Span-756"><span class="mi" id="MathJax-Span-757" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-758" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-759" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-760" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-761" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-762" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-763" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-764" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-765" style="font-family: STIXGeneral-Italic; padding-left: 0.194em;">ϕ</span><span class="mo" id="MathJax-Span-766" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.267em 1000.99em 4.349em -999.999em); top: -3.323em; left: 50%; margin-left: -0.482em;"><span class="msubsup" id="MathJax-Span-767"><span style="display: inline-block; position: relative; width: 0.986em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.43em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-768" style="font-family: STIXGeneral-Italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.465em;"><span class="mi" id="MathJax-Span-769" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.948em 1004.47em 1.122em -999.999em); top: -1.274em; left: 0.001em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.001em; border-top-width: 3.1px; border-top-style: solid; width: 4.465em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.064em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.16em; height: 0px; clip: rect(-0.791em 1001.12em 0.175em -999.999em); top: 0.001em; right: 0.001em; margin-right: 0.001em;"><span style="position: absolute; clip: rect(3.267em 1001.12em 4.233em -999.999em); top: -4.057em; right: 0.001em;"><span class="mtd" id="mjx-eqn-7"><span class="mrow" id="MathJax-Span-731"><span class="mtext" id="MathJax-Span-732" style="font-family: STIXGeneral-Regular;">(7)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.088em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 2.734em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-7"><mtext>(7)</mtext></mtd><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>ϕ</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi mathvariant="normal">#</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>ϕ</mi><mo stretchy="false">)</mo></mrow><msub><mi>λ</mi><mi>ϕ</mi></msub></mfrac></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-49">\begin{equation}  \param_{x|\phi} = \frac{\counts{\train}{x,\phi}}{\lambda_\phi} \end{equation}</script></p><p>Setting set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-770" role="math" style="width: 4.214em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.653em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(2.281em 1003.63em 3.228em -999.999em); top: -3.014em; left: 0.001em;"><span class="mrow" id="MathJax-Span-771"><span class="msubsup" id="MathJax-Span-772"><span style="display: inline-block; position: relative; width: 1.141em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.68em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-773" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.735em;"><span class="mi" id="MathJax-Span-774" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">λ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="texatom" id="MathJax-Span-775"><span class="mrow" id="MathJax-Span-776"><span class="mi" id="MathJax-Span-777" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span class="mo" id="MathJax-Span-778" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-779" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">0</span></span><span style="display: inline-block; width: 0px; height: 3.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.199em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.001em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mi mathvariant="bold-italic">λ</mi></msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">L</mi></mrow><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-50">\nabla_\duals \lagrang = 0</script> will recover the original constraints: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-780" role="math" style="width: 5.354em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.658em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.721em 1004.56em 2.9em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-781"><span class="munderover" id="MathJax-Span-782"><span style="display: inline-block; position: relative; width: 1.315em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.85em 4.329em -999.999em); top: -3.999em; left: 0.001em;"><span class="mo" id="MathJax-Span-783" style="font-family: STIXGeneral-Regular; vertical-align: 0.001em;">∑</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.709em; left: 0.909em;"><span class="mi" id="MathJax-Span-784" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-785" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 1.334em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.5em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-786" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.484em;"><span class="texatom" id="MathJax-Span-787"><span class="mrow" id="MathJax-Span-788"><span class="mi" id="MathJax-Span-789" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="texatom" id="MathJax-Span-790"><span class="mrow" id="MathJax-Span-791"><span class="mo" id="MathJax-Span-792" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-793" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-794" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-795" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.377em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.268em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo>∑</mo><mi>x</mi></munder><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi></mrow></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-51">\sum_x \param_{x|y} = 1</script>. Plugging the above expression for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-796" role="math" style="width: 1.701em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.47em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.47em 1001.47em 2.552em -999.999em); top: -2.202em; left: 0.001em;"><span class="mrow" id="MathJax-Span-797"><span class="msubsup" id="MathJax-Span-798"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.5em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-799" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.484em;"><span class="texatom" id="MathJax-Span-800"><span class="mrow" id="MathJax-Span-801"><span class="mi" id="MathJax-Span-802" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="texatom" id="MathJax-Span-803"><span class="mrow" id="MathJax-Span-804"><span class="mo" id="MathJax-Span-805" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-806" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.157em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>ϕ</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-52"> \param_{x|\phi}</script> into this constraint will give us <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-807" role="math" style="width: 14.842em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.909em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.721em 1012.87em 2.9em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-808"><span class="msubsup" id="MathJax-Span-809"><span style="display: inline-block; position: relative; width: 0.986em; height: 0px;"><span style="position: absolute; clip: rect(3.267em 1000.43em 4.078em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-810" style="font-family: STIXGeneral-Italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.465em;"><span class="mi" id="MathJax-Span-811" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-812" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="munderover" id="MathJax-Span-813" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.315em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.85em 4.329em -999.999em); top: -3.999em; left: 0.001em;"><span class="mo" id="MathJax-Span-814" style="font-family: STIXGeneral-Regular; vertical-align: 0.001em;">∑</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.709em; left: 0.909em;"><span class="mi" id="MathJax-Span-815" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-816" style="padding-left: 0.194em;"><span style="display: inline-block; position: relative; width: 2.165em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.5em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-817" style="font-family: STIXGeneral-Regular;">#</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="texatom" id="MathJax-Span-818"><span class="mrow" id="MathJax-Span-819"><span class="msubsup" id="MathJax-Span-820"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(3.479em 1000.56em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-821"><span class="mrow" id="MathJax-Span-822"><span class="mi" id="MathJax-Span-823" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.902em; left: 0.561em;"><span class="texatom" id="MathJax-Span-824"><span class="mrow" id="MathJax-Span-825"><span class="mi" id="MathJax-Span-826" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-827" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-828" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-829" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-830" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-831" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-832" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-833" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-834" style="font-family: STIXGeneral-Italic; padding-left: 0.194em;">ϕ</span><span class="mo" id="MathJax-Span-835" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-836" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-837" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 2.165em; height: 0px;"><span style="position: absolute; clip: rect(3.286em 1000.5em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="mi" id="MathJax-Span-838" style="font-family: STIXGeneral-Regular;">#</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.503em;"><span class="texatom" id="MathJax-Span-839"><span class="mrow" id="MathJax-Span-840"><span class="msubsup" id="MathJax-Span-841"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(3.479em 1000.56em 4.059em -999.999em); top: -3.999em; left: 0.001em;"><span class="texatom" id="MathJax-Span-842"><span class="mrow" id="MathJax-Span-843"><span class="mi" id="MathJax-Span-844" style="font-size: 70.7%; font-family: STIXNonUnicode-Italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.902em; left: 0.561em;"><span class="texatom" id="MathJax-Span-845"><span class="mrow" id="MathJax-Span-846"><span class="mi" id="MathJax-Span-847" style="font-size: 50%; font-family: STIXGeneral-Italic;">t</span><span class="mi" id="MathJax-Span-848" style="font-size: 50%; font-family: STIXGeneral-Italic;">r</span><span class="mi" id="MathJax-Span-849" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-850" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-851" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-852" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-853" style="font-family: STIXGeneral-Italic;">ϕ</span><span class="mo" id="MathJax-Span-854" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.377em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.268em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>λ</mi><mi>ϕ</mi></msub><mo>=</mo><munder><mo>∑</mo><mi>x</mi></munder><msub><mi mathvariant="normal">#</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">#</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">n</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">\lambda_\phi = \sum_x \counts{\train}{x,\phi} = \counts{\train}{\phi}</script> and hence equation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MathJax_ref&quot; href=&quot;#mjx-eqn-eqcounts&quot;&gt;&lt;mtext&gt;3&lt;/mtext&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-855" role="math" style="width: 0.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.798em 1000.43em 2.61em -999.999em); top: -2.53em; left: 0.001em;"><span class="mrow" id="MathJax-Span-856"><a href="../02_methods/0x_mle_slides.html#mjx-eqn-eqcounts"><span class="mrow MathJax_ref" id="MathJax-Span-857"><span class="mtext" id="MathJax-Span-858" style="font-family: STIXGeneral-Regular;">3</span></span></a></span><span style="display: inline-block; width: 0px; height: 2.532em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.846em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MathJax_ref" href="#mjx-eqn-eqcounts"><mtext>3</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-54">\ref{eq:counts}</script>. Notice that there is only a single stationary point, and hence the parameters <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-859" role="math" style="width: 0.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.759em 1000.48em 2.59em -999.999em); top: -2.511em; left: 0.001em;"><span class="mrow" id="MathJax-Span-860"><span class="mi" id="MathJax-Span-861" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.513em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.043em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.868em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">\params</script> at this point need to be the optimal ones.</p></div></div></div>
                

<script>
    var divCells = $('#static_content');
    /* COMPILERS OBJECT */
    var compilers = {};
    
        compilers.scala = {};
        compilers.scala.hideAfterCompile = false;
        compilers.scala.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/scala");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = '';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.scala.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.scala.aggregate = true;
    
        compilers.markdown = {};
        compilers.markdown.hideAfterCompile = true;
        compilers.markdown.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/markdown");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = '';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.markdown.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.markdown.aggregate = false;
    
        compilers.section = {};
        compilers.section.hideAfterCompile = true;
        compilers.section.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'Section Name';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.section.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.section.aggregate = false;
    
        compilers.latex = {};
        compilers.latex.hideAfterCompile = true;
        compilers.latex.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/latex");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = '';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.latex.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.latex.aggregate = false;
    
        compilers.heading1 = {};
        compilers.heading1.hideAfterCompile = true;
        compilers.heading1.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'Heading';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.heading1.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.heading1.aggregate = false;
    
        compilers.heading2 = {};
        compilers.heading2.hideAfterCompile = true;
        compilers.heading2.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'Heading';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.heading2.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.heading2.aggregate = false;
    
        compilers.heading3 = {};
        compilers.heading3.hideAfterCompile = true;
        compilers.heading3.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'Heading';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.heading3.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.heading3.aggregate = false;
    
        compilers.heading4 = {};
        compilers.heading4.hideAfterCompile = true;
        compilers.heading4.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'Heading';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.heading4.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.heading4.aggregate = false;
    
        compilers.heading5 = {};
        compilers.heading5.hideAfterCompile = true;
        compilers.heading5.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'Heading';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.heading5.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.heading5.aggregate = false;
    
        compilers.html = {};
        compilers.html.hideAfterCompile = true;
        compilers.html.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/html");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = '';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.html.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.html.aggregate = false;
    
        compilers.imageurl = {};
        compilers.imageurl.hideAfterCompile = true;
        compilers.imageurl.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'URL';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.imageurl.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.imageurl.aggregate = false;
    
        compilers.google_viewer = {};
        compilers.google_viewer.hideAfterCompile = true;
        compilers.google_viewer.editor = 
function(id,content) {
    $("#editor"+id).empty();
    var editor = ace.edit("editor"+id);
    editor.setOptions({
      maxLines: Infinity,
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true
    });
    editor.setTheme("ace/theme/" + doc.aceTheme);
    editor.getSession().setMode("ace/mode/text");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setWrapLimitRange(null, null);
    var contentToAdd = ""
    if(content=="") contentToAdd = 'URL';
    else contentToAdd = content;
    editor.renderer.setScrollMargin(10, 10, 0, 0);
    //editor.renderer.setPadding(20);
    editor.getSession().setValue(contentToAdd, 1);
    editor.focus();
    editor.navigateFileEnd();
    editor.setBehavioursEnabled(true);
    editor.setWrapBehavioursEnabled(true);
    editor.setShowFoldWidgets(true);
    editor.setHighlightActiveLine(false);
    editor.setShowPrintMargin(false);
    editor.setAutoScrollEditorIntoView(true);
    editor.renderer.setShowGutter(true);
    editor.on('change', function () {
        //heightUpdateFunction(editor, '#editor'+id);
    });
    if(!doc.allowExecution) editor.setReadOnly(true);

    editor.commands.addCommand({
        name: "runCode",
        bindKey: {win: "Ctrl-Enter", mac: "Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById("runCode"+id).click();
        }
    })
    editor.getSession().on('change', function() {
      var mode = currentMode(id);
      if(mode=='markdown' || mode=='html') {
        //document.getElementById("runCode"+id).click();
      }
    });
    editor.commands.addCommand({
        name: "addCellBelow",
        bindKey: {win: "Shift-Enter", mac: "Shift-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.focus();
              ne.insert(text,1);
              ne.navigateTo(0, 0);
              newId = nextCellId(id);
              changeMode(newId,oldMode)
              console.log("changing " + newId + " to " + oldMode);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "injectEmptyCell",
        bindKey: {win: "Shift-Ctrl-Enter", mac: "Shift-Ctrl-Enter"},
        exec: function(editor) {
            document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            oldMode=currentMode(id);
            if(typeof(ne)!='undefined') {
              editor.getSelection().selectFileEnd();
              var text = editor.getCopyText();
              editor.remove('right');
              console.log("splitting a cell!");
              ne.insert(text,1);
            }
            if (oldMode == 'markdown') document.getElementById('runCode' + id).click();
            if (!(ne.getValue().trim() === "")) document.getElementById('addBelow' + id).click();
            ne=nextEditor(doc,id);
            newId = nextCellId(id);
            changeMode(newId,toggledMode(oldMode));
            if(typeof(ne)!='undefined') {
              ne.focus();
              ne.navigateTo(0, 0);
            }
        }
    })
    editor.commands.addCommand({
        name: "deleteCell",
        bindKey: {win: "Shift-Del", mac: "Shift-Del"},
        exec: function(editor) {
            document.getElementById('remove' + id).click();
        }
    })
    editor.commands.addCommand({
        name: "moveCursorRight",
        bindKey: {win: 'Right', mac: 'Right'},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            if(editor.getCursorPosition().row == eodRow &&
               editor.getCursorPosition().column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateFileStart();
                ne.focus();
              }
            }
            editor.navigateRight(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorLeft",
        bindKey: {win: 'Left', mac: 'Left'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0 &&
               editor.getCursorPosition().column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateFileEnd();
                pe.focus();
              }
            }
            editor.navigateLeft(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorUp",
        bindKey: {win: 'Up', mac: 'Up'},
        exec: function(editor) {
            if(editor.getCursorPosition().row == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                pe.navigateTo(pe.getSession().getDocument().getLength()-1, editor.getCursorPosition().column);
                pe.focus();
              }
            }
            editor.navigateUp(1);
        }
    })
    editor.commands.addCommand({
        name: "moveCursorDown",
        bindKey: {win: 'Down', mac: 'Down'},
        exec: function(editor) {
            if(editor.getCursorPosition().row + 1 == editor.getSession().getDocument().getLength()) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                ne.navigateTo(0, editor.getCursorPosition().column);
                ne.focus();
              }
            }
            editor.navigateDown(1);
        }
    })
    editor.commands.addCommand({
        name: "mergeBefore",
        bindKey: {win: "Shift-Backspace|Backspace", mac: "Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"},
        exec: function(editor) {
            var curPos = editor.getCursorPosition();
            if(curPos.row == 0 && curPos.column == 0) {
              pe=prevEditor(doc,id);
              if(typeof(pe)!='undefined') {
                console.log("merge with previous!");
                var text = editor.getSession().getDocument().getValue();
                pe.focus();
                pe.gotoLine(pe.getSession().getDocument().getLength());
                pe.navigateLineEnd();
                var newCurPos = pe.getCursorPosition();
                pe.insert('\n'+ text);
                pe.navigateTo(newCurPos.row+1, 0);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("left");
            }
        }
    })
    editor.commands.addCommand({
        name: "mergeAfter",
        bindKey: {win: "Delete", mac: "Delete|Ctrl-D|Shift-Delete"},
        exec: function(editor) {
            var eodRow = editor.getSession().getDocument().getLength()-1;
            var eodCol = editor.session.getLine(eodRow).length;
            var curPos = editor.getCursorPosition();
            if(curPos.row == eodRow && curPos.column == eodCol) {
              ne=nextEditor(doc,id);
              if(typeof(ne)!='undefined') {
                console.log("merge with after!");
                var text = editor.getSession().getDocument().getValue();
                ne.focus();
                ne.navigateTo(0, 0);
                ne.insert(text+'\n', 1);
                document.getElementById('remove' + id).click();
              }
            } else {
              editor.remove("right");
            }
        }
    })
    editor.commands.addCommand({
        name: "saveDoc",
        bindKey: {win: "Ctrl-S", mac: "Cmd-S"},
        exec: function(editor) {
            saveDoc(doc, compilers);
        }
    })
    editor.commands.addCommand({
        name: "modeScala",
        bindKey: {win: "Ctrl-Alt-S", mac: "Ctrl-Alt-S"},
        exec: function(editor) {
            console.log("changing mode to scala");
            changeMode(id,'scala');
        }
    })
    editor.commands.addCommand({
        name: "modeMarkdown",
        bindKey: {win: "Ctrl-Alt-M", mac: "Ctrl-Alt-M"},
        exec: function(editor) {
            console.log("changing mode to markdown");
            changeMode(id,'markdown');
        }
    })
    editor.commands.addCommand({
        name: "toggleMode",
        bindKey: {win: "Ctrl-M", mac: "Ctrl-M"},
        exec: function(editor) {
            mode = currentMode(id);
            console.log("changing mode to " + toggledMode(mode));
            changeMode(id, toggledMode(mode));
        }
    })
    //heightUpdateFunction(editor, '#editor'+id);
    return editor;
}
    ;
        compilers.google_viewer.editorToInput = 
function (doc, id) {
  input = {}
  input.code = doc.cells[id].editor.getSession().getValue();
  return input;
};
    ;
        compilers.google_viewer.aggregate = false;
    

    /* DOCUMENT OBJECT */
    var doc = newDoc("Maximum Likelihood Estimation");
    doc.aceTheme = 'chaos';
    doc.allowExecution = false;

    /* add cells */
    
        var mode = 'markdown';
        if(mode == 'wolfe') mode = 'scala';
        var input = {"sessionId":null,"code":"The Maximum Likelihood Estimator (MLE) is one of the simplest ways, and often most intuitive way, to determine the parameters of a probabilistic models based on some training data. Under favourable conditions the MLE has several useful properties. On such property is consistency: if you sample enough data from a distribution with certain parameters, the MLE will recover these parameters with arbitrary precision. In our [structured prediction recipe](/template/statnlpbook/02_methods/00_structuredprediction) MLE can be seen as the most basic form of continuous optimization for parameter estimation. \n\nIn this section we will focus on MLE for _discrete distributions_ and _continuous parameters_. We will assume a distribution \\\\(\\prob_\\params(\\x)\\\\) with \\\\(\\x = (x_1,\\ldots, x_n)\\\\) that factorizes in the following way:\n\n\\begin{equation}\n  \\prob_\\params(\\x) = \\prod_i^n \\prob_\\params(x_i|\\phi_i(\\x)) \n                    = \\prod_i^n \\param_{x_i|\\phi_i(\\x)}\n\\end{equation}\n\nHere the functions \\\\(\\phi_i\\\\) provide a context to condition the probability of \\\\(x_i\\\\) with. For example, in a trigram language model this could be the bigram history for word \\\\(i\\\\), and hence \\\\(\\phi_i(\\x) = (x_{i-1},x_{i-2})\\\\). Notice that this function should not consider the variable \\\\(x_i\\\\) itself. \n\nThe Maximum Likelihood estimate \\\\(\\params^*\\\\) for this model, given some training data \\\\(\\train = (x_1,\\ldots, x_n)\\\\), is defined as the solution to the following optimization problem:\n\n\\begin{equation}\\label{eq:mle}\n  \\params^* = \\argmax_{\\params} \\prob_\\params(\\train) = \\argmax_{\\params} \\log \\prob_\\params(\\train) \n\\end{equation}\n\nHere the second equality stems from the monotonicity of the \\\\(\\log\\\\) function, and is useful because the \\\\(\\log\\\\) expression is easier to optimize. In words, the maximum likelihood estimate are the parameters that assign maximal probability to the training sample.  \n\nAs it turns out, the solution for \\\\(\\ref{eq:mle}\\\\) has a _closed form_: we can write the result as a direct function of \\\\(\\train\\\\) without the need of any iterative optimization algorithm. The result is simply:\n\n\\begin{equation}\\label{eq:counts}\n  \\param_{x|\\phi} = \\frac{\\counts{\\train}{x,\\phi}}{\\counts{\\train}{\\phi}}\n\\end{equation}\n\nwhere \\\\(\\counts{\\train}{x,\\phi}\\\\) is the number of times we have seen the value \\\\(x\\\\) paired with the context \\\\(\\phi\\\\) in the data \\\\(\\train\\\\), and \\\\(\\counts{\\train}{\\phi}\\\\) the number of times we have seen the context \\\\(\\phi\\\\).   \n\nNotice that in the same way we can represent the context of a variable using a function \\\\(\\phi\\\\), and hence map contexts to more coarse-grained equivalence classes, we can map the values \\\\(x_i\\\\) to a more coarse grained representation \\\\(\\gamma(x_i)\\\\). For example, in a language model we could decide to only care about the syntactic type (Verb, Noun, etc.) of a word and use \\\\(\\gamma(x) = \\mbox{syn-type}(x)\\\\). In this case the MLE only changes in the way we count: instead of counting the times we see \\\\(x\\\\) paired with the context \\\\(\\phi\\\\), we count how often we see \\\\(\\gamma\\\\) paired with the context \\\\(\\phi\\\\). \n","extraFields":{}};
        var id = 0;
        //createStaticCellHTML(id, divCells, doc, mode, input, compilers);
    
        var mode = 'markdown';
        if(mode == 'wolfe') mode = 'scala';
        var input = {"sessionId":null,"code":"\n\n#### Derivation\nIt is easy to derive the estimate for the discrete distributions described above. First let us reformulate the log-likelihood \\\\(L\\\\) in terms of dataset counts:\n\n\\begin{equation}\n  \\newcommand{\\duals}{\\boldsymbol{\\lambda}}\n  \\newcommand{\\lagrang}{\\mathcal{L}}\n  L(\\train,\\params) = \\log \\prob_\\params(\\train) \n            = \\sum_{x,\\phi} \\counts{\\train}{x,\\phi} \\log \\param_{x|\\phi}\n\\end{equation}\n\nNext, remember that we want, for a given \\\\(\\phi\\\\), the parameters \\\\(\\param_{\\cdot,\\phi}\\\\) to represent a conditional probability distribution \\\\(\\prob_\\params(\\cdot|\\phi)\\\\). This requires positivity (which fall out naturally later), and crucially: a normalization constraint. In particular, we need \\\\(\\sum_x \\param_{x,\\phi} = 1\\\\). \n\nWe hence have to solve a *constrained* optimization problem. A Standard technique to solve such problems relies on the notion of the *Lagrangian* \\\\(\\lagrang\\\\): a version of the objective in which constraints are added as soft constraints weighted by the *lagrange multipliers* \\\\(\\duals\\\\): \n\n\\begin{equation}\n  \\lagrang(\\params,\\duals) = L(\\train,\\params) + \\sum_\\phi \\lambda_\\phi (1 - \\sum_x \\param_{x|\\phi})\n\\end{equation}\n\nIf \\\\(\\params^*\\\\) is a solution to the original optimization problem then there exist a set of multipliers \\\\(\\duals^*\\\\) such that \\\\(\\params^*,\\duals^*\\\\) is a *stationary point* of \\\\(\\lagrang\\\\). By setting \\\\(\\nabla_\\params \\lagrang = 0\\\\) and \\\\(\\nabla_\\duals \\lagrang = 0\\\\) we can find such points. \n\nWe first set \\\\(\\nabla_\\params \\lagrang = 0\\\\):\n\n\\begin{equation}\n  \\frac{\\partial \\lagrang}{\\partial \\param_{x|\\phi}} = \\counts{\\train}{x,\\phi} \\frac{1}{\\param_{x|\\phi}} - \\lambda_\\phi = 0 \n\\end{equation}\n\nThis means that each parameter needs to be proportional to the count of its corresponding event:\n\n\\begin{equation}\n  \\param_{x|\\phi} = \\frac{\\counts{\\train}{x,\\phi}}{\\lambda_\\phi}\n\\end{equation}\n\nSetting set \\\\(\\nabla_\\duals \\lagrang = 0\\\\) will recover the original constraints: \\\\(\\sum_x \\param_{x|y} = 1\\\\). Plugging the above expression for \\\\( \\param_{x|\\phi}\\\\) into this constraint will give us \\\\(\\lambda_\\phi = \\sum_x \\counts{\\train}{x,\\phi} = \\counts{\\train}{\\phi}\\\\) and hence equation \\\\(\\ref{eq:counts}\\\\). Notice that there is only a single stationary point, and hence the parameters \\\\(\\params\\\\) at this point need to be the optimal ones.\n\n\n\n\n\n","extraFields":{}};
        var id = 1;
        //createStaticCellHTML(id, divCells, doc, mode, input, compilers);
    
    compileAll(doc,compilers);
    enableAceScalaCompletion();
</script>

            </div>
        </section>
        <script src="../assets/javascripts/scrollReveal.min.js" type="text/javascript"></script>
        <script>

      var bratSVGScale = 1.8;

      window.setTimeout(function() {
        //get all cell wrappers and add data-sr fields
        /*
        $(".cellWrapper").each(function (){
          $(this).attr('data-sr','')
        });
        $(".srdiv").each(function() {
            $(this).replaceWith($('<div data-sr>' + this.innerHTML + '</div>'));
        });
        */
        //increase the size of brat examples
//        $(".bratsvg").each(function() {scaleSVG($(this),2)});

        //in paragraphs with summary elements, remove everything else
        $("p").has('.summary').contents().filter(function(){return(this.nodeType === 3)}).remove();
        $("p").has('.summary').children().not('.summary').remove();
        $('.book-start').nextUntil('.slide-start').andSelf().remove();


        //create divs at the start of each slide
        $(".newslide").after("<div class='slideStart'></div>");
        var anchors = $(".slideStart")

        //add anchors for slides
        var i = 0;
        anchors.each(function(){ $(this).attr("id","slide" + i); i++; });

        //function to return the closest slideStart element to current scrollTop
        function closestSlideStartIndex() {
          var top = $(document).scrollTop() ;
          //if top is before first slide return -1
          //console.log(top);
          //console.log(window.scrollY);
          //console.log("===");
          //console.log($(anchors[0]).offset().top);
          //console.log(anchors[0].offsetTop);
          if ($(anchors[0]).offset().top - 2> top) return -1;
          for (var i = 0; i < anchors.length; i++) {
            var current = $(anchors[i]).offset().top;
            //console.log("---");
            //console.log(current);
            //console.log(anchors[i].offsetTop);
            if (current >= top) return i;
          }
          return anchors.length-1;
        }

        //scroll to slides
        $(document).keydown(function(e){
            if (e.keyCode == 39) {
                var index = closestSlideStartIndex()
                console.log(index);
                if (index + 1 < anchors.length) {
                    var top = $(anchors[index + 1]).offset().top;
                    $("html, body").animate({scrollTop: top }, 500);
                }
            }
            if (e.keyCode == 37) {
                var index = closestSlideStartIndex()
                console.log(index);
                if (index > 0) {
                    var top = $(anchors[index - 1]).offset().top;
                    $("html, body").animate({scrollTop: top}, 500);
                } else $("html, body").animate({scrollTop: 0}, 500);
            }
        });

        /*
        var config = {
          enter:  'top',
          move:   '0px',
          flip:   '0deg',
          spin:   '0deg',
          roll:   '0deg',
          reset:  true,
          vFactor:  0.01,
          //viewport: document.getElementById('viewport')
        }

        window.sr = new scrollReveal(config);
        */
        console.log("Test");
      }, 5000);

    </script>
    


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: bold; font-style: italic; font-family: STIXGeneral, sans-serif;"></div></div></body></html>